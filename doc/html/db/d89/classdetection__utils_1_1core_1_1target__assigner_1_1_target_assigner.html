<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RESIIST: detection_utils.core.target_assigner.TargetAssigner Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RESIIST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d97/namespacedetection__utils.html">detection_utils</a></li><li class="navelem"><a class="el" href="../../de/d5d/namespacedetection__utils_1_1core.html">core</a></li><li class="navelem"><a class="el" href="../../d2/de4/namespacedetection__utils_1_1core_1_1target__assigner.html">target_assigner</a></li><li class="navelem"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html">TargetAssigner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d7/d1d/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">detection_utils.core.target_assigner.TargetAssigner Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for detection_utils.core.target_assigner.TargetAssigner:</div>
<div class="dyncontent">
<div class="center"><img src="../../d8/d59/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner__inherit__graph.png" border="0" usemap="#adetection__utils_8core_8target__assigner_8_target_assigner_inherit__map" alt="Inheritance graph"/></div>
<map name="adetection__utils_8core_8target__assigner_8_target_assigner_inherit__map" id="adetection__utils_8core_8target__assigner_8_target_assigner_inherit__map">
<area shape="rect" title=" " alt="" coords="5,119,169,512"/>
<area shape="rect" title=" " alt="" coords="63,5,112,71"/>
<area shape="poly" title=" " alt="" coords="90,84,90,118,85,118,85,84"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for detection_utils.core.target_assigner.TargetAssigner:</div>
<div class="dyncontent">
<div class="center"><img src="../../d6/dd0/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner__coll__graph.png" border="0" usemap="#adetection__utils_8core_8target__assigner_8_target_assigner_coll__map" alt="Collaboration graph"/></div>
<map name="adetection__utils_8core_8target__assigner_8_target_assigner_coll__map" id="adetection__utils_8core_8target__assigner_8_target_assigner_coll__map">
<area shape="rect" title=" " alt="" coords="5,119,169,512"/>
<area shape="rect" title=" " alt="" coords="63,5,112,71"/>
<area shape="poly" title=" " alt="" coords="90,84,90,118,85,118,85,84"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8a1ceea1c86bd4a5da2c052faa736d32"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a8a1ceea1c86bd4a5da2c052faa736d32">__init__</a> (self, similarity_calc, matcher, <a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aba5655fc6bb850dddc28f733d0e14737">box_coder</a>, negative_class_weight=1.0)</td></tr>
<tr class="separator:a8a1ceea1c86bd4a5da2c052faa736d32"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba5655fc6bb850dddc28f733d0e14737"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aba5655fc6bb850dddc28f733d0e14737">box_coder</a> (self)</td></tr>
<tr class="separator:aba5655fc6bb850dddc28f733d0e14737"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa80703dd201eafe98e23eb84c81a25cc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc">assign</a> (self, anchors, groundtruth_boxes, groundtruth_labels=None, unmatched_class_label=None, groundtruth_weights=None)</td></tr>
<tr class="separator:aa80703dd201eafe98e23eb84c81a25cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a458e6bab7f3aa2a797f45d1c71d51d61"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a458e6bab7f3aa2a797f45d1c71d51d61">get_box_coder</a> (self)</td></tr>
<tr class="separator:a458e6bab7f3aa2a797f45d1c71d51d61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:aa78d60ebbdfc66bd30abaacc40fbb862"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa78d60ebbdfc66bd30abaacc40fbb862">_reset_target_shape</a> (self, target, num_anchors)</td></tr>
<tr class="separator:aa78d60ebbdfc66bd30abaacc40fbb862"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a016ef142db31cd5480bcc27d34257e52"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a016ef142db31cd5480bcc27d34257e52">_create_regression_targets</a> (self, anchors, groundtruth_boxes, match)</td></tr>
<tr class="separator:a016ef142db31cd5480bcc27d34257e52"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae23b0df4f870baf8084bfd8cf6b06864"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#ae23b0df4f870baf8084bfd8cf6b06864">_default_regression_target</a> (self)</td></tr>
<tr class="separator:ae23b0df4f870baf8084bfd8cf6b06864"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7982f9b90978822c9d33ab953a642710"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a7982f9b90978822c9d33ab953a642710">_create_classification_targets</a> (self, groundtruth_labels, unmatched_class_label, match)</td></tr>
<tr class="separator:a7982f9b90978822c9d33ab953a642710"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cbf259274342a627ef7ab28fdeed92b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a2cbf259274342a627ef7ab28fdeed92b">_create_regression_weights</a> (self, match, groundtruth_weights)</td></tr>
<tr class="separator:a2cbf259274342a627ef7ab28fdeed92b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d8790c2c9892744fcc5c8280be39905"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a1d8790c2c9892744fcc5c8280be39905">_create_classification_weights</a> (self, match, groundtruth_weights)</td></tr>
<tr class="separator:a1d8790c2c9892744fcc5c8280be39905"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a8f23d4b36a5315deb3b3d7aa1730509e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a8f23d4b36a5315deb3b3d7aa1730509e">_similarity_calc</a></td></tr>
<tr class="separator:a8f23d4b36a5315deb3b3d7aa1730509e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3991ae175584cf83f92e64c06e74032d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a3991ae175584cf83f92e64c06e74032d">_matcher</a></td></tr>
<tr class="separator:a3991ae175584cf83f92e64c06e74032d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1ff2854b0fb78bf9dfd57a9be5c79038"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a1ff2854b0fb78bf9dfd57a9be5c79038">_box_coder</a></td></tr>
<tr class="separator:a1ff2854b0fb78bf9dfd57a9be5c79038"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48a3b327c36174ef156bb835520d26db"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a48a3b327c36174ef156bb835520d26db">_negative_class_weight</a></td></tr>
<tr class="separator:a48a3b327c36174ef156bb835520d26db"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Target assigner to compute classification and regression targets.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00054">54</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a1ceea1c86bd4a5da2c052faa736d32" name="a8a1ceea1c86bd4a5da2c052faa736d32"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a1ceea1c86bd4a5da2c052faa736d32">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>similarity_calc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>matcher</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>box_coder</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>negative_class_weight</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Construct Object Detection Target Assigner.

Args:
  similarity_calc: a RegionSimilarityCalculator
  matcher: an object_detection.core.Matcher used to match groundtruth to
    anchors.
  box_coder: an object_detection.core.BoxCoder used to encode matching
    groundtruth boxes with respect to anchors.
  negative_class_weight: classification weight to be associated to negative
    anchors (default: 1.0). The weight must be in [0., 1.].

Raises:
  ValueError: if similarity_calc is not a RegionSimilarityCalculator or
    if matcher is not a Matcher or if box_coder is not a BoxCoder
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00057">57</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>               negative_class_weight=1.0):</div>
<div class="line"><span class="lineno">   62</span>    <span class="stringliteral">&quot;&quot;&quot;Construct Object Detection Target Assigner.</span></div>
<div class="line"><span class="lineno">   63</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   64</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">   65</span><span class="stringliteral">      similarity_calc: a RegionSimilarityCalculator</span></div>
<div class="line"><span class="lineno">   66</span><span class="stringliteral">      matcher: an object_detection.core.Matcher used to match groundtruth to</span></div>
<div class="line"><span class="lineno">   67</span><span class="stringliteral">        anchors.</span></div>
<div class="line"><span class="lineno">   68</span><span class="stringliteral">      box_coder: an object_detection.core.BoxCoder used to encode matching</span></div>
<div class="line"><span class="lineno">   69</span><span class="stringliteral">        groundtruth boxes </span><span class="keyword">with</span> respect to anchors.</div>
<div class="line"><span class="lineno">   70</span>      negative_class_weight: classification weight to be associated to negative</div>
<div class="line"><span class="lineno">   71</span>        anchors (default: 1.0). The weight must be <span class="keywordflow">in</span> [0., 1.].</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    Raises:</div>
<div class="line"><span class="lineno">   74</span>      ValueError: <span class="keywordflow">if</span> similarity_calc <span class="keywordflow">is</span> <span class="keywordflow">not</span> a RegionSimilarityCalculator <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">   75</span>        <span class="keywordflow">if</span> matcher <span class="keywordflow">is</span> <span class="keywordflow">not</span> a Matcher <span class="keywordflow">or</span> <span class="keywordflow">if</span> box_coder <span class="keywordflow">is</span> <span class="keywordflow">not</span> a BoxCoder</div>
<div class="line"><span class="lineno">   76</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   77</span><span class="stringliteral">    </span><span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(similarity_calc, sim_calc.RegionSimilarityCalculator):</div>
<div class="line"><span class="lineno">   78</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;similarity_calc must be a RegionSimilarityCalculator&#39;</span>)</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(matcher, mat.Matcher):</div>
<div class="line"><span class="lineno">   80</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;matcher must be a Matcher&#39;</span>)</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(box_coder, bcoder.BoxCoder):</div>
<div class="line"><span class="lineno">   82</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;box_coder must be a BoxCoder&#39;</span>)</div>
<div class="line"><span class="lineno">   83</span>    self._similarity_calc = similarity_calc</div>
<div class="line"><span class="lineno">   84</span>    self._matcher = matcher</div>
<div class="line"><span class="lineno">   85</span>    self._box_coder = box_coder</div>
<div class="line"><span class="lineno">   86</span>    self._negative_class_weight = negative_class_weight</div>
<div class="line"><span class="lineno">   87</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7982f9b90978822c9d33ab953a642710" name="a7982f9b90978822c9d33ab953a642710"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7982f9b90978822c9d33ab953a642710">&#9670;&#160;</a></span>_create_classification_targets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._create_classification_targets </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>unmatched_class_label</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Create classification targets for each anchor.

Assign a classification target of for each anchor to the matching
groundtruth label that is provided by match.  Anchors that are not matched
to anything are given the target self._unmatched_cls_target

Args:
  groundtruth_labels:  a tensor of shape [num_gt_boxes, d_1, ... d_k]
    with labels for each of the ground_truth boxes. The subshape
    [d_1, ... d_k] can be empty (corresponding to scalar labels).
  unmatched_class_label: a float32 tensor with shape [d_1, d_2, ..., d_k]
    which is consistent with the classification target for each
    anchor (and can be empty for scalar targets).  This shape must thus be
    compatible with the groundtruth labels that are passed to the "assign"
    function (which have shape [num_gt_boxes, d_1, d_2, ..., d_k]).
  match: a matcher.Match object that provides a matching between anchors
    and groundtruth boxes.

Returns:
  a float32 tensor with shape [num_anchors, d_1, d_2 ... d_k], where the
  subshape [d_1, ..., d_k] is compatible with groundtruth_labels which has
  shape [num_gt_boxes, d_1, d_2, ... d_k].
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00286">286</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  287</span>                                     unmatched_class_label, match):</div>
<div class="line"><span class="lineno">  288</span>    <span class="stringliteral">&quot;&quot;&quot;Create classification targets for each anchor.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">    Assign a classification target of </span><span class="keywordflow">for</span> each anchor to the matching</div>
<div class="line"><span class="lineno">  291</span>    groundtruth label that <span class="keywordflow">is</span> provided by match.  Anchors that are <span class="keywordflow">not</span> matched</div>
<div class="line"><span class="lineno">  292</span>    to anything are given the target self._unmatched_cls_target</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    Args:</div>
<div class="line"><span class="lineno">  295</span>      groundtruth_labels:  a tensor of shape [num_gt_boxes, d_1, ... d_k]</div>
<div class="line"><span class="lineno">  296</span>        <span class="keyword">with</span> labels <span class="keywordflow">for</span> each of the ground_truth boxes. The subshape</div>
<div class="line"><span class="lineno">  297</span>        [d_1, ... d_k] can be empty (corresponding to scalar labels).</div>
<div class="line"><span class="lineno">  298</span>      unmatched_class_label: a float32 tensor <span class="keyword">with</span> shape [d_1, d_2, ..., d_k]</div>
<div class="line"><span class="lineno">  299</span>        which <span class="keywordflow">is</span> consistent <span class="keyword">with</span> the classification target <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno">  300</span>        anchor (<span class="keywordflow">and</span> can be empty <span class="keywordflow">for</span> scalar targets).  This shape must thus be</div>
<div class="line"><span class="lineno">  301</span>        compatible <span class="keyword">with</span> the groundtruth labels that are passed to the <span class="stringliteral">&quot;assign&quot;</span></div>
<div class="line"><span class="lineno">  302</span>        function (which have shape [num_gt_boxes, d_1, d_2, ..., d_k]).</div>
<div class="line"><span class="lineno">  303</span>      match: a matcher.Match object that provides a matching between anchors</div>
<div class="line"><span class="lineno">  304</span>        <span class="keywordflow">and</span> groundtruth boxes.</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>    Returns:</div>
<div class="line"><span class="lineno">  307</span>      a float32 tensor <span class="keyword">with</span> shape [num_anchors, d_1, d_2 ... d_k], where the</div>
<div class="line"><span class="lineno">  308</span>      subshape [d_1, ..., d_k] <span class="keywordflow">is</span> compatible <span class="keyword">with</span> groundtruth_labels which has</div>
<div class="line"><span class="lineno">  309</span>      shape [num_gt_boxes, d_1, d_2, ... d_k].</div>
<div class="line"><span class="lineno">  310</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  311</span><span class="stringliteral">    </span><span class="keywordflow">return</span> match.gather_based_on_match(</div>
<div class="line"><span class="lineno">  312</span>        groundtruth_labels,</div>
<div class="line"><span class="lineno">  313</span>        unmatched_value=unmatched_class_label,</div>
<div class="line"><span class="lineno">  314</span>        ignored_value=unmatched_class_label)</div>
<div class="line"><span class="lineno">  315</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a7982f9b90978822c9d33ab953a642710_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a7982f9b90978822c9d33ab953a642710_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a7982f9b90978822c9d33ab953a642710_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a7982f9b90978822c9d33ab953a642710_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,459,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="a1d8790c2c9892744fcc5c8280be39905" name="a1d8790c2c9892744fcc5c8280be39905"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d8790c2c9892744fcc5c8280be39905">&#9670;&#160;</a></span>_create_classification_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._create_classification_weights </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Create classification weights for each anchor.

Positive (matched) anchors are associated with a weight of
positive_class_weight and negative (unmatched) anchors are associated with
a weight of negative_class_weight. When anchors are ignored, weights are set
to zero. By default, both positive/negative weights are set to 1.0,
but they can be adjusted to handle class imbalance (which is almost always
the case in object detection).

Args:
  match: a matcher.Match object that provides a matching between anchors
    and groundtruth boxes.
  groundtruth_weights: a float tensor of shape [M] indicating the weight to
    assign to all anchors match to a particular groundtruth box.

Returns:
  a float32 tensor with shape [num_anchors] representing classification
  weights.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00335">335</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  337</span>                                     groundtruth_weights):</div>
<div class="line"><span class="lineno">  338</span>    <span class="stringliteral">&quot;&quot;&quot;Create classification weights for each anchor.</span></div>
<div class="line"><span class="lineno">  339</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  340</span><span class="stringliteral">    Positive (matched) anchors are associated </span><span class="keyword">with</span> a weight of</div>
<div class="line"><span class="lineno">  341</span>    positive_class_weight <span class="keywordflow">and</span> negative (unmatched) anchors are associated <span class="keyword">with</span></div>
<div class="line"><span class="lineno">  342</span>    a weight of negative_class_weight. When anchors are ignored, weights are set</div>
<div class="line"><span class="lineno">  343</span>    to zero. By default, both positive/negative weights are set to 1.0,</div>
<div class="line"><span class="lineno">  344</span>    but they can be adjusted to handle <span class="keyword">class </span>imbalance (which is almost always</div>
<div class="line"><span class="lineno">  345</span>    the case <span class="keywordflow">in</span> object detection).</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>    Args:</div>
<div class="line"><span class="lineno">  348</span>      match: a matcher.Match object that provides a matching between anchors</div>
<div class="line"><span class="lineno">  349</span>        <span class="keywordflow">and</span> groundtruth boxes.</div>
<div class="line"><span class="lineno">  350</span>      groundtruth_weights: a float tensor of shape [M] indicating the weight to</div>
<div class="line"><span class="lineno">  351</span>        assign to all anchors match to a particular groundtruth box.</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>    Returns:</div>
<div class="line"><span class="lineno">  354</span>      a float32 tensor <span class="keyword">with</span> shape [num_anchors] representing classification</div>
<div class="line"><span class="lineno">  355</span>      weights.</div>
<div class="line"><span class="lineno">  356</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  357</span><span class="stringliteral">    </span><span class="keywordflow">return</span> match.gather_based_on_match(</div>
<div class="line"><span class="lineno">  358</span>        groundtruth_weights,</div>
<div class="line"><span class="lineno">  359</span>        ignored_value=0.,</div>
<div class="line"><span class="lineno">  360</span>        unmatched_value=self._negative_class_weight)</div>
<div class="line"><span class="lineno">  361</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a1d8790c2c9892744fcc5c8280be39905_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a1d8790c2c9892744fcc5c8280be39905_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a1d8790c2c9892744fcc5c8280be39905_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a1d8790c2c9892744fcc5c8280be39905_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,463,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="a016ef142db31cd5480bcc27d34257e52" name="a016ef142db31cd5480bcc27d34257e52"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a016ef142db31cd5480bcc27d34257e52">&#9670;&#160;</a></span>_create_regression_targets()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._create_regression_targets </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns a regression target for each anchor.

Args:
  anchors: a BoxList representing N anchors
  groundtruth_boxes: a BoxList representing M groundtruth_boxes
  match: a matcher.Match object

Returns:
  reg_targets: a float32 tensor with shape [N, box_code_dimension]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00235">235</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>  <span class="keyword">def </span>_create_regression_targets(self, anchors, groundtruth_boxes, match):</div>
<div class="line"><span class="lineno">  236</span>    <span class="stringliteral">&quot;&quot;&quot;Returns a regression target for each anchor.</span></div>
<div class="line"><span class="lineno">  237</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  238</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  239</span><span class="stringliteral">      anchors: a BoxList representing N anchors</span></div>
<div class="line"><span class="lineno">  240</span><span class="stringliteral">      groundtruth_boxes: a BoxList representing M groundtruth_boxes</span></div>
<div class="line"><span class="lineno">  241</span><span class="stringliteral">      match: a matcher.Match object</span></div>
<div class="line"><span class="lineno">  242</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  243</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  244</span><span class="stringliteral">      reg_targets: a float32 tensor </span><span class="keyword">with</span> shape [N, box_code_dimension]</div>
<div class="line"><span class="lineno">  245</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  246</span><span class="stringliteral">    matched_gt_boxes = match.gather_based_on_match(</span></div>
<div class="line"><span class="lineno">  247</span><span class="stringliteral">        groundtruth_boxes.get(),</span></div>
<div class="line"><span class="lineno">  248</span><span class="stringliteral">        unmatched_value=tf.zeros(4),</span></div>
<div class="line"><span class="lineno">  249</span><span class="stringliteral">        ignored_value=tf.zeros(4))</span></div>
<div class="line"><span class="lineno">  250</span><span class="stringliteral">    matched_gt_boxlist = box_list.BoxList(matched_gt_boxes)</span></div>
<div class="line"><span class="lineno">  251</span><span class="stringliteral">    </span><span class="keywordflow">if</span> groundtruth_boxes.has_field(fields.BoxListFields.keypoints):</div>
<div class="line"><span class="lineno">  252</span>      groundtruth_keypoints = groundtruth_boxes.get_field(</div>
<div class="line"><span class="lineno">  253</span>          fields.BoxListFields.keypoints)</div>
<div class="line"><span class="lineno">  254</span>      matched_keypoints = match.gather_based_on_match(</div>
<div class="line"><span class="lineno">  255</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno">  256</span>          unmatched_value=tf.zeros(groundtruth_keypoints.get_shape()[1:]),</div>
<div class="line"><span class="lineno">  257</span>          ignored_value=tf.zeros(groundtruth_keypoints.get_shape()[1:]))</div>
<div class="line"><span class="lineno">  258</span>      matched_gt_boxlist.add_field(fields.BoxListFields.keypoints,</div>
<div class="line"><span class="lineno">  259</span>                                   matched_keypoints)</div>
<div class="line"><span class="lineno">  260</span>    matched_reg_targets = self._box_coder.encode(matched_gt_boxlist, anchors)</div>
<div class="line"><span class="lineno">  261</span>    match_results_shape = shape_utils.combined_static_and_dynamic_shape(</div>
<div class="line"><span class="lineno">  262</span>        match.match_results)</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>    <span class="comment"># Zero out the unmatched and ignored regression targets.</span></div>
<div class="line"><span class="lineno">  265</span>    unmatched_ignored_reg_targets = tf.tile(</div>
<div class="line"><span class="lineno">  266</span>        self._default_regression_target(), [match_results_shape[0], 1])</div>
<div class="line"><span class="lineno">  267</span>    matched_anchors_mask = match.matched_column_indicator()</div>
<div class="line"><span class="lineno">  268</span>    reg_targets = tf.where(matched_anchors_mask,</div>
<div class="line"><span class="lineno">  269</span>                           matched_reg_targets,</div>
<div class="line"><span class="lineno">  270</span>                           unmatched_ignored_reg_targets)</div>
<div class="line"><span class="lineno">  271</span>    <span class="keywordflow">return</span> reg_targets</div>
<div class="line"><span class="lineno">  272</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_cgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_cgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_cgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,184,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#ae23b0df4f870baf8084bfd8cf6b06864" title=" " alt="" coords="232,5,407,60"/>
<area shape="poly" title=" " alt="" coords="184,30,218,30,218,35,184,35"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a016ef142db31cd5480bcc27d34257e52_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,443,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="a2cbf259274342a627ef7ab28fdeed92b" name="a2cbf259274342a627ef7ab28fdeed92b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2cbf259274342a627ef7ab28fdeed92b">&#9670;&#160;</a></span>_create_regression_weights()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._create_regression_weights </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_weights</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Set regression weight for each anchor.

Only positive anchors are set to contribute to the regression loss, so this
method returns a weight of 1 for every positive anchor and 0 for every
negative anchor.

Args:
  match: a matcher.Match object that provides a matching between anchors
    and groundtruth boxes.
  groundtruth_weights: a float tensor of shape [M] indicating the weight to
    assign to all anchors match to a particular groundtruth box.

Returns:
  a float32 tensor with shape [num_anchors] representing regression weights.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00316">316</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  316</span>  <span class="keyword">def </span>_create_regression_weights(self, match, groundtruth_weights):</div>
<div class="line"><span class="lineno">  317</span>    <span class="stringliteral">&quot;&quot;&quot;Set regression weight for each anchor.</span></div>
<div class="line"><span class="lineno">  318</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  319</span><span class="stringliteral">    Only positive anchors are set to contribute to the regression loss, so this</span></div>
<div class="line"><span class="lineno">  320</span><span class="stringliteral">    method returns a weight of 1 </span><span class="keywordflow">for</span> every positive anchor <span class="keywordflow">and</span> 0 <span class="keywordflow">for</span> every</div>
<div class="line"><span class="lineno">  321</span>    negative anchor.</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    Args:</div>
<div class="line"><span class="lineno">  324</span>      match: a matcher.Match object that provides a matching between anchors</div>
<div class="line"><span class="lineno">  325</span>        <span class="keywordflow">and</span> groundtruth boxes.</div>
<div class="line"><span class="lineno">  326</span>      groundtruth_weights: a float tensor of shape [M] indicating the weight to</div>
<div class="line"><span class="lineno">  327</span>        assign to all anchors match to a particular groundtruth box.</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    Returns:</div>
<div class="line"><span class="lineno">  330</span>      a float32 tensor <span class="keyword">with</span> shape [num_anchors] representing regression weights.</div>
<div class="line"><span class="lineno">  331</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  332</span><span class="stringliteral">    </span><span class="keywordflow">return</span> match.gather_based_on_match(</div>
<div class="line"><span class="lineno">  333</span>        groundtruth_weights, ignored_value=0., unmatched_value=0.)</div>
<div class="line"><span class="lineno">  334</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a2cbf259274342a627ef7ab28fdeed92b_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a2cbf259274342a627ef7ab28fdeed92b_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a2cbf259274342a627ef7ab28fdeed92b_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_a2cbf259274342a627ef7ab28fdeed92b_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,447,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="ae23b0df4f870baf8084bfd8cf6b06864" name="ae23b0df4f870baf8084bfd8cf6b06864"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae23b0df4f870baf8084bfd8cf6b06864">&#9670;&#160;</a></span>_default_regression_target()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._default_regression_target </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the default target for anchors to regress to.

Default regression targets are set to zero (though in
this implementation what these targets are set to should
not matter as the regression weight of any box set to
regress to the default target is zero).

Returns:
  default_target: a float32 tensor with shape [1, box_code_dimension]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00273">273</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  273</span>  <span class="keyword">def </span>_default_regression_target(self):</div>
<div class="line"><span class="lineno">  274</span>    <span class="stringliteral">&quot;&quot;&quot;Returns the default target for anchors to regress to.</span></div>
<div class="line"><span class="lineno">  275</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  276</span><span class="stringliteral">    Default regression targets are set to zero (though </span><span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  277</span>    this implementation what these targets are set to should</div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">not</span> matter <span class="keyword">as</span> the regression weight of any box set to</div>
<div class="line"><span class="lineno">  279</span>    regress to the default target <span class="keywordflow">is</span> zero).</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    Returns:</div>
<div class="line"><span class="lineno">  282</span>      default_target: a float32 tensor <span class="keyword">with</span> shape [1, box_code_dimension]</div>
<div class="line"><span class="lineno">  283</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  284</span><span class="stringliteral">    </span><span class="keywordflow">return</span> tf.constant([self._box_coder.code_size*[0]], tf.float32)</div>
<div class="line"><span class="lineno">  285</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_ae23b0df4f870baf8084bfd8cf6b06864_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_ae23b0df4f870baf8084bfd8cf6b06864_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_ae23b0df4f870baf8084bfd8cf6b06864_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_ae23b0df4f870baf8084bfd8cf6b06864_icgraph">
<area shape="rect" title=" " alt="" coords="491,5,665,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a016ef142db31cd5480bcc27d34257e52" title=" " alt="" coords="264,5,443,60"/>
<area shape="poly" title=" " alt="" coords="477,35,443,35,443,30,477,30"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="aa78d60ebbdfc66bd30abaacc40fbb862" name="aa78d60ebbdfc66bd30abaacc40fbb862"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa78d60ebbdfc66bd30abaacc40fbb862">&#9670;&#160;</a></span>_reset_target_shape()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._reset_target_shape </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_anchors</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Sets the static shape of the target.

Args:
  target: the target tensor. Its first dimension will be overwritten.
  num_anchors: the number of anchors, which is used to override the target's
    first dimension.

Returns:
  A tensor with the shape info filled in.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00219">219</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>  <span class="keyword">def </span>_reset_target_shape(self, target, num_anchors):</div>
<div class="line"><span class="lineno">  220</span>    <span class="stringliteral">&quot;&quot;&quot;Sets the static shape of the target.</span></div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  222</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  223</span><span class="stringliteral">      target: the target tensor. Its first dimension will be overwritten.</span></div>
<div class="line"><span class="lineno">  224</span><span class="stringliteral">      num_anchors: the number of anchors, which </span><span class="keywordflow">is</span> used to override the target<span class="stringliteral">&#39;s</span></div>
<div class="line"><span class="lineno">  225</span><span class="stringliteral">        first dimension.</span></div>
<div class="line"><span class="lineno">  226</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  227</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  228</span><span class="stringliteral">      A tensor </span><span class="keyword">with</span> the shape info filled <span class="keywordflow">in</span>.</div>
<div class="line"><span class="lineno">  229</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  230</span><span class="stringliteral">    target_shape = target.get_shape().as_list()</span></div>
<div class="line"><span class="lineno">  231</span><span class="stringliteral">    target_shape[0] = num_anchors</span></div>
<div class="line"><span class="lineno">  232</span><span class="stringliteral">    target.set_shape(target_shape)</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">    </span><span class="keywordflow">return</span> target</div>
<div class="line"><span class="lineno">  234</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa78d60ebbdfc66bd30abaacc40fbb862_icgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa78d60ebbdfc66bd30abaacc40fbb862_icgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa78d60ebbdfc66bd30abaacc40fbb862_icgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa78d60ebbdfc66bd30abaacc40fbb862_icgraph">
<area shape="rect" title=" " alt="" coords="264,5,437,60"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa80703dd201eafe98e23eb84c81a25cc" title=" " alt="" coords="5,13,216,53"/>
<area shape="poly" title=" " alt="" coords="250,35,216,35,216,30,250,30"/>
</map>
</div>

</div>
</div>
<a id="aa80703dd201eafe98e23eb84c81a25cc" name="aa80703dd201eafe98e23eb84c81a25cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa80703dd201eafe98e23eb84c81a25cc">&#9670;&#160;</a></span>assign()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner.assign </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>anchors</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>unmatched_class_label</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>groundtruth_weights</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Assign classification and regression targets to each anchor.

For a given set of anchors and groundtruth detections, match anchors
to groundtruth_boxes and assign classification and regression targets to
each anchor as well as weights based on the resulting match (specifying,
e.g., which anchors should not contribute to training loss).

Anchors that are not matched to anything are given a classification target
of self._unmatched_cls_target which can be specified via the constructor.

Args:
  anchors: a BoxList representing N anchors
  groundtruth_boxes: a BoxList representing M groundtruth boxes
  groundtruth_labels:  a tensor of shape [M, d_1, ... d_k]
    with labels for each of the ground_truth boxes. The subshape
    [d_1, ... d_k] can be empty (corresponding to scalar inputs).  When set
    to None, groundtruth_labels assumes a binary problem where all
    ground_truth boxes get a positive label (of 1).
  unmatched_class_label: a float32 tensor with shape [d_1, d_2, ..., d_k]
    which is consistent with the classification target for each
    anchor (and can be empty for scalar targets).  This shape must thus be
    compatible with the groundtruth labels that are passed to the "assign"
    function (which have shape [num_gt_boxes, d_1, d_2, ..., d_k]).
    If set to None, unmatched_cls_target is set to be [0] for each anchor.
  groundtruth_weights: a float tensor of shape [M] indicating the weight to
    assign to all anchors match to a particular groundtruth box. The weights
    must be in [0., 1.]. If None, all weights are set to 1. Generally no
    groundtruth boxes with zero weight match to any anchors as matchers are
    aware of groundtruth weights. Additionally, `cls_weights` and
    `reg_weights` are calculated using groundtruth weights as an added
    safety.

Returns:
  cls_targets: a float32 tensor with shape [num_anchors, d_1, d_2 ... d_k],
    where the subshape [d_1, ..., d_k] is compatible with groundtruth_labels
    which has shape [num_gt_boxes, d_1, d_2, ... d_k].
  cls_weights: a float32 tensor with shape [num_anchors, d_1, d_2 ... d_k],
    representing weights for each element in cls_targets.
  reg_targets: a float32 tensor with shape [num_anchors, box_code_dimension]
  reg_weights: a float32 tensor with shape [num_anchors]
  match: an int32 tensor of shape [num_anchors] containing result of anchor
    groundtruth matching. Each position in the tensor indicates an anchor
    and holds the following meaning:
    (1) if match[i] &gt;= 0, anchor i is matched with groundtruth match[i].
    (2) if match[i]=-1, anchor i is marked to be background .
    (3) if match[i]=-2, anchor i is ignored since it is not background and
        does not have sufficient overlap to call it a foreground.

Raises:
  ValueError: if anchors or groundtruth_boxes are not of type
    box_list.BoxList
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00093">93</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>             groundtruth_weights=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">   99</span>    <span class="stringliteral">&quot;&quot;&quot;Assign classification and regression targets to each anchor.</span></div>
<div class="line"><span class="lineno">  100</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  101</span><span class="stringliteral">    For a given set of anchors </span><span class="keywordflow">and</span> groundtruth detections, match anchors</div>
<div class="line"><span class="lineno">  102</span>    to groundtruth_boxes <span class="keywordflow">and</span> assign classification <span class="keywordflow">and</span> regression targets to</div>
<div class="line"><span class="lineno">  103</span>    each anchor <span class="keyword">as</span> well <span class="keyword">as</span> weights based on the resulting match (specifying,</div>
<div class="line"><span class="lineno">  104</span>    e.g., which anchors should <span class="keywordflow">not</span> contribute to training loss).</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    Anchors that are <span class="keywordflow">not</span> matched to anything are given a classification target</div>
<div class="line"><span class="lineno">  107</span>    of self._unmatched_cls_target which can be specified via the constructor.</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>    Args:</div>
<div class="line"><span class="lineno">  110</span>      anchors: a BoxList representing N anchors</div>
<div class="line"><span class="lineno">  111</span>      groundtruth_boxes: a BoxList representing M groundtruth boxes</div>
<div class="line"><span class="lineno">  112</span>      groundtruth_labels:  a tensor of shape [M, d_1, ... d_k]</div>
<div class="line"><span class="lineno">  113</span>        <span class="keyword">with</span> labels <span class="keywordflow">for</span> each of the ground_truth boxes. The subshape</div>
<div class="line"><span class="lineno">  114</span>        [d_1, ... d_k] can be empty (corresponding to scalar inputs).  When set</div>
<div class="line"><span class="lineno">  115</span>        to <span class="keywordtype">None</span>, groundtruth_labels assumes a binary problem where all</div>
<div class="line"><span class="lineno">  116</span>        ground_truth boxes get a positive label (of 1).</div>
<div class="line"><span class="lineno">  117</span>      unmatched_class_label: a float32 tensor <span class="keyword">with</span> shape [d_1, d_2, ..., d_k]</div>
<div class="line"><span class="lineno">  118</span>        which <span class="keywordflow">is</span> consistent <span class="keyword">with</span> the classification target <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno">  119</span>        anchor (<span class="keywordflow">and</span> can be empty <span class="keywordflow">for</span> scalar targets).  This shape must thus be</div>
<div class="line"><span class="lineno">  120</span>        compatible <span class="keyword">with</span> the groundtruth labels that are passed to the <span class="stringliteral">&quot;assign&quot;</span></div>
<div class="line"><span class="lineno">  121</span>        function (which have shape [num_gt_boxes, d_1, d_2, ..., d_k]).</div>
<div class="line"><span class="lineno">  122</span>        If set to <span class="keywordtype">None</span>, unmatched_cls_target <span class="keywordflow">is</span> set to be [0] <span class="keywordflow">for</span> each anchor.</div>
<div class="line"><span class="lineno">  123</span>      groundtruth_weights: a float tensor of shape [M] indicating the weight to</div>
<div class="line"><span class="lineno">  124</span>        assign to all anchors match to a particular groundtruth box. The weights</div>
<div class="line"><span class="lineno">  125</span>        must be <span class="keywordflow">in</span> [0., 1.]. If <span class="keywordtype">None</span>, all weights are set to 1. Generally no</div>
<div class="line"><span class="lineno">  126</span>        groundtruth boxes <span class="keyword">with</span> zero weight match to any anchors <span class="keyword">as</span> matchers are</div>
<div class="line"><span class="lineno">  127</span>        aware of groundtruth weights. Additionally, `cls_weights` <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  128</span>        `reg_weights` are calculated using groundtruth weights <span class="keyword">as</span> an added</div>
<div class="line"><span class="lineno">  129</span>        safety.</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    Returns:</div>
<div class="line"><span class="lineno">  132</span>      cls_targets: a float32 tensor <span class="keyword">with</span> shape [num_anchors, d_1, d_2 ... d_k],</div>
<div class="line"><span class="lineno">  133</span>        where the subshape [d_1, ..., d_k] <span class="keywordflow">is</span> compatible <span class="keyword">with</span> groundtruth_labels</div>
<div class="line"><span class="lineno">  134</span>        which has shape [num_gt_boxes, d_1, d_2, ... d_k].</div>
<div class="line"><span class="lineno">  135</span>      cls_weights: a float32 tensor <span class="keyword">with</span> shape [num_anchors, d_1, d_2 ... d_k],</div>
<div class="line"><span class="lineno">  136</span>        representing weights <span class="keywordflow">for</span> each element <span class="keywordflow">in</span> cls_targets.</div>
<div class="line"><span class="lineno">  137</span>      reg_targets: a float32 tensor <span class="keyword">with</span> shape [num_anchors, box_code_dimension]</div>
<div class="line"><span class="lineno">  138</span>      reg_weights: a float32 tensor <span class="keyword">with</span> shape [num_anchors]</div>
<div class="line"><span class="lineno">  139</span>      match: an int32 tensor of shape [num_anchors] containing result of anchor</div>
<div class="line"><span class="lineno">  140</span>        groundtruth matching. Each position <span class="keywordflow">in</span> the tensor indicates an anchor</div>
<div class="line"><span class="lineno">  141</span>        <span class="keywordflow">and</span> holds the following meaning:</div>
<div class="line"><span class="lineno">  142</span>        (1) <span class="keywordflow">if</span> match[i] &gt;= 0, anchor i <span class="keywordflow">is</span> matched <span class="keyword">with</span> groundtruth match[i].</div>
<div class="line"><span class="lineno">  143</span>        (2) <span class="keywordflow">if</span> match[i]=-1, anchor i <span class="keywordflow">is</span> marked to be background .</div>
<div class="line"><span class="lineno">  144</span>        (3) <span class="keywordflow">if</span> match[i]=-2, anchor i <span class="keywordflow">is</span> ignored since it <span class="keywordflow">is</span> <span class="keywordflow">not</span> background <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  145</span>            does <span class="keywordflow">not</span> have sufficient overlap to call it a foreground.</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    Raises:</div>
<div class="line"><span class="lineno">  148</span>      ValueError: <span class="keywordflow">if</span> anchors <span class="keywordflow">or</span> groundtruth_boxes are <span class="keywordflow">not</span> of type</div>
<div class="line"><span class="lineno">  149</span>        box_list.BoxList</div>
<div class="line"><span class="lineno">  150</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">    </span><span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(anchors, box_list.BoxList):</div>
<div class="line"><span class="lineno">  152</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;anchors must be an BoxList&#39;</span>)</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(groundtruth_boxes, box_list.BoxList):</div>
<div class="line"><span class="lineno">  154</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;groundtruth_boxes must be an BoxList&#39;</span>)</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>    <span class="keywordflow">if</span> unmatched_class_label <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  157</span>      unmatched_class_label = tf.constant([0], tf.float32)</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>    <span class="keywordflow">if</span> groundtruth_labels <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  160</span>      groundtruth_labels = tf.ones(tf.expand_dims(groundtruth_boxes.num_boxes(),</div>
<div class="line"><span class="lineno">  161</span>                                                  0))</div>
<div class="line"><span class="lineno">  162</span>      groundtruth_labels = tf.expand_dims(groundtruth_labels, -1)</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>    unmatched_shape_assert = shape_utils.assert_shape_equal(</div>
<div class="line"><span class="lineno">  165</span>        shape_utils.combined_static_and_dynamic_shape(groundtruth_labels)[1:],</div>
<div class="line"><span class="lineno">  166</span>        shape_utils.combined_static_and_dynamic_shape(unmatched_class_label))</div>
<div class="line"><span class="lineno">  167</span>    labels_and_box_shapes_assert = shape_utils.assert_shape_equal(</div>
<div class="line"><span class="lineno">  168</span>        shape_utils.combined_static_and_dynamic_shape(</div>
<div class="line"><span class="lineno">  169</span>            groundtruth_labels)[:1],</div>
<div class="line"><span class="lineno">  170</span>        shape_utils.combined_static_and_dynamic_shape(</div>
<div class="line"><span class="lineno">  171</span>            groundtruth_boxes.get())[:1])</div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    <span class="keywordflow">if</span> groundtruth_weights <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  174</span>      num_gt_boxes = groundtruth_boxes.num_boxes_static()</div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">if</span> <span class="keywordflow">not</span> num_gt_boxes:</div>
<div class="line"><span class="lineno">  176</span>        num_gt_boxes = groundtruth_boxes.num_boxes()</div>
<div class="line"><span class="lineno">  177</span>      groundtruth_weights = tf.ones([num_gt_boxes], dtype=tf.float32)</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    <span class="comment"># set scores on the gt boxes</span></div>
<div class="line"><span class="lineno">  180</span>    scores = 1 - groundtruth_labels[:, 0]</div>
<div class="line"><span class="lineno">  181</span>    groundtruth_boxes.add_field(fields.BoxListFields.scores, scores)</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>    <span class="keyword">with</span> tf.control_dependencies(</div>
<div class="line"><span class="lineno">  184</span>        [unmatched_shape_assert, labels_and_box_shapes_assert]):</div>
<div class="line"><span class="lineno">  185</span>      match_quality_matrix = self._similarity_calc.compare(groundtruth_boxes,</div>
<div class="line"><span class="lineno">  186</span>                                                           anchors)</div>
<div class="line"><span class="lineno">  187</span>      match = self._matcher.match(match_quality_matrix,</div>
<div class="line"><span class="lineno">  188</span>                                  valid_rows=tf.greater(groundtruth_weights, 0))</div>
<div class="line"><span class="lineno">  189</span>      reg_targets = self._create_regression_targets(anchors,</div>
<div class="line"><span class="lineno">  190</span>                                                    groundtruth_boxes,</div>
<div class="line"><span class="lineno">  191</span>                                                    match)</div>
<div class="line"><span class="lineno">  192</span>      cls_targets = self._create_classification_targets(groundtruth_labels,</div>
<div class="line"><span class="lineno">  193</span>                                                        unmatched_class_label,</div>
<div class="line"><span class="lineno">  194</span>                                                        match)</div>
<div class="line"><span class="lineno">  195</span>      reg_weights = self._create_regression_weights(match, groundtruth_weights)</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>      cls_weights = self._create_classification_weights(match,</div>
<div class="line"><span class="lineno">  198</span>                                                        groundtruth_weights)</div>
<div class="line"><span class="lineno">  199</span>      <span class="comment"># convert cls_weights from per-anchor to per-class.</span></div>
<div class="line"><span class="lineno">  200</span>      class_label_shape = tf.shape(cls_targets)[1:]</div>
<div class="line"><span class="lineno">  201</span>      weights_shape = tf.shape(cls_weights)</div>
<div class="line"><span class="lineno">  202</span>      weights_multiple = tf.concat(</div>
<div class="line"><span class="lineno">  203</span>          [tf.ones_like(weights_shape), class_label_shape],</div>
<div class="line"><span class="lineno">  204</span>          axis=0)</div>
<div class="line"><span class="lineno">  205</span>      <span class="keywordflow">for</span> _ <span class="keywordflow">in</span> range(len(cls_targets.get_shape()[1:])):</div>
<div class="line"><span class="lineno">  206</span>        cls_weights = tf.expand_dims(cls_weights, -1)</div>
<div class="line"><span class="lineno">  207</span>      cls_weights = tf.tile(cls_weights, weights_multiple)</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>    num_anchors = anchors.num_boxes_static()</div>
<div class="line"><span class="lineno">  210</span>    <span class="keywordflow">if</span> num_anchors <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  211</span>      reg_targets = self._reset_target_shape(reg_targets, num_anchors)</div>
<div class="line"><span class="lineno">  212</span>      cls_targets = self._reset_target_shape(cls_targets, num_anchors)</div>
<div class="line"><span class="lineno">  213</span>      reg_weights = self._reset_target_shape(reg_weights, num_anchors)</div>
<div class="line"><span class="lineno">  214</span>      cls_weights = self._reset_target_shape(cls_weights, num_anchors)</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    <span class="keywordflow">return</span> (cls_targets, cls_weights, reg_targets, reg_weights,</div>
<div class="line"><span class="lineno">  217</span>            match.match_results)</div>
<div class="line"><span class="lineno">  218</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa80703dd201eafe98e23eb84c81a25cc_cgraph.png" border="0" usemap="#adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa80703dd201eafe98e23eb84c81a25cc_cgraph" alt=""/></div>
<map name="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa80703dd201eafe98e23eb84c81a25cc_cgraph" id="adb/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner_aa80703dd201eafe98e23eb84c81a25cc_cgraph">
<area shape="rect" title=" " alt="" coords="5,170,216,210"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a7982f9b90978822c9d33ab953a642710" title=" " alt="" coords="266,5,461,60"/>
<area shape="poly" title=" " alt="" coords="132,168,189,120,263,69,272,64,275,68,265,74,192,124,135,172"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a1d8790c2c9892744fcc5c8280be39905" title=" " alt="" coords="264,84,463,139"/>
<area shape="poly" title=" " alt="" coords="175,167,261,140,263,145,177,172"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a016ef142db31cd5480bcc27d34257e52" title=" " alt="" coords="274,163,453,217"/>
<area shape="poly" title=" " alt="" coords="216,187,260,187,260,193,216,193"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#a2cbf259274342a627ef7ab28fdeed92b" title=" " alt="" coords="272,241,455,296"/>
<area shape="poly" title=" " alt="" coords="177,208,263,235,261,240,175,213"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#aa78d60ebbdfc66bd30abaacc40fbb862" title=" " alt="" coords="277,320,450,375"/>
<area shape="poly" title=" " alt="" coords="136,208,193,255,265,305,278,312,275,316,263,310,190,260,133,212"/>
<area shape="rect" href="../../db/d89/classdetection__utils_1_1core_1_1target__assigner_1_1_target_assigner.html#ae23b0df4f870baf8084bfd8cf6b06864" title=" " alt="" coords="511,163,685,217"/>
<area shape="poly" title=" " alt="" coords="453,187,497,187,497,193,453,193"/>
</map>
</div>

</div>
</div>
<a id="aba5655fc6bb850dddc28f733d0e14737" name="aba5655fc6bb850dddc28f733d0e14737"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba5655fc6bb850dddc28f733d0e14737">&#9670;&#160;</a></span>box_coder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner.box_coder </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00089">89</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   89</span>  <span class="keyword">def </span><a class="code hl_namespace" href="../../df/d3f/namespacebox__coder.html">box_coder</a>(self):</div>
<div class="line"><span class="lineno">   90</span>    <span class="keywordflow">return</span> self._box_coder</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="ttc" id="anamespacebox__coder_html"><div class="ttname"><a href="../../df/d3f/namespacebox__coder.html">box_coder</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a458e6bab7f3aa2a797f45d1c71d51d61" name="a458e6bab7f3aa2a797f45d1c71d51d61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a458e6bab7f3aa2a797f45d1c71d51d61">&#9670;&#160;</a></span>get_box_coder()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner.get_box_coder </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Get BoxCoder of this TargetAssigner.

Returns:
  BoxCoder object.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00362">362</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  362</span>  <span class="keyword">def </span>get_box_coder(self):</div>
<div class="line"><span class="lineno">  363</span>    <span class="stringliteral">&quot;&quot;&quot;Get BoxCoder of this TargetAssigner.</span></div>
<div class="line"><span class="lineno">  364</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  365</span><span class="stringliteral">    Returns:</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral">      BoxCoder object.</span></div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">    &quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  368</span><span class="stringliteral">    </span><span class="keywordflow">return</span> self._box_coder</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span><span class="comment"># TODO(rathodv): This method pulls in all the implementation dependencies into</span></div>
<div class="line"><span class="lineno">  372</span><span class="comment"># core. Therefore its best to have this factory method outside of core.</span></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a1ff2854b0fb78bf9dfd57a9be5c79038" name="a1ff2854b0fb78bf9dfd57a9be5c79038"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1ff2854b0fb78bf9dfd57a9be5c79038">&#9670;&#160;</a></span>_box_coder</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._box_coder</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00085">85</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>

</div>
</div>
<a id="a3991ae175584cf83f92e64c06e74032d" name="a3991ae175584cf83f92e64c06e74032d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3991ae175584cf83f92e64c06e74032d">&#9670;&#160;</a></span>_matcher</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._matcher</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00084">84</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>

</div>
</div>
<a id="a48a3b327c36174ef156bb835520d26db" name="a48a3b327c36174ef156bb835520d26db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48a3b327c36174ef156bb835520d26db">&#9670;&#160;</a></span>_negative_class_weight</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._negative_class_weight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00086">86</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>

</div>
</div>
<a id="a8f23d4b36a5315deb3b3d7aa1730509e" name="a8f23d4b36a5315deb3b3d7aa1730509e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f23d4b36a5315deb3b3d7aa1730509e">&#9670;&#160;</a></span>_similarity_calc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.target_assigner.TargetAssigner._similarity_calc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d4/d4b/target__assigner_8py_source.html#l00083">83</a> of file <a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/resources/processing/video/detections/detection_utils/core/<a class="el" href="../../d4/d4b/target__assigner_8py_source.html">target_assigner.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
