<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RESIIST: detection_utils.utils.metrics Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RESIIST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d97/namespacedetection__utils.html">detection_utils</a></li><li class="navelem"><a class="el" href="../../d5/d2b/namespacedetection__utils_1_1utils.html">utils</a></li><li class="navelem"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html">metrics</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">detection_utils.utils.metrics Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:aa5958d51e1d62d49fa7cf782d046b674"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html#aa5958d51e1d62d49fa7cf782d046b674">compute_precision_recall</a> (scores, labels, num_gt)</td></tr>
<tr class="separator:aa5958d51e1d62d49fa7cf782d046b674"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f0aef1fb969045b86737668191fde81"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html#a0f0aef1fb969045b86737668191fde81">compute_average_precision</a> (precision, recall)</td></tr>
<tr class="separator:a0f0aef1fb969045b86737668191fde81"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7c2abf31157d3c5d95e47a1b8f2d3af3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html#a7c2abf31157d3c5d95e47a1b8f2d3af3">compute_cor_loc</a> (num_gt_imgs_per_class, num_images_correctly_detected_per_class)</td></tr>
<tr class="separator:a7c2abf31157d3c5d95e47a1b8f2d3af3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea6346c967800d2ec215d698fbf39082"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html#aea6346c967800d2ec215d698fbf39082">compute_median_rank_at_k</a> (tp_fp_list, k)</td></tr>
<tr class="separator:aea6346c967800d2ec215d698fbf39082"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27dea25701e731a64eb95c6244ca5bc0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/dde/namespacedetection__utils_1_1utils_1_1metrics.html#a27dea25701e731a64eb95c6244ca5bc0">compute_recall_at_k</a> (tp_fp_list, num_gt, k)</td></tr>
<tr class="separator:a27dea25701e731a64eb95c6244ca5bc0"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Functions for computing metrics like precision, recall, CorLoc and etc.</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a0f0aef1fb969045b86737668191fde81" name="a0f0aef1fb969045b86737668191fde81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f0aef1fb969045b86737668191fde81">&#9670;&#160;</a></span>compute_average_precision()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.utils.metrics.compute_average_precision </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>precision</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>recall</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute Average Precision according to the definition in VOCdevkit.

Precision is modified to ensure that it does not decrease as recall
decrease.

Args:
  precision: A float [N, 1] numpy array of precisions
  recall: A float [N, 1] numpy array of recalls

Raises:
  ValueError: if the input is not of the correct format

Returns:
  average_precison: The area under the precision recall curve. NaN if
    precision and recall are None.</pre> 
<p class="definition">Definition at line <a class="el" href="../../df/d68/metrics_8py_source.html#l00072">72</a> of file <a class="el" href="../../df/d68/metrics_8py_source.html">metrics.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   72</span><span class="keyword">def </span>compute_average_precision(precision, recall):</div>
<div class="line"><span class="lineno">   73</span>  <span class="stringliteral">&quot;&quot;&quot;Compute Average Precision according to the definition in VOCdevkit.</span></div>
<div class="line"><span class="lineno">   74</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   75</span><span class="stringliteral">  Precision </span><span class="keywordflow">is</span> modified to ensure that it does <span class="keywordflow">not</span> decrease <span class="keyword">as</span> recall</div>
<div class="line"><span class="lineno">   76</span>  decrease.</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  Args:</div>
<div class="line"><span class="lineno">   79</span>    precision: A float [N, 1] numpy array of precisions</div>
<div class="line"><span class="lineno">   80</span>    recall: A float [N, 1] numpy array of recalls</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  Raises:</div>
<div class="line"><span class="lineno">   83</span>    ValueError: <span class="keywordflow">if</span> the input <span class="keywordflow">is</span> <span class="keywordflow">not</span> of the correct format</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  Returns:</div>
<div class="line"><span class="lineno">   86</span>    average_precison: The area under the precision recall curve. NaN <span class="keywordflow">if</span></div>
<div class="line"><span class="lineno">   87</span>      precision <span class="keywordflow">and</span> recall are <span class="keywordtype">None</span>.</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   90</span><span class="stringliteral">  </span><span class="keywordflow">if</span> precision <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordflow">if</span> recall <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">   92</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;If precision is None, recall must also be None&quot;</span>)</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">return</span> np.NAN</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(precision, np.ndarray) <span class="keywordflow">or</span> <span class="keywordflow">not</span> isinstance(</div>
<div class="line"><span class="lineno">   96</span>      recall, np.ndarray):</div>
<div class="line"><span class="lineno">   97</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;precision and recall must be numpy array&quot;</span>)</div>
<div class="line"><span class="lineno">   98</span>  <span class="keywordflow">if</span> precision.dtype != np.float <span class="keywordflow">or</span> recall.dtype != np.float:</div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;input must be float numpy array.&quot;</span>)</div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">if</span> len(precision) != len(recall):</div>
<div class="line"><span class="lineno">  101</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;precision and recall must be of the same size.&quot;</span>)</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> precision.size:</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">return</span> 0.0</div>
<div class="line"><span class="lineno">  104</span>  <span class="keywordflow">if</span> np.amin(precision) &lt; 0 <span class="keywordflow">or</span> np.amax(precision) &gt; 1:</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Precision must be in the range of [0, 1].&quot;</span>)</div>
<div class="line"><span class="lineno">  106</span>  <span class="keywordflow">if</span> np.amin(recall) &lt; 0 <span class="keywordflow">or</span> np.amax(recall) &gt; 1:</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;recall must be in the range of [0, 1].&quot;</span>)</div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> all(recall[i] &lt;= recall[i + 1] <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(recall) - 1)):</div>
<div class="line"><span class="lineno">  109</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;recall must be a non-decreasing array&quot;</span>)</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  recall = np.concatenate([[0], recall, [1]])</div>
<div class="line"><span class="lineno">  112</span>  precision = np.concatenate([[0], precision, [0]])</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span>  <span class="comment"># Preprocess precision to be a non-decreasing array</span></div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(precision) - 2, -1, -1):</div>
<div class="line"><span class="lineno">  116</span>    precision[i] = np.maximum(precision[i], precision[i + 1])</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  indices = np.where(recall[1:] != recall[:-1])[0] + 1</div>
<div class="line"><span class="lineno">  119</span>  average_precision = np.sum(</div>
<div class="line"><span class="lineno">  120</span>      (recall[indices] - recall[indices - 1]) * precision[indices])</div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordflow">return</span> average_precision</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7c2abf31157d3c5d95e47a1b8f2d3af3" name="a7c2abf31157d3c5d95e47a1b8f2d3af3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7c2abf31157d3c5d95e47a1b8f2d3af3">&#9670;&#160;</a></span>compute_cor_loc()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.utils.metrics.compute_cor_loc </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_gt_imgs_per_class</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_images_correctly_detected_per_class</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute CorLoc according to the definition in the following paper.

https://www.robots.ox.ac.uk/~vgg/rg/papers/deselaers-eccv10.pdf

Returns nans if there are no ground truth images for a class.

Args:
  num_gt_imgs_per_class: 1D array, representing number of images containing
      at least one object instance of a particular class
  num_images_correctly_detected_per_class: 1D array, representing number of
      images that are correctly detected at least one object instance of a
      particular class

Returns:
  corloc_per_class: A float numpy array represents the corloc score of each
    class
</pre> 
<p class="definition">Definition at line <a class="el" href="../../df/d68/metrics_8py_source.html#l00124">124</a> of file <a class="el" href="../../df/d68/metrics_8py_source.html">metrics.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  125</span>                    num_images_correctly_detected_per_class):</div>
<div class="line"><span class="lineno">  126</span>  <span class="stringliteral">&quot;&quot;&quot;Compute CorLoc according to the definition in the following paper.</span></div>
<div class="line"><span class="lineno">  127</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  128</span><span class="stringliteral">  https://www.robots.ox.ac.uk/~vgg/rg/papers/deselaers-eccv10.pdf</span></div>
<div class="line"><span class="lineno">  129</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  130</span><span class="stringliteral">  Returns nans </span><span class="keywordflow">if</span> there are no ground truth images <span class="keywordflow">for</span> a <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  Args:</div>
<div class="line"><span class="lineno">  133</span>    num_gt_imgs_per_class: 1D array, representing number of images containing</div>
<div class="line"><span class="lineno">  134</span>        at least one object instance of a particular <span class="keyword">class</span></div>
<div class="line"><span class="lineno">  135</span>    num_images_correctly_detected_per_class: 1D array, representing number of</div>
<div class="line"><span class="lineno">  136</span>        images that are correctly detected at least one object instance of a</div>
<div class="line"><span class="lineno">  137</span>        particular <span class="keyword">class</span></div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>  Returns:</div>
<div class="line"><span class="lineno">  140</span>    corloc_per_class: A float numpy array represents the corloc score of each</div>
<div class="line"><span class="lineno">  141</span>      <span class="keyword">class</span></div>
<div class="line"><span class="lineno">  142</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  143</span><span class="stringliteral">  </span><span class="keywordflow">return</span> np.where(</div>
<div class="line"><span class="lineno">  144</span>      num_gt_imgs_per_class == 0, np.nan,</div>
<div class="line"><span class="lineno">  145</span>      num_images_correctly_detected_per_class / num_gt_imgs_per_class)</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aea6346c967800d2ec215d698fbf39082" name="aea6346c967800d2ec215d698fbf39082"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea6346c967800d2ec215d698fbf39082">&#9670;&#160;</a></span>compute_median_rank_at_k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.utils.metrics.compute_median_rank_at_k </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tp_fp_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes MedianRank@k, where k is the top-scoring labels.

Args:
  tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all
      detection on a single image, where the detections are sorted by score in
      descending order. Further, each numpy array element can have boolean or
      float values. True positive elements have either value &gt;0.0 or True;
      any other value is considered false positive.
  k: number of top-scoring proposals to take.

Returns:
  median_rank: median rank of all true positive proposals among top k by
    score.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../df/d68/metrics_8py_source.html#l00148">148</a> of file <a class="el" href="../../df/d68/metrics_8py_source.html">metrics.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  148</span><span class="keyword">def </span>compute_median_rank_at_k(tp_fp_list, k):</div>
<div class="line"><span class="lineno">  149</span>  <span class="stringliteral">&quot;&quot;&quot;Computes MedianRank@k, where k is the top-scoring labels.</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">    tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">        detection on a single image, where the detections are sorted by score </span><span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  154</span>        descending order. Further, each numpy array element can have boolean <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  155</span>        float values. <span class="keyword">True</span> positive elements have either value &gt;0.0 <span class="keywordflow">or</span> <span class="keyword">True</span>;</div>
<div class="line"><span class="lineno">  156</span>        any other value <span class="keywordflow">is</span> considered false positive.</div>
<div class="line"><span class="lineno">  157</span>    k: number of top-scoring proposals to take.</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  Returns:</div>
<div class="line"><span class="lineno">  160</span>    median_rank: median rank of all true positive proposals among top k by</div>
<div class="line"><span class="lineno">  161</span>      score.</div>
<div class="line"><span class="lineno">  162</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  163</span><span class="stringliteral">  ranks = []</span></div>
<div class="line"><span class="lineno">  164</span><span class="stringliteral">  </span><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(tp_fp_list)):</div>
<div class="line"><span class="lineno">  165</span>    ranks.append(</div>
<div class="line"><span class="lineno">  166</span>        np.where(tp_fp_list[i][0:min(k, tp_fp_list[i].shape[0])] &gt; 0)[0])</div>
<div class="line"><span class="lineno">  167</span>  concatenated_ranks = np.concatenate(ranks)</div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordflow">return</span> np.median(concatenated_ranks)</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa5958d51e1d62d49fa7cf782d046b674" name="aa5958d51e1d62d49fa7cf782d046b674"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa5958d51e1d62d49fa7cf782d046b674">&#9670;&#160;</a></span>compute_precision_recall()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.utils.metrics.compute_precision_recall </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>scores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_gt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Compute precision and recall.

Args:
  scores: A float numpy array representing detection score
  labels: A float numpy array representing weighted true/false positive labels
  num_gt: Number of ground truth instances

Raises:
  ValueError: if the input is not of the correct format

Returns:
  precision: Fraction of positive instances over detected ones. This value is
    None if no ground truth labels are present.
  recall: Fraction of detected positive instance over all positive instances.
    This value is None if no ground truth labels are present.</pre> 
<p class="definition">Definition at line <a class="el" href="../../df/d68/metrics_8py_source.html#l00024">24</a> of file <a class="el" href="../../df/d68/metrics_8py_source.html">metrics.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span><span class="keyword">def </span>compute_precision_recall(scores, labels, num_gt):</div>
<div class="line"><span class="lineno">   25</span>  <span class="stringliteral">&quot;&quot;&quot;Compute precision and recall.</span></div>
<div class="line"><span class="lineno">   26</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   27</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">   28</span><span class="stringliteral">    scores: A float numpy array representing detection score</span></div>
<div class="line"><span class="lineno">   29</span><span class="stringliteral">    labels: A float numpy array representing weighted true/false positive labels</span></div>
<div class="line"><span class="lineno">   30</span><span class="stringliteral">    num_gt: Number of ground truth instances</span></div>
<div class="line"><span class="lineno">   31</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   32</span><span class="stringliteral">  Raises:</span></div>
<div class="line"><span class="lineno">   33</span><span class="stringliteral">    ValueError: </span><span class="keywordflow">if</span> the input <span class="keywordflow">is</span> <span class="keywordflow">not</span> of the correct format</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  Returns:</div>
<div class="line"><span class="lineno">   36</span>    precision: Fraction of positive instances over detected ones. This value <span class="keywordflow">is</span></div>
<div class="line"><span class="lineno">   37</span>      <span class="keywordtype">None</span> <span class="keywordflow">if</span> no ground truth labels are present.</div>
<div class="line"><span class="lineno">   38</span>    recall: Fraction of detected positive instance over all positive instances.</div>
<div class="line"><span class="lineno">   39</span>      This value <span class="keywordflow">is</span> <span class="keywordtype">None</span> <span class="keywordflow">if</span> no ground truth labels are present.</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">   42</span><span class="stringliteral">  </span><span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(labels, np.ndarray) <span class="keywordflow">or</span> len(labels.shape) != 1:</div>
<div class="line"><span class="lineno">   43</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;labels must be single dimension numpy array&quot;</span>)</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">if</span> labels.dtype != np.float <span class="keywordflow">and</span> labels.dtype != np.bool:</div>
<div class="line"><span class="lineno">   46</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;labels type must be either bool or float&quot;</span>)</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(scores, np.ndarray) <span class="keywordflow">or</span> len(scores.shape) != 1:</div>
<div class="line"><span class="lineno">   49</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;scores must be single dimension numpy array&quot;</span>)</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>  <span class="keywordflow">if</span> num_gt &lt; np.sum(labels):</div>
<div class="line"><span class="lineno">   52</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;Number of true positives must be smaller than num_gt.&quot;</span>)</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordflow">if</span> len(scores) != len(labels):</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&quot;scores and labels must be of the same size.&quot;</span>)</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">if</span> num_gt == 0:</div>
<div class="line"><span class="lineno">   58</span>    <span class="keywordflow">return</span> <span class="keywordtype">None</span>, <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  sorted_indices = np.argsort(scores)</div>
<div class="line"><span class="lineno">   61</span>  sorted_indices = sorted_indices[::-1]</div>
<div class="line"><span class="lineno">   62</span>  true_positive_labels = labels[sorted_indices]</div>
<div class="line"><span class="lineno">   63</span>  false_positive_labels = (true_positive_labels &lt;= 0).astype(float)</div>
<div class="line"><span class="lineno">   64</span>  cum_true_positives = np.cumsum(true_positive_labels)</div>
<div class="line"><span class="lineno">   65</span>  cum_false_positives = np.cumsum(false_positive_labels)</div>
<div class="line"><span class="lineno">   66</span>  precision = cum_true_positives.astype(float) / (</div>
<div class="line"><span class="lineno">   67</span>      cum_true_positives + cum_false_positives)</div>
<div class="line"><span class="lineno">   68</span>  recall = cum_true_positives.astype(float) / num_gt</div>
<div class="line"><span class="lineno">   69</span>  <span class="keywordflow">return</span> precision, recall</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a27dea25701e731a64eb95c6244ca5bc0" name="a27dea25701e731a64eb95c6244ca5bc0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27dea25701e731a64eb95c6244ca5bc0">&#9670;&#160;</a></span>compute_recall_at_k()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.utils.metrics.compute_recall_at_k </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tp_fp_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_gt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>k</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes Recall@k, MedianRank@k, where k is the top-scoring labels.

Args:
  tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all
      detection on a single image, where the detections are sorted by score in
      descending order. Further, each numpy array element can have boolean or
      float values. True positive elements have either value &gt;0.0 or True;
      any other value is considered false positive.
  num_gt: number of groundtruth anotations.
  k: number of top-scoring proposals to take.

Returns:
  recall: recall evaluated on the top k by score detections.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../df/d68/metrics_8py_source.html#l00171">171</a> of file <a class="el" href="../../df/d68/metrics_8py_source.html">metrics.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  171</span><span class="keyword">def </span>compute_recall_at_k(tp_fp_list, num_gt, k):</div>
<div class="line"><span class="lineno">  172</span>  <span class="stringliteral">&quot;&quot;&quot;Computes Recall@k, MedianRank@k, where k is the top-scoring labels.</span></div>
<div class="line"><span class="lineno">  173</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">    tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all</span></div>
<div class="line"><span class="lineno">  176</span><span class="stringliteral">        detection on a single image, where the detections are sorted by score </span><span class="keywordflow">in</span></div>
<div class="line"><span class="lineno">  177</span>        descending order. Further, each numpy array element can have boolean <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno">  178</span>        float values. <span class="keyword">True</span> positive elements have either value &gt;0.0 <span class="keywordflow">or</span> <span class="keyword">True</span>;</div>
<div class="line"><span class="lineno">  179</span>        any other value <span class="keywordflow">is</span> considered false positive.</div>
<div class="line"><span class="lineno">  180</span>    num_gt: number of groundtruth anotations.</div>
<div class="line"><span class="lineno">  181</span>    k: number of top-scoring proposals to take.</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  Returns:</div>
<div class="line"><span class="lineno">  184</span>    recall: recall evaluated on the top k by score detections.</div>
<div class="line"><span class="lineno">  185</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  186</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  187</span><span class="stringliteral">  tp_fp_eval = []</span></div>
<div class="line"><span class="lineno">  188</span><span class="stringliteral">  </span><span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(tp_fp_list)):</div>
<div class="line"><span class="lineno">  189</span>    tp_fp_eval.append(tp_fp_list[i][0:min(k, tp_fp_list[i].shape[0])])</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  tp_fp_eval = np.concatenate(tp_fp_eval)</div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span>  <span class="keywordflow">return</span> np.sum(tp_fp_eval) / num_gt</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
