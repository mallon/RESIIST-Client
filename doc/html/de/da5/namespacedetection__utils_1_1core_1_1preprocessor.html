<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RESIIST: detection_utils.core.preprocessor Namespace Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RESIIST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d97/namespacedetection__utils.html">detection_utils</a></li><li class="navelem"><a class="el" href="../../de/d5d/namespacedetection__utils_1_1core.html">core</a></li><li class="navelem"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html">preprocessor</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">detection_utils.core.preprocessor Namespace Reference</div></div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a72948ea20f73ededa0777968bb83c27f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a72948ea20f73ededa0777968bb83c27f">_apply_with_random_selector</a> (x, func, num_cases, preprocess_vars_cache=None, key='')</td></tr>
<tr class="separator:a72948ea20f73ededa0777968bb83c27f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a190734dcb563069386fbf10f1cdb044c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c">_apply_with_random_selector_tuples</a> (x, func, num_cases, preprocess_vars_cache=None, key='')</td></tr>
<tr class="separator:a190734dcb563069386fbf10f1cdb044c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8fea0b9f060eea936fac7e5dd5102df7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7">_get_or_create_preprocess_rand_vars</a> (generator_func, function_id, preprocess_vars_cache, key='')</td></tr>
<tr class="separator:a8fea0b9f060eea936fac7e5dd5102df7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3338c3143bc5c5a5f5cbf32be983a2f7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7">_random_integer</a> (minval, maxval, seed)</td></tr>
<tr class="separator:a3338c3143bc5c5a5f5cbf32be983a2f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a21e6f1c05910c4acb3c33771326514b5"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a21e6f1c05910c4acb3c33771326514b5">_rgb_to_grayscale</a> (images, name=None)</td></tr>
<tr class="separator:a21e6f1c05910c4acb3c33771326514b5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8750c531fcec2fa0f79087324bbbe86"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad8750c531fcec2fa0f79087324bbbe86">normalize_image</a> (image, original_minval, original_maxval, target_minval, target_maxval)</td></tr>
<tr class="separator:ad8750c531fcec2fa0f79087324bbbe86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a201500daba3cc396f12a14daa7c3e782"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a201500daba3cc396f12a14daa7c3e782">retain_boxes_above_threshold</a> (boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, threshold=0.0)</td></tr>
<tr class="separator:a201500daba3cc396f12a14daa7c3e782"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a326551a2f9d710995bf095ba1de2f76e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a326551a2f9d710995bf095ba1de2f76e">drop_label_probabilistically</a> (boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, dropped_label=None, drop_probability=0.0, seed=None)</td></tr>
<tr class="separator:a326551a2f9d710995bf095ba1de2f76e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedfac18f6ff4fa9921ab6862cf931b37"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aedfac18f6ff4fa9921ab6862cf931b37">remap_labels</a> (labels, original_labels=None, new_label=None)</td></tr>
<tr class="separator:aedfac18f6ff4fa9921ab6862cf931b37"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9de9f58390f2e1d905e660c6f3f8b3da"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9de9f58390f2e1d905e660c6f3f8b3da">_flip_boxes_left_right</a> (boxes)</td></tr>
<tr class="separator:a9de9f58390f2e1d905e660c6f3f8b3da"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7aadde1361f08d837700bfdc9e01b13"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7aadde1361f08d837700bfdc9e01b13">_flip_boxes_up_down</a> (boxes)</td></tr>
<tr class="separator:ab7aadde1361f08d837700bfdc9e01b13"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ed6539fa8576bc65e30e46a3f030140"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a5ed6539fa8576bc65e30e46a3f030140">_rot90_boxes</a> (boxes)</td></tr>
<tr class="separator:a5ed6539fa8576bc65e30e46a3f030140"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab2ac5f063f9892ff6d043f70b5026e9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aab2ac5f063f9892ff6d043f70b5026e9">_flip_masks_left_right</a> (masks)</td></tr>
<tr class="separator:aab2ac5f063f9892ff6d043f70b5026e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a916daef65c5c27ef1c9a3efd2d89e80a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a916daef65c5c27ef1c9a3efd2d89e80a">_flip_masks_up_down</a> (masks)</td></tr>
<tr class="separator:a916daef65c5c27ef1c9a3efd2d89e80a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4f95650b0d5024695ff3d9e18284e3c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad4f95650b0d5024695ff3d9e18284e3c">_rot90_masks</a> (masks)</td></tr>
<tr class="separator:ad4f95650b0d5024695ff3d9e18284e3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ad2674a88326abe9a620d33dc6dbaa7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9ad2674a88326abe9a620d33dc6dbaa7">random_horizontal_flip</a> (image, boxes=None, masks=None, keypoints=None, keypoint_flip_permutation=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a9ad2674a88326abe9a620d33dc6dbaa7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae3b102c4ba64515724d250cb08523bf3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae3b102c4ba64515724d250cb08523bf3">random_vertical_flip</a> (image, boxes=None, masks=None, keypoints=None, keypoint_flip_permutation=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ae3b102c4ba64515724d250cb08523bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a29eea225a5c9bad4c280532e7e51d401"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a29eea225a5c9bad4c280532e7e51d401">random_rotation90</a> (image, boxes=None, masks=None, keypoints=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a29eea225a5c9bad4c280532e7e51d401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d0c42728a0663d83a70ed01f309c393"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8d0c42728a0663d83a70ed01f309c393">random_pixel_value_scale</a> (image, minval=0.9, maxval=1.1, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a8d0c42728a0663d83a70ed01f309c393"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc0c8803b353e7a6795ba372e1a1640a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#adc0c8803b353e7a6795ba372e1a1640a">random_image_scale</a> (image, masks=None, min_scale_ratio=0.5, max_scale_ratio=2.0, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:adc0c8803b353e7a6795ba372e1a1640a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0f844301a276e66ee5b6443f5ea4594b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b">_augment_only_rgb_channels</a> (image, augment_function)</td></tr>
<tr class="separator:a0f844301a276e66ee5b6443f5ea4594b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643bc2872b76f353d6f342b56070c112"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a643bc2872b76f353d6f342b56070c112">random_rgb_to_gray</a> (image, probability=0.1, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a643bc2872b76f353d6f342b56070c112"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a79d5114c3c558ffb325b491e93921a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1a79d5114c3c558ffb325b491e93921a">random_adjust_brightness</a> (image, max_delta=0.2, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a1a79d5114c3c558ffb325b491e93921a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a299a97f4d9fc15b96cd138d910b0d4d7"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a299a97f4d9fc15b96cd138d910b0d4d7">random_adjust_contrast</a> (image, min_delta=0.8, max_delta=1.25, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a299a97f4d9fc15b96cd138d910b0d4d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1840c66a7b36bfefbcf7e2832cdbd881"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1840c66a7b36bfefbcf7e2832cdbd881">random_adjust_hue</a> (image, max_delta=0.02, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a1840c66a7b36bfefbcf7e2832cdbd881"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab7fcba6b229393eb466d7163c8b27e36"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7fcba6b229393eb466d7163c8b27e36">random_adjust_saturation</a> (image, min_delta=0.8, max_delta=1.25, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ab7fcba6b229393eb466d7163c8b27e36"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b87ac3b4ca959406f78a5e8f2782848"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848">random_distort_color</a> (image, color_ordering=0, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a6b87ac3b4ca959406f78a5e8f2782848"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a882986d9b1f998bc17947fce90f1af4d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a882986d9b1f998bc17947fce90f1af4d">random_jitter_boxes</a> (boxes, ratio=0.05, seed=None)</td></tr>
<tr class="separator:a882986d9b1f998bc17947fce90f1af4d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7996143b3e46240e14ccb89e89f3fe3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3">_strict_random_crop_image</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, min_object_covered=1.0, aspect_ratio_range=(0.75, 1.33), area_range=(0.1, 1.0), overlap_thresh=0.3, clip_boxes=True, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ae7996143b3e46240e14ccb89e89f3fe3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae53f685c9e071ec37c0829148e5067fe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe">random_crop_image</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, min_object_covered=1.0, aspect_ratio_range=(0.75, 1.33), area_range=(0.1, 1.0), overlap_thresh=0.3, clip_boxes=True, random_coef=0.0, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ae53f685c9e071ec37c0829148e5067fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a052201bdd4a37a3579ad79d129b0f4dc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc">random_pad_image</a> (image, boxes, keypoints=None, min_image_size=None, max_image_size=None, pad_color=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a052201bdd4a37a3579ad79d129b0f4dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3abbb64d99b25decfe25fec40a92a6b9"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3abbb64d99b25decfe25fec40a92a6b9">random_absolute_pad_image</a> (image, boxes, max_height_padding, max_width_padding, pad_color=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a3abbb64d99b25decfe25fec40a92a6b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad862ff65e576da434816a69fd341b3ff"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff">random_crop_pad_image</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, min_object_covered=1.0, aspect_ratio_range=(0.75, 1.33), area_range=(0.1, 1.0), overlap_thresh=0.3, clip_boxes=True, random_coef=0.0, min_padded_size_ratio=(1.0, 1.0), max_padded_size_ratio=(2.0, 2.0), pad_color=None, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ad862ff65e576da434816a69fd341b3ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed03769aeaaf1e8b96f676996f870e8c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aed03769aeaaf1e8b96f676996f870e8c">random_crop_to_aspect_ratio</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, aspect_ratio=1.0, overlap_thresh=0.3, clip_boxes=True, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:aed03769aeaaf1e8b96f676996f870e8c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab0a1f9342a5127f9b80e0ffdfe94fc59"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab0a1f9342a5127f9b80e0ffdfe94fc59">random_pad_to_aspect_ratio</a> (image, boxes, masks=None, keypoints=None, aspect_ratio=1.0, min_padded_size_ratio=(1.0, 1.0), max_padded_size_ratio=(2.0, 2.0), seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ab0a1f9342a5127f9b80e0ffdfe94fc59"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a840b20876c98b893ebbca8c363ecb020"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a840b20876c98b893ebbca8c363ecb020">random_black_patches</a> (image, max_black_patches=10, probability=0.5, size_to_image_ratio=0.1, random_seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a840b20876c98b893ebbca8c363ecb020"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a881d3a421a6d182837d12f713e87281f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a881d3a421a6d182837d12f713e87281f">autoaugment_image</a> (image, boxes, policy_name='v0')</td></tr>
<tr class="separator:a881d3a421a6d182837d12f713e87281f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5b56ca6c5c071667bfe3e86359cd31"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3e5b56ca6c5c071667bfe3e86359cd31">image_to_float</a> (image)</td></tr>
<tr class="separator:a3e5b56ca6c5c071667bfe3e86359cd31"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a06cc1c1f5cce3566bc6f1a4a865b613e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a06cc1c1f5cce3566bc6f1a4a865b613e">random_resize_method</a> (image, target_size, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a06cc1c1f5cce3566bc6f1a4a865b613e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa16c94ed6a6e3e2ee8e39a4a5d0212ba"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aa16c94ed6a6e3e2ee8e39a4a5d0212ba">resize_to_range</a> (image, masks=None, min_dimension=None, max_dimension=None, method=tf.image.ResizeMethod.BILINEAR, align_corners=False, pad_to_max_dimension=False, per_channel_pad_value=(0, 0, 0))</td></tr>
<tr class="separator:aa16c94ed6a6e3e2ee8e39a4a5d0212ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6a294fdb039f62a6de9b9be007481357"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6a294fdb039f62a6de9b9be007481357">_get_image_info</a> (image)</td></tr>
<tr class="separator:a6a294fdb039f62a6de9b9be007481357"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae31da8a2456c9fd96e951ec2564a04ef"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae31da8a2456c9fd96e951ec2564a04ef">resize_to_min_dimension</a> (image, masks=None, min_dimension=600, method=tf.image.ResizeMethod.BILINEAR)</td></tr>
<tr class="separator:ae31da8a2456c9fd96e951ec2564a04ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad8ce6e9aabff130be4839677d2ece3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0ad8ce6e9aabff130be4839677d2ece3">resize_to_max_dimension</a> (image, masks=None, max_dimension=600, method=tf.image.ResizeMethod.BILINEAR)</td></tr>
<tr class="separator:a0ad8ce6e9aabff130be4839677d2ece3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b0e9e173acdfd6bdc495be778c346e3"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0b0e9e173acdfd6bdc495be778c346e3">scale_boxes_to_pixel_coordinates</a> (image, boxes, keypoints=None)</td></tr>
<tr class="separator:a0b0e9e173acdfd6bdc495be778c346e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a594f3c0e2cdc3464ad0cf5c85359293b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a594f3c0e2cdc3464ad0cf5c85359293b">resize_image</a> (image, masks=None, new_height=600, new_width=1024, method=tf.image.ResizeMethod.BILINEAR, align_corners=False)</td></tr>
<tr class="separator:a594f3c0e2cdc3464ad0cf5c85359293b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42ac33ac786175636312abd4941aa915"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a42ac33ac786175636312abd4941aa915">subtract_channel_mean</a> (image, means=None)</td></tr>
<tr class="separator:a42ac33ac786175636312abd4941aa915"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84b00d370e579ea07663c48b7c6a0696"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a84b00d370e579ea07663c48b7c6a0696">one_hot_encoding</a> (labels, num_classes=None)</td></tr>
<tr class="separator:a84b00d370e579ea07663c48b7c6a0696"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1129985bff113d599809697210e2628"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aa1129985bff113d599809697210e2628">rgb_to_gray</a> (image)</td></tr>
<tr class="separator:aa1129985bff113d599809697210e2628"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a28ed9f2cfed49a54b767a131fb3e7cde"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a28ed9f2cfed49a54b767a131fb3e7cde">random_self_concat_image</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, concat_vertical_probability=0.1, concat_horizontal_probability=0.1, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a28ed9f2cfed49a54b767a131fb3e7cde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a91a2c48d4f04433025c2994248222729"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729">ssd_random_crop</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, min_object_covered=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), aspect_ratio_range=((0.5, 2.0),) *7, area_range=((0.1, 1.0),) *7, overlap_thresh=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), clip_boxes=(True,) *7, random_coef=(0.15,) *7, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a91a2c48d4f04433025c2994248222729"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6141ebcaa14a24e9903a50821b45b576"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576">ssd_random_crop_pad</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, min_object_covered=(0.1, 0.3, 0.5, 0.7, 0.9, 1.0), aspect_ratio_range=((0.5, 2.0),) *6, area_range=((0.1, 1.0),) *6, overlap_thresh=(0.1, 0.3, 0.5, 0.7, 0.9, 1.0), clip_boxes=(True,) *6, random_coef=(0.15,) *6, min_padded_size_ratio=((1.0, 1.0),) *6, max_padded_size_ratio=((2.0, 2.0),) *6, pad_color=(None,) *6, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a6141ebcaa14a24e9903a50821b45b576"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae771c28299fc187bd974238ae577fb02"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02">ssd_random_crop_fixed_aspect_ratio</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, min_object_covered=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), aspect_ratio=1.0, area_range=((0.1, 1.0),) *7, overlap_thresh=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), clip_boxes=(True,) *7, random_coef=(0.15,) *7, seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ae771c28299fc187bd974238ae577fb02"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac4cb1ebd49aea7a953dff66c0b64cc19"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19">ssd_random_crop_pad_fixed_aspect_ratio</a> (image, boxes, labels, label_weights, label_confidences=None, multiclass_scores=None, masks=None, keypoints=None, min_object_covered=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), aspect_ratio=1.0, aspect_ratio_range=((0.5, 2.0),) *7, area_range=((0.1, 1.0),) *7, overlap_thresh=(0.0, 0.1, 0.3, 0.5, 0.7, 0.9, 1.0), clip_boxes=(True,) *7, random_coef=(0.15,) *7, min_padded_size_ratio=(1.0, 1.0), max_padded_size_ratio=(2.0, 2.0), seed=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:ac4cb1ebd49aea7a953dff66c0b64cc19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7799bfed7d66c1a99cc9da524ec482b1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a7799bfed7d66c1a99cc9da524ec482b1">convert_class_logits_to_softmax</a> (multiclass_scores, temperature=1.0)</td></tr>
<tr class="separator:a7799bfed7d66c1a99cc9da524ec482b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af58a25a2d72d84c921a575c3900c74d0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#af58a25a2d72d84c921a575c3900c74d0">get_default_func_arg_map</a> (include_label_weights=True, include_label_confidences=False, include_multiclass_scores=False, include_instance_masks=False, include_keypoints=False)</td></tr>
<tr class="separator:af58a25a2d72d84c921a575c3900c74d0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7806fdbc8bcd478d285ebb8873c8321c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a7806fdbc8bcd478d285ebb8873c8321c">preprocess</a> (tensor_dict, preprocess_options, func_arg_map=None, preprocess_vars_cache=None)</td></tr>
<tr class="separator:a7806fdbc8bcd478d285ebb8873c8321c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Preprocess images and bounding boxes for detection.

We perform two sets of operations in preprocessing stage:
(a) operations that are applied to both training and testing data,
(b) operations that are applied only to training data for the purpose of
    data augmentation.

A preprocessing function receives a set of inputs,
e.g. an image and bounding boxes,
performs an operation on them, and returns them.
Some examples are: randomly cropping the image, randomly mirroring the image,
                   randomly changing the brightness, contrast, hue and
                   randomly jittering the bounding boxes.

The preprocess function receives a tensor_dict which is a dictionary that maps
different field names to their tensors. For example,
tensor_dict[fields.InputDataFields.image] holds the image tensor.
The image is a rank 4 tensor: [1, height, width, channels] with
dtype=tf.float32. The groundtruth_boxes is a rank 2 tensor: [N, 4] where
in each row there is a box with [ymin xmin ymax xmax].
Boxes are in normalized coordinates meaning
their coordinate values range in [0, 1]

To preprocess multiple images with the same operations in cases where
nondeterministic operations are used, a preprocessor_cache.PreprocessorCache
object can be passed into the preprocess function or individual operations.
All nondeterministic operations except random_jitter_boxes support caching.
E.g.
Let tensor_dict{1,2,3,4,5} be copies of the same inputs.
Let preprocess_options contain nondeterministic operation(s) excluding
random_jitter_boxes.

cache1 = preprocessor_cache.PreprocessorCache()
cache2 = preprocessor_cache.PreprocessorCache()
a = preprocess(tensor_dict1, preprocess_options, preprocess_vars_cache=cache1)
b = preprocess(tensor_dict2, preprocess_options, preprocess_vars_cache=cache1)
c = preprocess(tensor_dict3, preprocess_options, preprocess_vars_cache=cache2)
d = preprocess(tensor_dict4, preprocess_options, preprocess_vars_cache=cache2)
e = preprocess(tensor_dict5, preprocess_options)

Then correspondings tensors of object pairs (a,b) and (c,d)
are guaranteed to be equal element-wise, but the equality of any other object
pair cannot be determined.

Important Note: In tensor_dict, images is a rank 4 tensor, but preprocessing
functions receive a rank 3 tensor for processing the image. Thus, inside the
preprocess function we squeeze the image to become a rank 3 tensor and then
we pass it to the functions. At the end of the preprocess we expand the image
back to rank 4.
</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a72948ea20f73ededa0777968bb83c27f" name="a72948ea20f73ededa0777968bb83c27f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72948ea20f73ededa0777968bb83c27f">&#9670;&#160;</a></span>_apply_with_random_selector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._apply_with_random_selector </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_cases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Computes func(x, sel), with sel sampled from [0...num_cases-1].

If both preprocess_vars_cache AND key are the same between two calls, sel will
be the same value in both calls.

Args:
  x: input Tensor.
  func: Python function to apply.
  num_cases: Python int32, number of cases to sample sel from.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.
  key: variable identifier for preprocess_vars_cache.

Returns:
  The result of func(x, sel), where func receives the value of the
  selector as a python integer, but sel is sampled dynamically.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00089">89</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   93</span>                                key=<span class="stringliteral">&#39;&#39;</span>):</div>
<div class="line"><span class="lineno">   94</span>  <span class="stringliteral">&quot;&quot;&quot;Computes func(x, sel), with sel sampled from [0...num_cases-1].</span></div>
<div class="line"><span class="lineno">   95</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">   96</span><span class="stringliteral">  If both preprocess_vars_cache AND key are the same between two calls, sel will</span></div>
<div class="line"><span class="lineno">   97</span><span class="stringliteral">  be the same value </span><span class="keywordflow">in</span> both calls.</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  Args:</div>
<div class="line"><span class="lineno">  100</span>    x: input Tensor.</div>
<div class="line"><span class="lineno">  101</span>    func: Python function to apply.</div>
<div class="line"><span class="lineno">  102</span>    num_cases: Python int32, number of cases to sample sel <span class="keyword">from</span>.</div>
<div class="line"><span class="lineno">  103</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  104</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  105</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  106</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  107</span>    key: variable identifier <span class="keywordflow">for</span> preprocess_vars_cache.</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  Returns:</div>
<div class="line"><span class="lineno">  110</span>    The result of func(x, sel), where func receives the value of the</div>
<div class="line"><span class="lineno">  111</span>    selector <span class="keyword">as</span> a python integer, but sel <span class="keywordflow">is</span> sampled dynamically.</div>
<div class="line"><span class="lineno">  112</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  113</span><span class="stringliteral">  generator_func = functools.partial(</span></div>
<div class="line"><span class="lineno">  114</span><span class="stringliteral">      tf.random_uniform, [], maxval=num_cases, dtype=tf.int32)</span></div>
<div class="line"><span class="lineno">  115</span><span class="stringliteral">  rand_sel = _get_or_create_preprocess_rand_vars(</span></div>
<div class="line"><span class="lineno">  116</span><span class="stringliteral">      generator_func, preprocessor_cache.PreprocessorCache.SELECTOR,</span></div>
<div class="line"><span class="lineno">  117</span><span class="stringliteral">      preprocess_vars_cache, key)</span></div>
<div class="line"><span class="lineno">  118</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  119</span><span class="stringliteral">  </span><span class="comment"># Pass the real x only to one of the func calls.</span></div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">return</span> control_flow_ops.merge([func(</div>
<div class="line"><span class="lineno">  121</span>      control_flow_ops.switch(x, tf.equal(rand_sel, case))[1], case)</div>
<div class="line"><span class="lineno">  122</span>                                 <span class="keywordflow">for</span> case <span class="keywordflow">in</span> range(num_cases)])[0]</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,224,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="272,5,513,45"/>
<area shape="poly" title=" " alt="" coords="224,23,258,23,258,28,224,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a72948ea20f73ededa0777968bb83c27f_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a06cc1c1f5cce3566bc6f1a4a865b613e" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a190734dcb563069386fbf10f1cdb044c" name="a190734dcb563069386fbf10f1cdb044c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a190734dcb563069386fbf10f1cdb044c">&#9670;&#160;</a></span>_apply_with_random_selector_tuples()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._apply_with_random_selector_tuples </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_cases</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Computes func(x, sel), with sel sampled from [0...num_cases-1].

If both preprocess_vars_cache AND key are the same between two calls, sel will
be the same value in both calls.

Args:
  x: A tuple of input tensors.
  func: Python function to apply.
  num_cases: Python int32, number of cases to sample sel from.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.
  key: variable identifier for preprocess_vars_cache.

Returns:
  The result of func(x, sel), where func receives the value of the
  selector as a python integer, but sel is sampled dynamically.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00125">125</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>                                       key=<span class="stringliteral">&#39;&#39;</span>):</div>
<div class="line"><span class="lineno">  130</span>  <span class="stringliteral">&quot;&quot;&quot;Computes func(x, sel), with sel sampled from [0...num_cases-1].</span></div>
<div class="line"><span class="lineno">  131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  132</span><span class="stringliteral">  If both preprocess_vars_cache AND key are the same between two calls, sel will</span></div>
<div class="line"><span class="lineno">  133</span><span class="stringliteral">  be the same value </span><span class="keywordflow">in</span> both calls.</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  Args:</div>
<div class="line"><span class="lineno">  136</span>    x: A tuple of input tensors.</div>
<div class="line"><span class="lineno">  137</span>    func: Python function to apply.</div>
<div class="line"><span class="lineno">  138</span>    num_cases: Python int32, number of cases to sample sel <span class="keyword">from</span>.</div>
<div class="line"><span class="lineno">  139</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  140</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  141</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  142</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  143</span>    key: variable identifier <span class="keywordflow">for</span> preprocess_vars_cache.</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  Returns:</div>
<div class="line"><span class="lineno">  146</span>    The result of func(x, sel), where func receives the value of the</div>
<div class="line"><span class="lineno">  147</span>    selector <span class="keyword">as</span> a python integer, but sel <span class="keywordflow">is</span> sampled dynamically.</div>
<div class="line"><span class="lineno">  148</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  149</span><span class="stringliteral">  num_inputs = len(x)</span></div>
<div class="line"><span class="lineno">  150</span><span class="stringliteral">  generator_func = functools.partial(</span></div>
<div class="line"><span class="lineno">  151</span><span class="stringliteral">      tf.random_uniform, [], maxval=num_cases, dtype=tf.int32)</span></div>
<div class="line"><span class="lineno">  152</span><span class="stringliteral">  rand_sel = _get_or_create_preprocess_rand_vars(</span></div>
<div class="line"><span class="lineno">  153</span><span class="stringliteral">      generator_func, preprocessor_cache.PreprocessorCache.SELECTOR_TUPLES,</span></div>
<div class="line"><span class="lineno">  154</span><span class="stringliteral">      preprocess_vars_cache, key)</span></div>
<div class="line"><span class="lineno">  155</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  156</span><span class="stringliteral">  </span><span class="comment"># Pass the real x only to one of the func calls.</span></div>
<div class="line"><span class="lineno">  157</span>  tuples = [list() <span class="keywordflow">for</span> t <span class="keywordflow">in</span> x]</div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordflow">for</span> case <span class="keywordflow">in</span> range(num_cases):</div>
<div class="line"><span class="lineno">  159</span>    new_x = [control_flow_ops.switch(t, tf.equal(rand_sel, case))[1] <span class="keywordflow">for</span> t <span class="keywordflow">in</span> x]</div>
<div class="line"><span class="lineno">  160</span>    output = func(tuple(new_x), case)</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">for</span> j <span class="keywordflow">in</span> range(num_inputs):</div>
<div class="line"><span class="lineno">  162</span>      tuples[j].append(output[j])</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(num_inputs):</div>
<div class="line"><span class="lineno">  165</span>    tuples[i] = control_flow_ops.merge(tuples[i])[0]</div>
<div class="line"><span class="lineno">  166</span>  <span class="keywordflow">return</span> tuple(tuples)</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,240,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="288,5,529,45"/>
<area shape="poly" title=" " alt="" coords="240,23,274,23,274,28,240,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a190734dcb563069386fbf10f1cdb044c_icgraph">
<area shape="rect" title=" " alt="" coords="584,69,819,109"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="297,37,536,77"/>
<area shape="poly" title=" " alt="" coords="570,77,536,73,537,68,571,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="297,101,536,141"/>
<area shape="poly" title=" " alt="" coords="571,107,537,111,536,105,570,101"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="8,5,247,45"/>
<area shape="poly" title=" " alt="" coords="283,45,247,41,247,36,284,40"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,69,249,109"/>
<area shape="poly" title=" " alt="" coords="284,75,250,79,249,73,283,69"/>
</map>
</div>

</div>
</div>
<a id="a0f844301a276e66ee5b6443f5ea4594b" name="a0f844301a276e66ee5b6443f5ea4594b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0f844301a276e66ee5b6443f5ea4594b">&#9670;&#160;</a></span>_augment_only_rgb_channels()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._augment_only_rgb_channels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>augment_function</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Augments only the RGB slice of an image with additional channels.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00945">945</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  945</span><span class="keyword">def </span>_augment_only_rgb_channels(image, augment_function):</div>
<div class="line"><span class="lineno">  946</span>  <span class="stringliteral">&quot;&quot;&quot;Augments only the RGB slice of an image with additional channels.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  947</span>  rgb_slice = image[:, :, :3]</div>
<div class="line"><span class="lineno">  948</span>  augmented_rgb_slice = augment_function(rgb_slice)</div>
<div class="line"><span class="lineno">  949</span>  image = tf.concat([augmented_rgb_slice, image[:, :, 3:]], -1)</div>
<div class="line"><span class="lineno">  950</span>  <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0f844301a276e66ee5b6443f5ea4594b_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0f844301a276e66ee5b6443f5ea4594b_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0f844301a276e66ee5b6443f5ea4594b_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0f844301a276e66ee5b6443f5ea4594b_icgraph">
<area shape="rect" title=" " alt="" coords="624,133,843,173"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1a79d5114c3c558ffb325b491e93921a" title=" " alt="" coords="315,5,576,45"/>
<area shape="poly" title=" " alt="" coords="693,128,638,92,575,60,541,48,543,43,577,55,641,88,696,123"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a299a97f4d9fc15b96cd138d910b0d4d7" title=" " alt="" coords="315,69,576,109"/>
<area shape="poly" title=" " alt="" coords="629,133,535,112,536,107,630,128"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1840c66a7b36bfefbcf7e2832cdbd881" title=" " alt="" coords="315,133,576,173"/>
<area shape="poly" title=" " alt="" coords="610,156,576,156,576,151,610,151"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7fcba6b229393eb466d7163c8b27e36" title=" " alt="" coords="315,197,576,237"/>
<area shape="poly" title=" " alt="" coords="630,179,536,200,535,195,629,174"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a643bc2872b76f353d6f342b56070c112" title=" " alt="" coords="315,261,576,301"/>
<area shape="poly" title=" " alt="" coords="696,183,641,219,577,252,543,264,541,259,575,247,638,214,693,179"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="5,101,267,141"/>
<area shape="poly" title=" " alt="" coords="346,51,315,60,189,104,188,99,314,55,344,46"/>
<area shape="poly" title=" " alt="" coords="301,107,267,110,267,105,301,102"/>
<area shape="poly" title=" " alt="" coords="301,141,267,138,267,132,301,136"/>
<area shape="poly" title=" " alt="" coords="344,196,314,188,188,144,189,139,315,183,346,191"/>
</map>
</div>

</div>
</div>
<a id="a9de9f58390f2e1d905e660c6f3f8b3da" name="a9de9f58390f2e1d905e660c6f3f8b3da"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9de9f58390f2e1d905e660c6f3f8b3da">&#9670;&#160;</a></span>_flip_boxes_left_right()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._flip_boxes_left_right </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Left-right flip the boxes.

Args:
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].

Returns:
  Flipped boxes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00461">461</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  461</span><span class="keyword">def </span>_flip_boxes_left_right(boxes):</div>
<div class="line"><span class="lineno">  462</span>  <span class="stringliteral">&quot;&quot;&quot;Left-right flip the boxes.</span></div>
<div class="line"><span class="lineno">  463</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  464</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  465</span><span class="stringliteral">    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</span></div>
<div class="line"><span class="lineno">  466</span><span class="stringliteral">           Boxes are </span><span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  467</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  468</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  Returns:</div>
<div class="line"><span class="lineno">  471</span>    Flipped boxes.</div>
<div class="line"><span class="lineno">  472</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  473</span><span class="stringliteral">  ymin, xmin, ymax, xmax = tf.split(value=boxes, num_or_size_splits=4, axis=1)</span></div>
<div class="line"><span class="lineno">  474</span><span class="stringliteral">  flipped_xmin = tf.subtract(1.0, xmax)</span></div>
<div class="line"><span class="lineno">  475</span><span class="stringliteral">  flipped_xmax = tf.subtract(1.0, xmin)</span></div>
<div class="line"><span class="lineno">  476</span><span class="stringliteral">  flipped_boxes = tf.concat([ymin, flipped_xmin, ymax, flipped_xmax], 1)</span></div>
<div class="line"><span class="lineno">  477</span><span class="stringliteral">  </span><span class="keywordflow">return</span> flipped_boxes</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9de9f58390f2e1d905e660c6f3f8b3da_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9de9f58390f2e1d905e660c6f3f8b3da_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9de9f58390f2e1d905e660c6f3f8b3da_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9de9f58390f2e1d905e660c6f3f8b3da_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9ad2674a88326abe9a620d33dc6dbaa7" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="ab7aadde1361f08d837700bfdc9e01b13" name="ab7aadde1361f08d837700bfdc9e01b13"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7aadde1361f08d837700bfdc9e01b13">&#9670;&#160;</a></span>_flip_boxes_up_down()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._flip_boxes_up_down </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Up-down flip the boxes.

Args:
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].

Returns:
  Flipped boxes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00480">480</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  480</span><span class="keyword">def </span>_flip_boxes_up_down(boxes):</div>
<div class="line"><span class="lineno">  481</span>  <span class="stringliteral">&quot;&quot;&quot;Up-down flip the boxes.</span></div>
<div class="line"><span class="lineno">  482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  483</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  484</span><span class="stringliteral">    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</span></div>
<div class="line"><span class="lineno">  485</span><span class="stringliteral">           Boxes are </span><span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  486</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  487</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>  Returns:</div>
<div class="line"><span class="lineno">  490</span>    Flipped boxes.</div>
<div class="line"><span class="lineno">  491</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  492</span><span class="stringliteral">  ymin, xmin, ymax, xmax = tf.split(value=boxes, num_or_size_splits=4, axis=1)</span></div>
<div class="line"><span class="lineno">  493</span><span class="stringliteral">  flipped_ymin = tf.subtract(1.0, ymax)</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral">  flipped_ymax = tf.subtract(1.0, ymin)</span></div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">  flipped_boxes = tf.concat([flipped_ymin, xmin, flipped_ymax, xmax], 1)</span></div>
<div class="line"><span class="lineno">  496</span><span class="stringliteral">  </span><span class="keywordflow">return</span> flipped_boxes</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7aadde1361f08d837700bfdc9e01b13_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7aadde1361f08d837700bfdc9e01b13_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7aadde1361f08d837700bfdc9e01b13_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7aadde1361f08d837700bfdc9e01b13_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae3b102c4ba64515724d250cb08523bf3" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="aab2ac5f063f9892ff6d043f70b5026e9" name="aab2ac5f063f9892ff6d043f70b5026e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab2ac5f063f9892ff6d043f70b5026e9">&#9670;&#160;</a></span>_flip_masks_left_right()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._flip_masks_left_right </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Left-right flip masks.

Args:
  masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.

Returns:
  flipped masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00521">521</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  521</span><span class="keyword">def </span>_flip_masks_left_right(masks):</div>
<div class="line"><span class="lineno">  522</span>  <span class="stringliteral">&quot;&quot;&quot;Left-right flip masks.</span></div>
<div class="line"><span class="lineno">  523</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  524</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  525</span><span class="stringliteral">    masks: rank 3 float32 tensor </span><span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  526</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>  Returns:</div>
<div class="line"><span class="lineno">  529</span>    flipped masks: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  530</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  531</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">  </span><span class="keywordflow">return</span> masks[:, :, ::-1]</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_aab2ac5f063f9892ff6d043f70b5026e9_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aab2ac5f063f9892ff6d043f70b5026e9_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aab2ac5f063f9892ff6d043f70b5026e9_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aab2ac5f063f9892ff6d043f70b5026e9_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9ad2674a88326abe9a620d33dc6dbaa7" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a916daef65c5c27ef1c9a3efd2d89e80a" name="a916daef65c5c27ef1c9a3efd2d89e80a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a916daef65c5c27ef1c9a3efd2d89e80a">&#9670;&#160;</a></span>_flip_masks_up_down()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._flip_masks_up_down </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Up-down flip masks.

Args:
  masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.

Returns:
  flipped masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00535">535</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  535</span><span class="keyword">def </span>_flip_masks_up_down(masks):</div>
<div class="line"><span class="lineno">  536</span>  <span class="stringliteral">&quot;&quot;&quot;Up-down flip masks.</span></div>
<div class="line"><span class="lineno">  537</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  538</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  539</span><span class="stringliteral">    masks: rank 3 float32 tensor </span><span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  540</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  541</span> </div>
<div class="line"><span class="lineno">  542</span>  Returns:</div>
<div class="line"><span class="lineno">  543</span>    flipped masks: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  544</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  545</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">  </span><span class="keywordflow">return</span> masks[:, ::-1, :]</div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a916daef65c5c27ef1c9a3efd2d89e80a_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a916daef65c5c27ef1c9a3efd2d89e80a_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a916daef65c5c27ef1c9a3efd2d89e80a_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a916daef65c5c27ef1c9a3efd2d89e80a_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae3b102c4ba64515724d250cb08523bf3" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a6a294fdb039f62a6de9b9be007481357" name="a6a294fdb039f62a6de9b9be007481357"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6a294fdb039f62a6de9b9be007481357">&#9670;&#160;</a></span>_get_image_info()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._get_image_info </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns the height, width and number of channels in the image.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02470">2470</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2470</span><span class="keyword">def </span>_get_image_info(image):</div>
<div class="line"><span class="lineno"> 2471</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the height, width and number of channels in the image.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2472</span>  image_height = tf.shape(image)[0]</div>
<div class="line"><span class="lineno"> 2473</span>  image_width = tf.shape(image)[1]</div>
<div class="line"><span class="lineno"> 2474</span>  num_channels = tf.shape(image)[2]</div>
<div class="line"><span class="lineno"> 2475</span>  <span class="keywordflow">return</span> (image_height, image_width, num_channels)</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span> </div>
<div class="line"><span class="lineno"> 2478</span><span class="comment"># TODO(alirezafathi): Make sure the static shapes are preserved.</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6a294fdb039f62a6de9b9be007481357_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6a294fdb039f62a6de9b9be007481357_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6a294fdb039f62a6de9b9be007481357_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6a294fdb039f62a6de9b9be007481357_icgraph">
<area shape="rect" title=" " alt="" coords="307,37,525,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0ad8ce6e9aabff130be4839677d2ece3" title=" " alt="" coords="5,5,259,45"/>
<area shape="poly" title=" " alt="" coords="292,46,259,42,259,37,293,41"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae31da8a2456c9fd96e951ec2564a04ef" title=" " alt="" coords="5,69,259,109"/>
<area shape="poly" title=" " alt="" coords="293,74,259,78,259,72,292,69"/>
</map>
</div>

</div>
</div>
<a id="a8fea0b9f060eea936fac7e5dd5102df7" name="a8fea0b9f060eea936fac7e5dd5102df7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8fea0b9f060eea936fac7e5dd5102df7">&#9670;&#160;</a></span>_get_or_create_preprocess_rand_vars()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._get_or_create_preprocess_rand_vars </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>generator_func</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>function_id</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>key</em> = <code>''</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns a tensor stored in preprocess_vars_cache or using generator_func.

If the tensor was previously generated and appears in the PreprocessorCache,
the previously generated tensor will be returned. Otherwise, a new tensor
is generated using generator_func and stored in the cache.

Args:
  generator_func: A 0-argument function that generates a tensor.
  function_id: identifier for the preprocessing function used.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.
  key: identifier for the variable stored.
Returns:
  The generated tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00169">169</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  172</span>                                        key=<span class="stringliteral">&#39;&#39;</span>):</div>
<div class="line"><span class="lineno">  173</span>  <span class="stringliteral">&quot;&quot;&quot;Returns a tensor stored in preprocess_vars_cache or using generator_func.</span></div>
<div class="line"><span class="lineno">  174</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  175</span><span class="stringliteral">  If the tensor was previously generated </span><span class="keywordflow">and</span> appears <span class="keywordflow">in</span> the PreprocessorCache,</div>
<div class="line"><span class="lineno">  176</span>  the previously generated tensor will be returned. Otherwise, a new tensor</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">is</span> generated using generator_func <span class="keywordflow">and</span> stored <span class="keywordflow">in</span> the cache.</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  Args:</div>
<div class="line"><span class="lineno">  180</span>    generator_func: A 0-argument function that generates a tensor.</div>
<div class="line"><span class="lineno">  181</span>    function_id: identifier <span class="keywordflow">for</span> the preprocessing function used.</div>
<div class="line"><span class="lineno">  182</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  183</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  184</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  185</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  186</span>    key: identifier <span class="keywordflow">for</span> the variable stored.</div>
<div class="line"><span class="lineno">  187</span>  Returns:</div>
<div class="line"><span class="lineno">  188</span>    The generated tensor.</div>
<div class="line"><span class="lineno">  189</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  190</span><span class="stringliteral">  </span><span class="keywordflow">if</span> preprocess_vars_cache <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  191</span>    var = preprocess_vars_cache.get(function_id, key)</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">if</span> var <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  193</span>      var = generator_func()</div>
<div class="line"><span class="lineno">  194</span>      preprocess_vars_cache.update(function_id, key, var)</div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  196</span>    var = generator_func()</div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordflow">return</span> var</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8fea0b9f060eea936fac7e5dd5102df7_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8fea0b9f060eea936fac7e5dd5102df7_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8fea0b9f060eea936fac7e5dd5102df7_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8fea0b9f060eea936fac7e5dd5102df7_icgraph">
<area shape="rect" title=" " alt="" coords="1225,561,1467,601"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a72948ea20f73ededa0777968bb83c27f" title=" " alt="" coords="937,5,1156,45"/>
<area shape="poly" title=" " alt="" coords="1342,548,1335,451,1326,388,1312,319,1291,249,1262,179,1224,115,1176,59,1155,45,1158,40,1179,55,1228,112,1267,177,1296,247,1317,318,1332,387,1341,451,1347,548"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c" title=" " alt="" coords="620,561,855,601"/>
<area shape="poly" title=" " alt="" coords="1212,584,855,584,855,579,1212,579"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="937,440,1156,480"/>
<area shape="poly" title=" " alt="" coords="1300,556,1242,524,1176,494,1140,483,1142,478,1178,490,1244,520,1302,552"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="607,444,868,484"/>
<area shape="poly" title=" " alt="" coords="1320,552,1295,521,1261,486,1221,454,1176,430,1139,418,1107,411,1050,411,991,420,916,431,820,447,819,441,916,425,990,415,1049,405,1107,406,1140,413,1178,426,1224,450,1265,482,1299,517,1325,548"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1a79d5114c3c558ffb325b491e93921a" title=" " alt="" coords="916,133,1177,173"/>
<area shape="poly" title=" " alt="" coords="1338,548,1324,473,1295,375,1274,324,1247,274,1215,227,1176,187,1159,176,1162,171,1179,183,1219,224,1252,271,1279,322,1300,374,1329,472,1343,547"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a299a97f4d9fc15b96cd138d910b0d4d7" title=" " alt="" coords="916,197,1177,237"/>
<area shape="poly" title=" " alt="" coords="1335,549,1317,485,1286,404,1265,362,1240,321,1210,284,1176,251,1157,240,1160,235,1179,247,1214,280,1244,318,1270,359,1291,402,1322,483,1340,547"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1840c66a7b36bfefbcf7e2832cdbd881" title=" " alt="" coords="916,261,1177,301"/>
<area shape="poly" title=" " alt="" coords="1331,549,1310,497,1277,434,1232,369,1205,340,1176,316,1155,304,1158,299,1179,311,1209,337,1236,366,1281,431,1314,495,1336,547"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7fcba6b229393eb466d7163c8b27e36" title=" " alt="" coords="916,69,1177,109"/>
<area shape="poly" title=" " alt="" coords="1340,548,1330,462,1319,406,1304,347,1282,286,1254,226,1219,171,1176,123,1159,112,1163,107,1179,119,1223,168,1259,224,1287,284,1309,345,1324,405,1335,461,1345,547"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a840b20876c98b893ebbca8c363ecb020" title=" " alt="" coords="916,504,1177,544"/>
<area shape="poly" title=" " alt="" coords="1227,561,1151,547,1152,541,1228,556"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aed03769aeaaf1e8b96f676996f870e8c" title=" " alt="" coords="297,661,559,701"/>
<area shape="poly" title=" " alt="" coords="1325,614,1299,646,1265,680,1224,713,1178,737,1132,753,1084,765,985,778,886,779,789,772,697,758,614,740,485,704,487,699,615,735,698,753,789,767,886,774,985,773,1083,759,1130,748,1176,732,1221,708,1261,676,1295,642,1320,611"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9ad2674a88326abe9a620d33dc6dbaa7" title=" " alt="" coords="916,619,1177,659"/>
<area shape="poly" title=" " alt="" coords="1228,607,1152,621,1151,616,1227,601"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#adc0c8803b353e7a6795ba372e1a1640a" title=" " alt="" coords="916,683,1177,723"/>
<area shape="poly" title=" " alt="" coords="1302,611,1244,643,1178,673,1142,685,1140,680,1176,668,1242,638,1300,606"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc" title=" " alt="" coords="916,325,1177,365"/>
<area shape="poly" title=" " alt="" coords="1324,551,1298,513,1264,468,1223,424,1176,386,1138,368,1141,363,1179,382,1227,420,1268,465,1303,510,1328,548"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab0a1f9342a5127f9b80e0ffdfe94fc59" title=" " alt="" coords="297,776,559,816"/>
<area shape="poly" title=" " alt="" coords="1331,615,1308,657,1274,704,1231,750,1206,769,1178,785,1129,801,1062,812,984,819,898,821,719,818,559,809,559,804,719,813,898,816,984,813,1062,807,1127,796,1176,780,1203,765,1227,746,1270,701,1303,654,1327,613"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8d0c42728a0663d83a70ed01f309c393" title=" " alt="" coords="916,848,1177,888"/>
<area shape="poly" title=" " alt="" coords="1334,615,1311,663,1277,721,1233,781,1207,808,1179,832,1144,850,1142,846,1176,827,1204,804,1229,777,1273,719,1306,661,1329,613"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a643bc2872b76f353d6f342b56070c112" title=" " alt="" coords="916,912,1177,952"/>
<area shape="poly" title=" " alt="" coords="1340,615,1321,677,1289,755,1268,795,1242,834,1213,871,1179,902,1160,914,1157,910,1176,898,1209,867,1238,831,1263,793,1284,752,1316,675,1334,614"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a29eea225a5c9bad4c280532e7e51d401" title=" " alt="" coords="916,976,1177,1016"/>
<area shape="poly" title=" " alt="" coords="1343,616,1328,689,1298,784,1277,834,1250,882,1218,927,1179,966,1162,978,1159,973,1176,962,1214,924,1245,879,1272,831,1293,782,1322,688,1337,615"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a28ed9f2cfed49a54b767a131fb3e7cde" title=" " alt="" coords="916,1040,1177,1080"/>
<area shape="poly" title=" " alt="" coords="1345,615,1334,699,1323,753,1307,811,1286,871,1258,929,1222,983,1179,1030,1162,1042,1159,1037,1176,1026,1218,980,1253,926,1281,869,1302,810,1318,752,1329,698,1340,615"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae3b102c4ba64515724d250cb08523bf3" title=" " alt="" coords="916,1104,1177,1144"/>
<area shape="poly" title=" " alt="" coords="1347,615,1339,710,1330,772,1315,839,1294,908,1265,976,1227,1039,1179,1094,1163,1106,1160,1102,1176,1090,1223,1036,1260,974,1289,906,1310,838,1325,771,1334,710,1342,615"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a06cc1c1f5cce3566bc6f1a4a865b613e" title=" " alt="" coords="607,5,868,45"/>
<area shape="poly" title=" " alt="" coords="924,28,868,28,868,23,924,23"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="309,572,547,612"/>
<area shape="poly" title=" " alt="" coords="606,589,548,591,548,585,606,583"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="8,489,247,529"/>
<area shape="poly" title=" " alt="" coords="606,568,558,563,247,526,247,521,559,557,607,563"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="8,596,247,636"/>
<area shape="poly" title=" " alt="" coords="295,605,247,609,247,604,295,600"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,688,249,728"/>
<area shape="poly" title=" " alt="" coords="363,619,181,690,179,685,361,615"/>
<area shape="poly" title=" " alt="" coords="924,464,868,465,868,460,923,459"/>
<area shape="poly" title=" " alt="" coords="676,492,478,574,476,570,674,487"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="297,444,559,484"/>
<area shape="poly" title=" " alt="" coords="593,467,559,467,559,461,593,461"/>
<area shape="poly" title=" " alt="" coords="284,488,247,494,246,489,283,483"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="607,165,868,205"/>
<area shape="poly" title=" " alt="" coords="903,171,869,174,868,169,902,166"/>
<area shape="poly" title=" " alt="" coords="902,205,868,202,869,196,903,200"/>
<area shape="poly" title=" " alt="" coords="945,260,915,252,789,208,791,203,917,247,947,255"/>
<area shape="poly" title=" " alt="" coords="947,115,917,124,791,168,789,163,915,119,945,110"/>
<area shape="poly" title=" " alt="" coords="322,661,219,639,220,633,323,656"/>
<area shape="poly" title=" " alt="" coords="902,340,833,340,758,345,682,354,607,371,565,386,524,406,459,446,456,442,522,401,563,381,606,365,681,349,757,339,833,335,902,334"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3abbb64d99b25decfe25fec40a92a6b9" title=" " alt="" coords="607,380,868,420"/>
<area shape="poly" title=" " alt="" coords="920,370,852,383,851,377,919,365"/>
<area shape="poly" title=" " alt="" coords="345,775,196,731,198,726,347,770"/>
</map>
</div>

</div>
</div>
<a id="a3338c3143bc5c5a5f5cbf32be983a2f7" name="a3338c3143bc5c5a5f5cbf32be983a2f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3338c3143bc5c5a5f5cbf32be983a2f7">&#9670;&#160;</a></span>_random_integer()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._random_integer </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>minval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Returns a random 0-D tensor between minval and maxval.

Args:
  minval: minimum value of the random tensor.
  maxval: maximum value of the random tensor.
  seed: random seed.

Returns:
  A random 0-D tensor between minval and maxval.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00200">200</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  200</span><span class="keyword">def </span>_random_integer(minval, maxval, seed):</div>
<div class="line"><span class="lineno">  201</span>  <span class="stringliteral">&quot;&quot;&quot;Returns a random 0-D tensor between minval and maxval.</span></div>
<div class="line"><span class="lineno">  202</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  203</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  204</span><span class="stringliteral">    minval: minimum value of the random tensor.</span></div>
<div class="line"><span class="lineno">  205</span><span class="stringliteral">    maxval: maximum value of the random tensor.</span></div>
<div class="line"><span class="lineno">  206</span><span class="stringliteral">    seed: random seed.</span></div>
<div class="line"><span class="lineno">  207</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  208</span><span class="stringliteral">  Returns:</span></div>
<div class="line"><span class="lineno">  209</span><span class="stringliteral">    A random 0-D tensor between minval </span><span class="keywordflow">and</span> maxval.</div>
<div class="line"><span class="lineno">  210</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  211</span><span class="stringliteral">  </span><span class="keywordflow">return</span> tf.random_uniform(</div>
<div class="line"><span class="lineno">  212</span>      [], minval=minval, maxval=maxval, dtype=tf.int32, seed=seed)</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span><span class="comment"># TODO(mttang): This method is needed because the current</span></div>
<div class="line"><span class="lineno">  216</span><span class="comment"># tf.image.rgb_to_grayscale method does not support quantization. Replace with</span></div>
<div class="line"><span class="lineno">  217</span><span class="comment"># tf.image.rgb_to_grayscale after quantization support is added.</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3338c3143bc5c5a5f5cbf32be983a2f7_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3338c3143bc5c5a5f5cbf32be983a2f7_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3338c3143bc5c5a5f5cbf32be983a2f7_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3338c3143bc5c5a5f5cbf32be983a2f7_icgraph">
<area shape="rect" title=" " alt="" coords="911,37,1129,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aed03769aeaaf1e8b96f676996f870e8c" title=" " alt="" coords="601,5,863,45"/>
<area shape="poly" title=" " alt="" coords="897,46,863,43,863,37,897,41"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc" title=" " alt="" coords="601,69,863,109"/>
<area shape="poly" title=" " alt="" coords="897,74,863,77,863,72,897,68"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="303,5,542,45"/>
<area shape="poly" title=" " alt="" coords="587,28,542,28,542,23,587,23"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3abbb64d99b25decfe25fec40a92a6b9" title=" " alt="" coords="292,69,553,109"/>
<area shape="poly" title=" " alt="" coords="587,92,554,92,554,87,587,87"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="292,133,553,173"/>
<area shape="poly" title=" " alt="" coords="622,115,520,136,519,131,620,110"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="5,133,244,173"/>
<area shape="poly" title=" " alt="" coords="278,156,244,156,244,151,278,151"/>
</map>
</div>

</div>
</div>
<a id="a21e6f1c05910c4acb3c33771326514b5" name="a21e6f1c05910c4acb3c33771326514b5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a21e6f1c05910c4acb3c33771326514b5">&#9670;&#160;</a></span>_rgb_to_grayscale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._rgb_to_grayscale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>images</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>name</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Converts one or more images from RGB to Grayscale.

Outputs a tensor of the same `DType` and rank as `images`.  The size of the
last dimension of the output is 1, containing the Grayscale value of the
pixels.

Args:
  images: The RGB tensor to convert. Last dimension must have size 3 and
    should contain RGB values.
  name: A name for the operation (optional).

Returns:
  The converted grayscale image(s).
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00218">218</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  218</span><span class="keyword">def </span>_rgb_to_grayscale(images, name=None):</div>
<div class="line"><span class="lineno">  219</span>  <span class="stringliteral">&quot;&quot;&quot;Converts one or more images from RGB to Grayscale.</span></div>
<div class="line"><span class="lineno">  220</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  221</span><span class="stringliteral">  Outputs a tensor of the same `DType` </span><span class="keywordflow">and</span> rank <span class="keyword">as</span> `images`.  The size of the</div>
<div class="line"><span class="lineno">  222</span>  last dimension of the output <span class="keywordflow">is</span> 1, containing the Grayscale value of the</div>
<div class="line"><span class="lineno">  223</span>  pixels.</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>  Args:</div>
<div class="line"><span class="lineno">  226</span>    images: The RGB tensor to convert. Last dimension must have size 3 <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  227</span>      should contain RGB values.</div>
<div class="line"><span class="lineno">  228</span>    name: A name <span class="keywordflow">for</span> the operation (optional).</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>  Returns:</div>
<div class="line"><span class="lineno">  231</span>    The converted grayscale image(s).</div>
<div class="line"><span class="lineno">  232</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  233</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(name, <span class="stringliteral">&#39;rgb_to_grayscale&#39;</span>, [images]) <span class="keyword">as</span> name:</div>
<div class="line"><span class="lineno">  234</span>    images = tf.convert_to_tensor(images, name=<span class="stringliteral">&#39;images&#39;</span>)</div>
<div class="line"><span class="lineno">  235</span>    <span class="comment"># Remember original dtype to so we can convert back if needed</span></div>
<div class="line"><span class="lineno">  236</span>    orig_dtype = images.dtype</div>
<div class="line"><span class="lineno">  237</span>    flt_image = tf.image.convert_image_dtype(images, tf.float32)</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="comment"># Reference for converting between RGB and grayscale.</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="comment"># https://en.wikipedia.org/wiki/Luma_%28video%29</span></div>
<div class="line"><span class="lineno">  241</span>    rgb_weights = [0.2989, 0.5870, 0.1140]</div>
<div class="line"><span class="lineno">  242</span>    rank_1 = tf.expand_dims(tf.rank(images) - 1, 0)</div>
<div class="line"><span class="lineno">  243</span>    gray_float = tf.reduce_sum(</div>
<div class="line"><span class="lineno">  244</span>        flt_image * rgb_weights, rank_1, keep_dims=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  245</span>    gray_float.set_shape(images.get_shape()[:-1].concatenate([1]))</div>
<div class="line"><span class="lineno">  246</span>    <span class="keywordflow">return</span> tf.image.convert_image_dtype(gray_float, orig_dtype, name=name)</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a21e6f1c05910c4acb3c33771326514b5_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a21e6f1c05910c4acb3c33771326514b5_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a21e6f1c05910c4acb3c33771326514b5_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a21e6f1c05910c4acb3c33771326514b5_icgraph">
<area shape="rect" title=" " alt="" coords="315,37,533,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a643bc2872b76f353d6f342b56070c112" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,46,267,43,267,37,301,41"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aa1129985bff113d599809697210e2628" title=" " alt="" coords="18,69,254,109"/>
<area shape="poly" title=" " alt="" coords="301,74,254,79,254,74,301,68"/>
</map>
</div>

</div>
</div>
<a id="a5ed6539fa8576bc65e30e46a3f030140" name="a5ed6539fa8576bc65e30e46a3f030140"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ed6539fa8576bc65e30e46a3f030140">&#9670;&#160;</a></span>_rot90_boxes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._rot90_boxes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Rotate boxes counter-clockwise by 90 degrees.

Args:
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].

Returns:
  Rotated boxes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00499">499</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  499</span><span class="keyword">def </span>_rot90_boxes(boxes):</div>
<div class="line"><span class="lineno">  500</span>  <span class="stringliteral">&quot;&quot;&quot;Rotate boxes counter-clockwise by 90 degrees.</span></div>
<div class="line"><span class="lineno">  501</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  502</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  503</span><span class="stringliteral">    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</span></div>
<div class="line"><span class="lineno">  504</span><span class="stringliteral">           Boxes are </span><span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  505</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  506</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>  Returns:</div>
<div class="line"><span class="lineno">  509</span>    Rotated boxes.</div>
<div class="line"><span class="lineno">  510</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  511</span><span class="stringliteral">  ymin, xmin, ymax, xmax = tf.split(value=boxes, num_or_size_splits=4, axis=1)</span></div>
<div class="line"><span class="lineno">  512</span><span class="stringliteral">  rotated_ymin = tf.subtract(1.0, xmax)</span></div>
<div class="line"><span class="lineno">  513</span><span class="stringliteral">  rotated_ymax = tf.subtract(1.0, xmin)</span></div>
<div class="line"><span class="lineno">  514</span><span class="stringliteral">  rotated_xmin = ymin</span></div>
<div class="line"><span class="lineno">  515</span><span class="stringliteral">  rotated_xmax = ymax</span></div>
<div class="line"><span class="lineno">  516</span><span class="stringliteral">  rotated_boxes = tf.concat(</span></div>
<div class="line"><span class="lineno">  517</span><span class="stringliteral">      [rotated_ymin, rotated_xmin, rotated_ymax, rotated_xmax], 1)</span></div>
<div class="line"><span class="lineno">  518</span><span class="stringliteral">  </span><span class="keywordflow">return</span> rotated_boxes</div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a5ed6539fa8576bc65e30e46a3f030140_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a5ed6539fa8576bc65e30e46a3f030140_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a5ed6539fa8576bc65e30e46a3f030140_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a5ed6539fa8576bc65e30e46a3f030140_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a29eea225a5c9bad4c280532e7e51d401" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="ad4f95650b0d5024695ff3d9e18284e3c" name="ad4f95650b0d5024695ff3d9e18284e3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4f95650b0d5024695ff3d9e18284e3c">&#9670;&#160;</a></span>_rot90_masks()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._rot90_masks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Rotate masks counter-clockwise by 90 degrees.

Args:
  masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.

Returns:
  rotated masks: rank 3 float32 tensor with shape
    [num_instances, height, width] representing instance masks.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00549">549</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  549</span><span class="keyword">def </span>_rot90_masks(masks):</div>
<div class="line"><span class="lineno">  550</span>  <span class="stringliteral">&quot;&quot;&quot;Rotate masks counter-clockwise by 90 degrees.</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  553</span><span class="stringliteral">    masks: rank 3 float32 tensor </span><span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  554</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  Returns:</div>
<div class="line"><span class="lineno">  557</span>    rotated masks: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  558</span>      [num_instances, height, width] representing instance masks.</div>
<div class="line"><span class="lineno">  559</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  560</span><span class="stringliteral">  masks = tf.transpose(masks, [0, 2, 1])</span></div>
<div class="line"><span class="lineno">  561</span><span class="stringliteral">  </span><span class="keywordflow">return</span> masks[:, ::-1, :]</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad4f95650b0d5024695ff3d9e18284e3c_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad4f95650b0d5024695ff3d9e18284e3c_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad4f95650b0d5024695ff3d9e18284e3c_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad4f95650b0d5024695ff3d9e18284e3c_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,533,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a29eea225a5c9bad4c280532e7e51d401" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="ae7996143b3e46240e14ccb89e89f3fe3" name="ae7996143b3e46240e14ccb89e89f3fe3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7996143b3e46240e14ccb89e89f3fe3">&#9670;&#160;</a></span>_strict_random_crop_image()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor._strict_random_crop_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>(0.75,&#160;1.33)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>(0.1,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Performs random crop.

Note: Keypoint coordinates that are outside the crop will be set to NaN, which
is consistent with the original keypoint encoding for non-existing keypoints.
This function always crops the image and is supposed to be used by
`random_crop_image` function which sometimes returns the image unchanged.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes with shape
         [num_instances, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: (optional) float32 tensor of shape [num_instances]
    representing the confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If label_weights, multiclass_scores, masks, or keypoints is not None, the
  function also returns:
  label_weights: rank 1 float32 tensor with shape [num_instances].
  multiclass_scores: rank 2 float32 tensor with shape
                     [num_instances, num_classes]
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01253">1253</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1266</span>                              preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1267</span>  <span class="stringliteral">&quot;&quot;&quot;Performs random crop.</span></div>
<div class="line"><span class="lineno"> 1268</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1269</span><span class="stringliteral">  Note: Keypoint coordinates that are outside the crop will be set to NaN, which</span></div>
<div class="line"><span class="lineno"> 1270</span><span class="stringliteral">  </span><span class="keywordflow">is</span> consistent <span class="keyword">with</span> the original keypoint encoding <span class="keywordflow">for</span> non-existing keypoints.</div>
<div class="line"><span class="lineno"> 1271</span>  This function always crops the image <span class="keywordflow">and</span> <span class="keywordflow">is</span> supposed to be used by</div>
<div class="line"><span class="lineno"> 1272</span>  `random_crop_image` function which sometimes returns the image unchanged.</div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>  Args:</div>
<div class="line"><span class="lineno"> 1275</span>    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1276</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1277</span>    boxes: rank 2 float32 tensor containing the bounding boxes <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1278</span>           [num_instances, 4].</div>
<div class="line"><span class="lineno"> 1279</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1280</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1281</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1282</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 1283</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 1284</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1285</span>    label_confidences: (optional) float32 tensor of shape [num_instances]</div>
<div class="line"><span class="lineno"> 1286</span>      representing the confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1287</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 1288</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 1289</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 1290</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1291</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 1292</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 1293</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1294</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 1295</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 1296</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 1297</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 1298</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 1299</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 1300</span>                original image.</div>
<div class="line"><span class="lineno"> 1301</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 1302</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 1303</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 1304</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1305</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1306</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1307</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  Returns:</div>
<div class="line"><span class="lineno"> 1310</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1311</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 1312</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 1313</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>    If label_weights, multiclass_scores, masks, <span class="keywordflow">or</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the</div>
<div class="line"><span class="lineno"> 1316</span>    function also returns:</div>
<div class="line"><span class="lineno"> 1317</span>    label_weights: rank 1 float32 tensor <span class="keyword">with</span> shape [num_instances].</div>
<div class="line"><span class="lineno"> 1318</span>    multiclass_scores: rank 2 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1319</span>                       [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 1320</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 1321</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 1322</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1323</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 1324</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1325</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomCropImage&#39;</span>, values=[image, boxes]):</div>
<div class="line"><span class="lineno"> 1326</span>    image_shape = tf.shape(image)</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span>    <span class="comment"># boxes are [N, 4]. Lets first make them [N, 1, 4].</span></div>
<div class="line"><span class="lineno"> 1329</span>    boxes_expanded = tf.expand_dims(</div>
<div class="line"><span class="lineno"> 1330</span>        tf.clip_by_value(</div>
<div class="line"><span class="lineno"> 1331</span>            boxes, clip_value_min=0.0, clip_value_max=1.0), 1)</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>    generator_func = functools.partial(</div>
<div class="line"><span class="lineno"> 1334</span>        tf.image.sample_distorted_bounding_box,</div>
<div class="line"><span class="lineno"> 1335</span>        image_shape,</div>
<div class="line"><span class="lineno"> 1336</span>        bounding_boxes=boxes_expanded,</div>
<div class="line"><span class="lineno"> 1337</span>        min_object_covered=min_object_covered,</div>
<div class="line"><span class="lineno"> 1338</span>        aspect_ratio_range=aspect_ratio_range,</div>
<div class="line"><span class="lineno"> 1339</span>        area_range=area_range,</div>
<div class="line"><span class="lineno"> 1340</span>        max_attempts=100,</div>
<div class="line"><span class="lineno"> 1341</span>        use_image_if_no_bounding_boxes=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>    <span class="comment"># for ssd cropping, each value of min_object_covered has its own</span></div>
<div class="line"><span class="lineno"> 1344</span>    <span class="comment"># cached random variable</span></div>
<div class="line"><span class="lineno"> 1345</span>    sample_distorted_bounding_box = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1346</span>        generator_func,</div>
<div class="line"><span class="lineno"> 1347</span>        preprocessor_cache.PreprocessorCache.STRICT_CROP_IMAGE,</div>
<div class="line"><span class="lineno"> 1348</span>        preprocess_vars_cache, key=min_object_covered)</div>
<div class="line"><span class="lineno"> 1349</span> </div>
<div class="line"><span class="lineno"> 1350</span>    im_box_begin, im_box_size, im_box = sample_distorted_bounding_box</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>    new_image = tf.slice(image, im_box_begin, im_box_size)</div>
<div class="line"><span class="lineno"> 1353</span>    new_image.set_shape([<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, image.get_shape()[2]])</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>    <span class="comment"># [1, 4]</span></div>
<div class="line"><span class="lineno"> 1356</span>    im_box_rank2 = tf.squeeze(im_box, axis=[0])</div>
<div class="line"><span class="lineno"> 1357</span>    <span class="comment"># [4]</span></div>
<div class="line"><span class="lineno"> 1358</span>    im_box_rank1 = tf.squeeze(im_box)</div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>    boxlist = box_list.BoxList(boxes)</div>
<div class="line"><span class="lineno"> 1361</span>    boxlist.add_field(<span class="stringliteral">&#39;labels&#39;</span>, labels)</div>
<div class="line"><span class="lineno"> 1362</span> </div>
<div class="line"><span class="lineno"> 1363</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1364</span>      boxlist.add_field(<span class="stringliteral">&#39;label_weights&#39;</span>, label_weights)</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1367</span>      boxlist.add_field(<span class="stringliteral">&#39;label_confidences&#39;</span>, label_confidences)</div>
<div class="line"><span class="lineno"> 1368</span> </div>
<div class="line"><span class="lineno"> 1369</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1370</span>      boxlist.add_field(<span class="stringliteral">&#39;multiclass_scores&#39;</span>, multiclass_scores)</div>
<div class="line"><span class="lineno"> 1371</span> </div>
<div class="line"><span class="lineno"> 1372</span>    im_boxlist = box_list.BoxList(im_box_rank2)</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>    <span class="comment"># remove boxes that are outside cropped image</span></div>
<div class="line"><span class="lineno"> 1375</span>    boxlist, inside_window_ids = box_list_ops.prune_completely_outside_window(</div>
<div class="line"><span class="lineno"> 1376</span>        boxlist, im_box_rank1)</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>    <span class="comment"># remove boxes that are outside image</span></div>
<div class="line"><span class="lineno"> 1379</span>    overlapping_boxlist, keep_ids = box_list_ops.prune_non_overlapping_boxes(</div>
<div class="line"><span class="lineno"> 1380</span>        boxlist, im_boxlist, overlap_thresh)</div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>    <span class="comment"># change the coordinate of the remaining boxes</span></div>
<div class="line"><span class="lineno"> 1383</span>    new_labels = overlapping_boxlist.get_field(<span class="stringliteral">&#39;labels&#39;</span>)</div>
<div class="line"><span class="lineno"> 1384</span>    new_boxlist = box_list_ops.change_coordinate_frame(overlapping_boxlist,</div>
<div class="line"><span class="lineno"> 1385</span>                                                       im_box_rank1)</div>
<div class="line"><span class="lineno"> 1386</span>    new_boxes = new_boxlist.get()</div>
<div class="line"><span class="lineno"> 1387</span>    <span class="keywordflow">if</span> clip_boxes:</div>
<div class="line"><span class="lineno"> 1388</span>      new_boxes = tf.clip_by_value(</div>
<div class="line"><span class="lineno"> 1389</span>          new_boxes, clip_value_min=0.0, clip_value_max=1.0)</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>    result = [new_image, new_boxes, new_labels]</div>
<div class="line"><span class="lineno"> 1392</span> </div>
<div class="line"><span class="lineno"> 1393</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1394</span>      new_label_weights = overlapping_boxlist.get_field(<span class="stringliteral">&#39;label_weights&#39;</span>)</div>
<div class="line"><span class="lineno"> 1395</span>      result.append(new_label_weights)</div>
<div class="line"><span class="lineno"> 1396</span> </div>
<div class="line"><span class="lineno"> 1397</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1398</span>      new_label_confidences = overlapping_boxlist.get_field(<span class="stringliteral">&#39;label_confidences&#39;</span>)</div>
<div class="line"><span class="lineno"> 1399</span>      result.append(new_label_confidences)</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1402</span>      new_multiclass_scores = overlapping_boxlist.get_field(<span class="stringliteral">&#39;multiclass_scores&#39;</span>)</div>
<div class="line"><span class="lineno"> 1403</span>      result.append(new_multiclass_scores)</div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1406</span>      masks_of_boxes_inside_window = tf.gather(masks, inside_window_ids)</div>
<div class="line"><span class="lineno"> 1407</span>      masks_of_boxes_completely_inside_window = tf.gather(</div>
<div class="line"><span class="lineno"> 1408</span>          masks_of_boxes_inside_window, keep_ids)</div>
<div class="line"><span class="lineno"> 1409</span>      masks_box_begin = [0, im_box_begin[0], im_box_begin[1]]</div>
<div class="line"><span class="lineno"> 1410</span>      masks_box_size = [-1, im_box_size[0], im_box_size[1]]</div>
<div class="line"><span class="lineno"> 1411</span>      new_masks = tf.slice(</div>
<div class="line"><span class="lineno"> 1412</span>          masks_of_boxes_completely_inside_window,</div>
<div class="line"><span class="lineno"> 1413</span>          masks_box_begin, masks_box_size)</div>
<div class="line"><span class="lineno"> 1414</span>      result.append(new_masks)</div>
<div class="line"><span class="lineno"> 1415</span> </div>
<div class="line"><span class="lineno"> 1416</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1417</span>      keypoints_of_boxes_inside_window = tf.gather(keypoints, inside_window_ids)</div>
<div class="line"><span class="lineno"> 1418</span>      keypoints_of_boxes_completely_inside_window = tf.gather(</div>
<div class="line"><span class="lineno"> 1419</span>          keypoints_of_boxes_inside_window, keep_ids)</div>
<div class="line"><span class="lineno"> 1420</span>      new_keypoints = keypoint_ops.change_coordinate_frame(</div>
<div class="line"><span class="lineno"> 1421</span>          keypoints_of_boxes_completely_inside_window, im_box_rank1)</div>
<div class="line"><span class="lineno"> 1422</span>      <span class="keywordflow">if</span> clip_boxes:</div>
<div class="line"><span class="lineno"> 1423</span>        new_keypoints = keypoint_ops.prune_outside_window(new_keypoints,</div>
<div class="line"><span class="lineno"> 1424</span>                                                          [0.0, 0.0, 1.0, 1.0])</div>
<div class="line"><span class="lineno"> 1425</span>      result.append(new_keypoints)</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 1428</span> </div>
<div class="line"><span class="lineno"> 1429</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,224,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="272,5,513,45"/>
<area shape="poly" title=" " alt="" coords="224,23,258,23,258,28,224,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae7996143b3e46240e14ccb89e89f3fe3_icgraph">
<area shape="rect" title=" " alt="" coords="916,37,1135,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="607,37,868,77"/>
<area shape="poly" title=" " alt="" coords="902,60,868,60,868,55,902,55"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="297,5,559,45"/>
<area shape="poly" title=" " alt="" coords="593,45,559,42,559,36,593,40"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="309,69,547,109"/>
<area shape="poly" title=" " alt="" coords="593,75,548,80,547,74,593,70"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="8,5,247,45"/>
<area shape="poly" title=" " alt="" coords="284,28,247,28,247,23,284,23"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="8,69,247,109"/>
<area shape="poly" title=" " alt="" coords="295,92,247,92,247,87,295,87"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,133,249,173"/>
<area shape="poly" title=" " alt="" coords="321,115,222,136,221,131,320,110"/>
</map>
</div>

</div>
</div>
<a id="a881d3a421a6d182837d12f713e87281f" name="a881d3a421a6d182837d12f713e87281f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a881d3a421a6d182837d12f713e87281f">&#9670;&#160;</a></span>autoaugment_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.autoaugment_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>policy_name</em> = <code>'v0'</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Apply an autoaugment policy to the image and boxes.


Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  boxes: rank 2 float32 tensor containing the bounding boxes with shape
         [num_instances, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  policy_name: The name of the AutoAugment policy to use. The available
    options are `v0`, `v1`, `v2`, `v3` and `test`. `v0` is the policy used for
    all of the results in the paper and was found to achieve the best results
    on the COCO dataset. `v1`, `v2` and `v3` are additional good policies
    found on the COCO dataset that have slight variation in what operations
    were used during the search procedure along with how many operations are
    applied in parallel to a single image (2 vs 3).


Returns:
  image: the augmented image.
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form. boxes will have been augmented along with image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02288">2288</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2288</span><span class="keyword">def </span>autoaugment_image(image, boxes, policy_name=&#39;v0&#39;):</div>
<div class="line"><span class="lineno"> 2289</span>  <span class="stringliteral">&quot;&quot;&quot;Apply an autoaugment policy to the image and boxes.</span></div>
<div class="line"><span class="lineno"> 2290</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2291</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2292</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2293</span><span class="stringliteral">    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 2294</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 2295</span>    boxes: rank 2 float32 tensor containing the bounding boxes <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2296</span>           [num_instances, 4].</div>
<div class="line"><span class="lineno"> 2297</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 2298</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 2299</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 2300</span>    policy_name: The name of the AutoAugment policy to use. The available</div>
<div class="line"><span class="lineno"> 2301</span>      options are `v0`, `v1`, `v2`, `v3` <span class="keywordflow">and</span> `test`. `v0` <span class="keywordflow">is</span> the policy used <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno"> 2302</span>      all of the results <span class="keywordflow">in</span> the paper <span class="keywordflow">and</span> was found to achieve the best results</div>
<div class="line"><span class="lineno"> 2303</span>      on the COCO dataset. `v1`, `v2` <span class="keywordflow">and</span> `v3` are additional good policies</div>
<div class="line"><span class="lineno"> 2304</span>      found on the COCO dataset that have slight variation <span class="keywordflow">in</span> what operations</div>
<div class="line"><span class="lineno"> 2305</span>      were used during the search procedure along <span class="keyword">with</span> how many operations are</div>
<div class="line"><span class="lineno"> 2306</span>      applied <span class="keywordflow">in</span> parallel to a single image (2 vs 3).</div>
<div class="line"><span class="lineno"> 2307</span> </div>
<div class="line"><span class="lineno"> 2308</span> </div>
<div class="line"><span class="lineno"> 2309</span>  Returns:</div>
<div class="line"><span class="lineno"> 2310</span>    image: the augmented image.</div>
<div class="line"><span class="lineno"> 2311</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 2312</span>           form. boxes will have been augmented along <span class="keyword">with</span> image.</div>
<div class="line"><span class="lineno"> 2313</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2314</span><span class="stringliteral">  </span><span class="keywordflow">return</span> autoaugment_utils.distort_image_with_autoaugment(</div>
<div class="line"><span class="lineno"> 2315</span>      image, boxes, policy_name)</div>
<div class="line"><span class="lineno"> 2316</span> </div>
<div class="line"><span class="lineno"> 2317</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7799bfed7d66c1a99cc9da524ec482b1" name="a7799bfed7d66c1a99cc9da524ec482b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7799bfed7d66c1a99cc9da524ec482b1">&#9670;&#160;</a></span>convert_class_logits_to_softmax()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.convert_class_logits_to_softmax </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>temperature</em> = <code>1.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts multiclass logits to softmax scores after applying temperature.

Args:
  multiclass_scores: float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  temperature: Scale factor to use prior to applying softmax. Larger
    temperatures give more uniform distruibutions after softmax.

Returns:
  multiclass_scores: float32 tensor of shape
    [num_instances, num_classes] with scaling and softmax applied.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l03405">3405</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3405</span><span class="keyword">def </span>convert_class_logits_to_softmax(multiclass_scores, temperature=1.0):</div>
<div class="line"><span class="lineno"> 3406</span>  <span class="stringliteral">&quot;&quot;&quot;Converts multiclass logits to softmax scores after applying temperature.</span></div>
<div class="line"><span class="lineno"> 3407</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3408</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 3409</span><span class="stringliteral">    multiclass_scores: float32 tensor of shape</span></div>
<div class="line"><span class="lineno"> 3410</span><span class="stringliteral">      [num_instances, num_classes] representing the score </span><span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 3411</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 3412</span>    temperature: Scale factor to use prior to applying softmax. Larger</div>
<div class="line"><span class="lineno"> 3413</span>      temperatures give more uniform distruibutions after softmax.</div>
<div class="line"><span class="lineno"> 3414</span> </div>
<div class="line"><span class="lineno"> 3415</span>  Returns:</div>
<div class="line"><span class="lineno"> 3416</span>    multiclass_scores: float32 tensor of shape</div>
<div class="line"><span class="lineno"> 3417</span>      [num_instances, num_classes] <span class="keyword">with</span> scaling <span class="keywordflow">and</span> softmax applied.</div>
<div class="line"><span class="lineno"> 3418</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3419</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3420</span><span class="stringliteral">  </span><span class="comment"># Multiclass scores must be stored as logits. Apply temp and softmax.</span></div>
<div class="line"><span class="lineno"> 3421</span>  multiclass_scores_scaled = tf.divide(</div>
<div class="line"><span class="lineno"> 3422</span>      multiclass_scores, temperature, name=<span class="stringliteral">&#39;scale_logits&#39;</span>)</div>
<div class="line"><span class="lineno"> 3423</span>  multiclass_scores = tf.nn.softmax(multiclass_scores_scaled, name=<span class="stringliteral">&#39;softmax&#39;</span>)</div>
<div class="line"><span class="lineno"> 3424</span> </div>
<div class="line"><span class="lineno"> 3425</span>  <span class="keywordflow">return</span> multiclass_scores</div>
<div class="line"><span class="lineno"> 3426</span> </div>
<div class="line"><span class="lineno"> 3427</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a326551a2f9d710995bf095ba1de2f76e" name="a326551a2f9d710995bf095ba1de2f76e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a326551a2f9d710995bf095ba1de2f76e">&#9670;&#160;</a></span>drop_label_probabilistically()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.drop_label_probabilistically </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>dropped_label</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>drop_probability</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Drops boxes of a certain label with probability drop_probability.

Boxes of the label dropped_label will not appear in the returned tensor.

Args:
  boxes: float32 tensor of shape [num_instance, 4] representing boxes
    location in normalized coordinates.
  labels: rank 1 int32 tensor of shape [num_instance] containing the object
    classes.
  label_weights: float32 tensor of shape [num_instance] representing the
    weight for each box.
  label_confidences: float32 tensor of shape [num_instance] representing the
    confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
    [num_instances, height, width] containing instance masks. The masks are of
    the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
    [num_instances, num_keypoints, 2]. The keypoints are in y-x normalized
    coordinates.
  dropped_label: int32 id of label to drop.
  drop_probability: float32 probability of dropping a label.
  seed: random seed.

Returns:
  retained_boxes: [num_retained_instance, 4]
  retianed_labels: [num_retained_instance]
  retained_label_weights: [num_retained_instance]

  If multiclass_scores, masks, or keypoints are not None, the function also
    returns:

  retained_multiclass_scores: [num_retained_instance, num_classes]
  retained_masks: [num_retained_instance, height, width]
  retained_keypoints: [num_retained_instance, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00355">355</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                 seed=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  365</span>  <span class="stringliteral">&quot;&quot;&quot;Drops boxes of a certain label with probability drop_probability.</span></div>
<div class="line"><span class="lineno">  366</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  367</span><span class="stringliteral">  Boxes of the label dropped_label will </span><span class="keywordflow">not</span> appear <span class="keywordflow">in</span> the returned tensor.</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>  Args:</div>
<div class="line"><span class="lineno">  370</span>    boxes: float32 tensor of shape [num_instance, 4] representing boxes</div>
<div class="line"><span class="lineno">  371</span>      location <span class="keywordflow">in</span> normalized coordinates.</div>
<div class="line"><span class="lineno">  372</span>    labels: rank 1 int32 tensor of shape [num_instance] containing the object</div>
<div class="line"><span class="lineno">  373</span>      classes.</div>
<div class="line"><span class="lineno">  374</span>    label_weights: float32 tensor of shape [num_instance] representing the</div>
<div class="line"><span class="lineno">  375</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno">  376</span>    label_confidences: float32 tensor of shape [num_instance] representing the</div>
<div class="line"><span class="lineno">  377</span>      confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno">  378</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno">  379</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno">  380</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno">  381</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  382</span>      [num_instances, height, width] containing instance masks. The masks are of</div>
<div class="line"><span class="lineno">  383</span>      the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno">  384</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  385</span>      [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x normalized</div>
<div class="line"><span class="lineno">  386</span>      coordinates.</div>
<div class="line"><span class="lineno">  387</span>    dropped_label: int32 id of label to drop.</div>
<div class="line"><span class="lineno">  388</span>    drop_probability: float32 probability of dropping a label.</div>
<div class="line"><span class="lineno">  389</span>    seed: random seed.</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  Returns:</div>
<div class="line"><span class="lineno">  392</span>    retained_boxes: [num_retained_instance, 4]</div>
<div class="line"><span class="lineno">  393</span>    retianed_labels: [num_retained_instance]</div>
<div class="line"><span class="lineno">  394</span>    retained_label_weights: [num_retained_instance]</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span>    If multiclass_scores, masks, <span class="keywordflow">or</span> keypoints are <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also</div>
<div class="line"><span class="lineno">  397</span>      returns:</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>    retained_multiclass_scores: [num_retained_instance, num_classes]</div>
<div class="line"><span class="lineno">  400</span>    retained_masks: [num_retained_instance, height, width]</div>
<div class="line"><span class="lineno">  401</span>    retained_keypoints: [num_retained_instance, num_keypoints, 2]</div>
<div class="line"><span class="lineno">  402</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  403</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;DropLabelProbabilistically&#39;</span>,</div>
<div class="line"><span class="lineno">  404</span>                     values=[boxes, labels]):</div>
<div class="line"><span class="lineno">  405</span>    indices = tf.where(</div>
<div class="line"><span class="lineno">  406</span>        tf.logical_or(</div>
<div class="line"><span class="lineno">  407</span>            tf.random_uniform(tf.shape(labels), seed=seed) &gt; drop_probability,</div>
<div class="line"><span class="lineno">  408</span>            tf.not_equal(labels, dropped_label)))</div>
<div class="line"><span class="lineno">  409</span>    indices = tf.squeeze(indices, axis=1)</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>    retained_boxes = tf.gather(boxes, indices)</div>
<div class="line"><span class="lineno">  412</span>    retained_labels = tf.gather(labels, indices)</div>
<div class="line"><span class="lineno">  413</span>    retained_label_weights = tf.gather(label_weights, indices)</div>
<div class="line"><span class="lineno">  414</span>    result = [retained_boxes, retained_labels, retained_label_weights]</div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  417</span>      retained_label_confidences = tf.gather(label_confidences, indices)</div>
<div class="line"><span class="lineno">  418</span>      result.append(retained_label_confidences)</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  421</span>      retained_multiclass_scores = tf.gather(multiclass_scores, indices)</div>
<div class="line"><span class="lineno">  422</span>      result.append(retained_multiclass_scores)</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  425</span>      retained_masks = tf.gather(masks, indices)</div>
<div class="line"><span class="lineno">  426</span>      result.append(retained_masks)</div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  429</span>      retained_keypoints = tf.gather(keypoints, indices)</div>
<div class="line"><span class="lineno">  430</span>      result.append(retained_keypoints)</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="af58a25a2d72d84c921a575c3900c74d0" name="af58a25a2d72d84c921a575c3900c74d0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af58a25a2d72d84c921a575c3900c74d0">&#9670;&#160;</a></span>get_default_func_arg_map()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.get_default_func_arg_map </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_label_weights</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_label_confidences</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_multiclass_scores</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_instance_masks</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>include_keypoints</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Returns the default mapping from a preprocessor function to its args.

Args:
  include_label_weights: If True, preprocessing functions will modify the
    label weights, too.
  include_label_confidences: If True, preprocessing functions will modify the
    label confidences, too.
  include_multiclass_scores: If True, preprocessing functions will modify the
    multiclass scores, too.
  include_instance_masks: If True, preprocessing functions will modify the
    instance masks, too.
  include_keypoints: If True, preprocessing functions will modify the
    keypoints, too.

Returns:
  A map from preprocessing functions to the arguments they receive.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l03428">3428</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3432</span>                             include_keypoints=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno"> 3433</span>  <span class="stringliteral">&quot;&quot;&quot;Returns the default mapping from a preprocessor function to its args.</span></div>
<div class="line"><span class="lineno"> 3434</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3435</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 3436</span><span class="stringliteral">    include_label_weights: If </span><span class="keyword">True</span>, preprocessing functions will modify the</div>
<div class="line"><span class="lineno"> 3437</span>      label weights, too.</div>
<div class="line"><span class="lineno"> 3438</span>    include_label_confidences: If <span class="keyword">True</span>, preprocessing functions will modify the</div>
<div class="line"><span class="lineno"> 3439</span>      label confidences, too.</div>
<div class="line"><span class="lineno"> 3440</span>    include_multiclass_scores: If <span class="keyword">True</span>, preprocessing functions will modify the</div>
<div class="line"><span class="lineno"> 3441</span>      multiclass scores, too.</div>
<div class="line"><span class="lineno"> 3442</span>    include_instance_masks: If <span class="keyword">True</span>, preprocessing functions will modify the</div>
<div class="line"><span class="lineno"> 3443</span>      instance masks, too.</div>
<div class="line"><span class="lineno"> 3444</span>    include_keypoints: If <span class="keyword">True</span>, preprocessing functions will modify the</div>
<div class="line"><span class="lineno"> 3445</span>      keypoints, too.</div>
<div class="line"><span class="lineno"> 3446</span> </div>
<div class="line"><span class="lineno"> 3447</span>  Returns:</div>
<div class="line"><span class="lineno"> 3448</span>    A map <span class="keyword">from</span> preprocessing functions to the arguments they receive.</div>
<div class="line"><span class="lineno"> 3449</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3450</span><span class="stringliteral">  groundtruth_label_weights = </span><span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3451</span>  <span class="keywordflow">if</span> include_label_weights:</div>
<div class="line"><span class="lineno"> 3452</span>    groundtruth_label_weights = (</div>
<div class="line"><span class="lineno"> 3453</span>        fields.InputDataFields.groundtruth_weights)</div>
<div class="line"><span class="lineno"> 3454</span> </div>
<div class="line"><span class="lineno"> 3455</span>  groundtruth_label_confidences = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3456</span>  <span class="keywordflow">if</span> include_label_confidences:</div>
<div class="line"><span class="lineno"> 3457</span>    groundtruth_label_confidences = (</div>
<div class="line"><span class="lineno"> 3458</span>        fields.InputDataFields.groundtruth_confidences)</div>
<div class="line"><span class="lineno"> 3459</span> </div>
<div class="line"><span class="lineno"> 3460</span>  multiclass_scores = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3461</span>  <span class="keywordflow">if</span> include_multiclass_scores:</div>
<div class="line"><span class="lineno"> 3462</span>    multiclass_scores = (fields.InputDataFields.multiclass_scores)</div>
<div class="line"><span class="lineno"> 3463</span> </div>
<div class="line"><span class="lineno"> 3464</span>  groundtruth_instance_masks = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3465</span>  <span class="keywordflow">if</span> include_instance_masks:</div>
<div class="line"><span class="lineno"> 3466</span>    groundtruth_instance_masks = (</div>
<div class="line"><span class="lineno"> 3467</span>        fields.InputDataFields.groundtruth_instance_masks)</div>
<div class="line"><span class="lineno"> 3468</span> </div>
<div class="line"><span class="lineno"> 3469</span>  groundtruth_keypoints = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3470</span>  <span class="keywordflow">if</span> include_keypoints:</div>
<div class="line"><span class="lineno"> 3471</span>    groundtruth_keypoints = fields.InputDataFields.groundtruth_keypoints</div>
<div class="line"><span class="lineno"> 3472</span> </div>
<div class="line"><span class="lineno"> 3473</span>  prep_func_arg_map = {</div>
<div class="line"><span class="lineno"> 3474</span>      normalize_image: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3475</span>      random_horizontal_flip: (</div>
<div class="line"><span class="lineno"> 3476</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3477</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3478</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3479</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3480</span>      ),</div>
<div class="line"><span class="lineno"> 3481</span>      random_vertical_flip: (</div>
<div class="line"><span class="lineno"> 3482</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3483</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3484</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3485</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3486</span>      ),</div>
<div class="line"><span class="lineno"> 3487</span>      random_rotation90: (</div>
<div class="line"><span class="lineno"> 3488</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3489</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3490</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3491</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3492</span>      ),</div>
<div class="line"><span class="lineno"> 3493</span>      random_pixel_value_scale: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3494</span>      random_image_scale: (</div>
<div class="line"><span class="lineno"> 3495</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3496</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3497</span>      ),</div>
<div class="line"><span class="lineno"> 3498</span>      random_rgb_to_gray: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3499</span>      random_adjust_brightness: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3500</span>      random_adjust_contrast: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3501</span>      random_adjust_hue: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3502</span>      random_adjust_saturation: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3503</span>      random_distort_color: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3504</span>      random_jitter_boxes: (fields.InputDataFields.groundtruth_boxes,),</div>
<div class="line"><span class="lineno"> 3505</span>      random_crop_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3506</span>                          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3507</span>                          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3508</span>                          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3509</span>                          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3510</span>                          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3511</span>                          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3512</span>                          groundtruth_keypoints),</div>
<div class="line"><span class="lineno"> 3513</span>      random_pad_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3514</span>                         fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3515</span>                         groundtruth_keypoints),</div>
<div class="line"><span class="lineno"> 3516</span>      random_absolute_pad_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3517</span>                                  fields.InputDataFields.groundtruth_boxes),</div>
<div class="line"><span class="lineno"> 3518</span>      random_crop_pad_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3519</span>                              fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3520</span>                              fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3521</span>                              groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3522</span>                              groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3523</span>                              multiclass_scores),</div>
<div class="line"><span class="lineno"> 3524</span>      random_crop_to_aspect_ratio: (</div>
<div class="line"><span class="lineno"> 3525</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3526</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3527</span>          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3528</span>          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3529</span>          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3530</span>          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3531</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3532</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3533</span>      ),</div>
<div class="line"><span class="lineno"> 3534</span>      random_pad_to_aspect_ratio: (</div>
<div class="line"><span class="lineno"> 3535</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3536</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3537</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3538</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3539</span>      ),</div>
<div class="line"><span class="lineno"> 3540</span>      random_black_patches: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3541</span>      autoaugment_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3542</span>                          fields.InputDataFields.groundtruth_boxes,),</div>
<div class="line"><span class="lineno"> 3543</span>      retain_boxes_above_threshold: (</div>
<div class="line"><span class="lineno"> 3544</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3545</span>          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3546</span>          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3547</span>          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3548</span>          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3549</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3550</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3551</span>      ),</div>
<div class="line"><span class="lineno"> 3552</span>      drop_label_probabilistically: (</div>
<div class="line"><span class="lineno"> 3553</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3554</span>          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3555</span>          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3556</span>          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3557</span>          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3558</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3559</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3560</span>      ),</div>
<div class="line"><span class="lineno"> 3561</span>      remap_labels: (fields.InputDataFields.groundtruth_classes,),</div>
<div class="line"><span class="lineno"> 3562</span>      image_to_float: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3563</span>      random_resize_method: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3564</span>      resize_to_range: (</div>
<div class="line"><span class="lineno"> 3565</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3566</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3567</span>      ),</div>
<div class="line"><span class="lineno"> 3568</span>      resize_to_min_dimension: (</div>
<div class="line"><span class="lineno"> 3569</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3570</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3571</span>      ),</div>
<div class="line"><span class="lineno"> 3572</span>      scale_boxes_to_pixel_coordinates: (</div>
<div class="line"><span class="lineno"> 3573</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3574</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3575</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3576</span>      ),</div>
<div class="line"><span class="lineno"> 3577</span>      resize_image: (</div>
<div class="line"><span class="lineno"> 3578</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3579</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3580</span>      ),</div>
<div class="line"><span class="lineno"> 3581</span>      subtract_channel_mean: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3582</span>      one_hot_encoding: (fields.InputDataFields.groundtruth_image_classes,),</div>
<div class="line"><span class="lineno"> 3583</span>      rgb_to_gray: (fields.InputDataFields.image,),</div>
<div class="line"><span class="lineno"> 3584</span>      random_self_concat_image: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3585</span>                                 fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3586</span>                                 fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3587</span>                                 groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3588</span>                                 groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3589</span>                                 multiclass_scores),</div>
<div class="line"><span class="lineno"> 3590</span>      ssd_random_crop: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3591</span>                        fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3592</span>                        fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3593</span>                        groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3594</span>                        groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3595</span>                        multiclass_scores,</div>
<div class="line"><span class="lineno"> 3596</span>                        groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3597</span>                        groundtruth_keypoints),</div>
<div class="line"><span class="lineno"> 3598</span>      ssd_random_crop_pad: (fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3599</span>                            fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3600</span>                            fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3601</span>                            groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3602</span>                            groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3603</span>                            multiclass_scores),</div>
<div class="line"><span class="lineno"> 3604</span>      ssd_random_crop_fixed_aspect_ratio: (</div>
<div class="line"><span class="lineno"> 3605</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3606</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3607</span>          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3608</span>          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3609</span>          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3610</span>          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3611</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3612</span>          groundtruth_keypoints),</div>
<div class="line"><span class="lineno"> 3613</span>      ssd_random_crop_pad_fixed_aspect_ratio: (</div>
<div class="line"><span class="lineno"> 3614</span>          fields.InputDataFields.image,</div>
<div class="line"><span class="lineno"> 3615</span>          fields.InputDataFields.groundtruth_boxes,</div>
<div class="line"><span class="lineno"> 3616</span>          fields.InputDataFields.groundtruth_classes,</div>
<div class="line"><span class="lineno"> 3617</span>          groundtruth_label_weights,</div>
<div class="line"><span class="lineno"> 3618</span>          groundtruth_label_confidences,</div>
<div class="line"><span class="lineno"> 3619</span>          multiclass_scores,</div>
<div class="line"><span class="lineno"> 3620</span>          groundtruth_instance_masks,</div>
<div class="line"><span class="lineno"> 3621</span>          groundtruth_keypoints,</div>
<div class="line"><span class="lineno"> 3622</span>      ),</div>
<div class="line"><span class="lineno"> 3623</span>      convert_class_logits_to_softmax: (multiclass_scores,),</div>
<div class="line"><span class="lineno"> 3624</span>  }</div>
<div class="line"><span class="lineno"> 3625</span> </div>
<div class="line"><span class="lineno"> 3626</span>  <span class="keywordflow">return</span> prep_func_arg_map</div>
<div class="line"><span class="lineno"> 3627</span> </div>
<div class="line"><span class="lineno"> 3628</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_af58a25a2d72d84c921a575c3900c74d0_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_af58a25a2d72d84c921a575c3900c74d0_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_af58a25a2d72d84c921a575c3900c74d0_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_af58a25a2d72d84c921a575c3900c74d0_icgraph">
<area shape="rect" title=" " alt="" coords="336,5,572,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a7806fdbc8bcd478d285ebb8873c8321c" title=" " alt="" coords="5,13,288,38"/>
<area shape="poly" title=" " alt="" coords="322,28,288,28,288,23,322,23"/>
</map>
</div>

</div>
</div>
<a id="a3e5b56ca6c5c071667bfe3e86359cd31" name="a3e5b56ca6c5c071667bfe3e86359cd31"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5b56ca6c5c071667bfe3e86359cd31">&#9670;&#160;</a></span>image_to_float()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.image_to_float </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Used in Faster R-CNN. Casts image pixel values to float.

Args:
  image: input image which might be in tf.uint8 or sth else format

Returns:
  image: image in tf.float32 format.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02318">2318</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2318</span><span class="keyword">def </span>image_to_float(image):</div>
<div class="line"><span class="lineno"> 2319</span>  <span class="stringliteral">&quot;&quot;&quot;Used in Faster R-CNN. Casts image pixel values to float.</span></div>
<div class="line"><span class="lineno"> 2320</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2321</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2322</span><span class="stringliteral">    image: input image which might be </span><span class="keywordflow">in</span> tf.uint8 <span class="keywordflow">or</span> sth <span class="keywordflow">else</span> format</div>
<div class="line"><span class="lineno"> 2323</span> </div>
<div class="line"><span class="lineno"> 2324</span>  Returns:</div>
<div class="line"><span class="lineno"> 2325</span>    image: image <span class="keywordflow">in</span> tf.float32 format.</div>
<div class="line"><span class="lineno"> 2326</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2327</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;ImageToFloat&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 2328</span>    image = tf.cast(image, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2329</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 2330</span> </div>
<div class="line"><span class="lineno"> 2331</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8750c531fcec2fa0f79087324bbbe86" name="ad8750c531fcec2fa0f79087324bbbe86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8750c531fcec2fa0f79087324bbbe86">&#9670;&#160;</a></span>normalize_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.normalize_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>original_minval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>original_maxval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_minval</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_maxval</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Normalizes pixel values in the image.

Moves the pixel values from the current [original_minval, original_maxval]
range to a the [target_minval, target_maxval] range.

Args:
  image: rank 3 float32 tensor containing 1
         image -&gt; [height, width, channels].
  original_minval: current image minimum value.
  original_maxval: current image maximum value.
  target_minval: target image minimum value.
  target_maxval: target image maximum value.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00249">249</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  250</span>                    target_maxval):</div>
<div class="line"><span class="lineno">  251</span>  <span class="stringliteral">&quot;&quot;&quot;Normalizes pixel values in the image.</span></div>
<div class="line"><span class="lineno">  252</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  253</span><span class="stringliteral">  Moves the pixel values </span><span class="keyword">from</span> the current [original_minval, original_maxval]</div>
<div class="line"><span class="lineno">  254</span>  range to a the [target_minval, target_maxval] range.</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  Args:</div>
<div class="line"><span class="lineno">  257</span>    image: rank 3 float32 tensor containing 1</div>
<div class="line"><span class="lineno">  258</span>           image -&gt; [height, width, channels].</div>
<div class="line"><span class="lineno">  259</span>    original_minval: current image minimum value.</div>
<div class="line"><span class="lineno">  260</span>    original_maxval: current image maximum value.</div>
<div class="line"><span class="lineno">  261</span>    target_minval: target image minimum value.</div>
<div class="line"><span class="lineno">  262</span>    target_maxval: target image maximum value.</div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  Returns:</div>
<div class="line"><span class="lineno">  265</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  266</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  267</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;NormalizeImage&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno">  268</span>    original_minval = float(original_minval)</div>
<div class="line"><span class="lineno">  269</span>    original_maxval = float(original_maxval)</div>
<div class="line"><span class="lineno">  270</span>    target_minval = float(target_minval)</div>
<div class="line"><span class="lineno">  271</span>    target_maxval = float(target_maxval)</div>
<div class="line"><span class="lineno">  272</span>    image = tf.cast(image, dtype=tf.float32)</div>
<div class="line"><span class="lineno">  273</span>    image = tf.subtract(image, original_minval)</div>
<div class="line"><span class="lineno">  274</span>    image = tf.multiply(image, (target_maxval - target_minval) /</div>
<div class="line"><span class="lineno">  275</span>                        (original_maxval - original_minval))</div>
<div class="line"><span class="lineno">  276</span>    image = tf.add(image, target_minval)</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a84b00d370e579ea07663c48b7c6a0696" name="a84b00d370e579ea07663c48b7c6a0696"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84b00d370e579ea07663c48b7c6a0696">&#9670;&#160;</a></span>one_hot_encoding()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.one_hot_encoding </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_classes</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">One-hot encodes the multiclass labels.

Example usage:
  labels = tf.constant([1, 4], dtype=tf.int32)
  one_hot = OneHotEncoding(labels, num_classes=5)
  one_hot.eval()    # evaluates to [0, 1, 0, 0, 1]

Args:
  labels: A tensor of shape [None] corresponding to the labels.
  num_classes: Number of classes in the dataset.
Returns:
  onehot_labels: a tensor of shape [num_classes] corresponding to the one hot
    encoding of the labels.
Raises:
  ValueError: if num_classes is not specified.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02712">2712</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2712</span><span class="keyword">def </span>one_hot_encoding(labels, num_classes=None):</div>
<div class="line"><span class="lineno"> 2713</span>  <span class="stringliteral">&quot;&quot;&quot;One-hot encodes the multiclass labels.</span></div>
<div class="line"><span class="lineno"> 2714</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2715</span><span class="stringliteral">  Example usage:</span></div>
<div class="line"><span class="lineno"> 2716</span><span class="stringliteral">    labels = tf.constant([1, 4], dtype=tf.int32)</span></div>
<div class="line"><span class="lineno"> 2717</span><span class="stringliteral">    one_hot = OneHotEncoding(labels, num_classes=5)</span></div>
<div class="line"><span class="lineno"> 2718</span><span class="stringliteral">    one_hot.eval()    </span><span class="comment"># evaluates to [0, 1, 0, 0, 1]</span></div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>  Args:</div>
<div class="line"><span class="lineno"> 2721</span>    labels: A tensor of shape [<span class="keywordtype">None</span>] corresponding to the labels.</div>
<div class="line"><span class="lineno"> 2722</span>    num_classes: Number of classes <span class="keywordflow">in</span> the dataset.</div>
<div class="line"><span class="lineno"> 2723</span>  Returns:</div>
<div class="line"><span class="lineno"> 2724</span>    onehot_labels: a tensor of shape [num_classes] corresponding to the one hot</div>
<div class="line"><span class="lineno"> 2725</span>      encoding of the labels.</div>
<div class="line"><span class="lineno"> 2726</span>  Raises:</div>
<div class="line"><span class="lineno"> 2727</span>    ValueError: <span class="keywordflow">if</span> num_classes <span class="keywordflow">is</span> <span class="keywordflow">not</span> specified.</div>
<div class="line"><span class="lineno"> 2728</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2729</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;OneHotEncoding&#39;</span>, values=[labels]):</div>
<div class="line"><span class="lineno"> 2730</span>    <span class="keywordflow">if</span> num_classes <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2731</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;num_classes must be specified&#39;</span>)</div>
<div class="line"><span class="lineno"> 2732</span> </div>
<div class="line"><span class="lineno"> 2733</span>    labels = tf.one_hot(labels, num_classes, 1, 0)</div>
<div class="line"><span class="lineno"> 2734</span>    <span class="keywordflow">return</span> tf.reduce_max(labels, 0)</div>
<div class="line"><span class="lineno"> 2735</span> </div>
<div class="line"><span class="lineno"> 2736</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a7806fdbc8bcd478d285ebb8873c8321c" name="a7806fdbc8bcd478d285ebb8873c8321c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7806fdbc8bcd478d285ebb8873c8321c">&#9670;&#160;</a></span>preprocess()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.preprocess </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>tensor_dict</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_options</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>func_arg_map</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Preprocess images and bounding boxes.

Various types of preprocessing (to be implemented) based on the
preprocess_options dictionary e.g. "crop image" (affects image and possibly
boxes), "white balance image" (affects only image), etc. If self._options
is None, no preprocessing is done.

Args:
  tensor_dict: dictionary that contains images, boxes, and can contain other
               things as well.
               images-&gt; rank 4 float32 tensor contains
                        1 image -&gt; [1, height, width, 3].
                        with pixel values varying between [0, 1]
               boxes-&gt; rank 2 float32 tensor containing
                       the bounding boxes -&gt; [N, 4].
                       Boxes are in normalized form meaning
                       their coordinates vary between [0, 1].
                       Each row is in the form
                       of [ymin, xmin, ymax, xmax].
  preprocess_options: It is a list of tuples, where each tuple contains a
                      function and a dictionary that contains arguments and
                      their values.
  func_arg_map: mapping from preprocessing functions to arguments that they
                expect to receive and return.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  tensor_dict: which contains the preprocessed images, bounding boxes, etc.

Raises:
  ValueError: (a) If the functions passed to Preprocess
                  are not in func_arg_map.
              (b) If the arguments that a function needs
                  do not exist in tensor_dict.
              (c) If image in tensor_dict is not rank 4
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l03629">3629</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3632</span>               preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 3633</span>  <span class="stringliteral">&quot;&quot;&quot;Preprocess images and bounding boxes.</span></div>
<div class="line"><span class="lineno"> 3634</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3635</span><span class="stringliteral">  Various types of preprocessing (to be implemented) based on the</span></div>
<div class="line"><span class="lineno"> 3636</span><span class="stringliteral">  preprocess_options dictionary e.g. &quot;crop image&quot;</span> (affects image <span class="keywordflow">and</span> possibly</div>
<div class="line"><span class="lineno"> 3637</span>  boxes), <span class="stringliteral">&quot;white balance image&quot;</span> (affects only image), etc. If self._options</div>
<div class="line"><span class="lineno"> 3638</span>  <span class="keywordflow">is</span> <span class="keywordtype">None</span>, no preprocessing <span class="keywordflow">is</span> done.</div>
<div class="line"><span class="lineno"> 3639</span> </div>
<div class="line"><span class="lineno"> 3640</span>  Args:</div>
<div class="line"><span class="lineno"> 3641</span>    tensor_dict: dictionary that contains images, boxes, <span class="keywordflow">and</span> can contain other</div>
<div class="line"><span class="lineno"> 3642</span>                 things <span class="keyword">as</span> well.</div>
<div class="line"><span class="lineno"> 3643</span>                 images-&gt; rank 4 float32 tensor contains</div>
<div class="line"><span class="lineno"> 3644</span>                          1 image -&gt; [1, height, width, 3].</div>
<div class="line"><span class="lineno"> 3645</span>                          <span class="keyword">with</span> pixel values varying between [0, 1]</div>
<div class="line"><span class="lineno"> 3646</span>                 boxes-&gt; rank 2 float32 tensor containing</div>
<div class="line"><span class="lineno"> 3647</span>                         the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 3648</span>                         Boxes are <span class="keywordflow">in</span> normalized form meaning</div>
<div class="line"><span class="lineno"> 3649</span>                         their coordinates vary between [0, 1].</div>
<div class="line"><span class="lineno"> 3650</span>                         Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form</div>
<div class="line"><span class="lineno"> 3651</span>                         of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 3652</span>    preprocess_options: It <span class="keywordflow">is</span> a list of tuples, where each tuple contains a</div>
<div class="line"><span class="lineno"> 3653</span>                        function <span class="keywordflow">and</span> a dictionary that contains arguments <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno"> 3654</span>                        their values.</div>
<div class="line"><span class="lineno"> 3655</span>    func_arg_map: mapping <span class="keyword">from</span> preprocessing functions to arguments that they</div>
<div class="line"><span class="lineno"> 3656</span>                  expect to receive <span class="keywordflow">and</span> <span class="keywordflow">return</span>.</div>
<div class="line"><span class="lineno"> 3657</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 3658</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 3659</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 3660</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 3661</span> </div>
<div class="line"><span class="lineno"> 3662</span>  Returns:</div>
<div class="line"><span class="lineno"> 3663</span>    tensor_dict: which contains the preprocessed images, bounding boxes, etc.</div>
<div class="line"><span class="lineno"> 3664</span> </div>
<div class="line"><span class="lineno"> 3665</span>  Raises:</div>
<div class="line"><span class="lineno"> 3666</span>    ValueError: (a) If the functions passed to Preprocess</div>
<div class="line"><span class="lineno"> 3667</span>                    are <span class="keywordflow">not</span> <span class="keywordflow">in</span> func_arg_map.</div>
<div class="line"><span class="lineno"> 3668</span>                (b) If the arguments that a function needs</div>
<div class="line"><span class="lineno"> 3669</span>                    do <span class="keywordflow">not</span> exist <span class="keywordflow">in</span> tensor_dict.</div>
<div class="line"><span class="lineno"> 3670</span>                (c) If image <span class="keywordflow">in</span> tensor_dict <span class="keywordflow">is</span> <span class="keywordflow">not</span> rank 4</div>
<div class="line"><span class="lineno"> 3671</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3672</span><span class="stringliteral">  </span><span class="keywordflow">if</span> func_arg_map <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3673</span>    func_arg_map = get_default_func_arg_map()</div>
<div class="line"><span class="lineno"> 3674</span> </div>
<div class="line"><span class="lineno"> 3675</span>  <span class="comment"># changes the images to image (rank 4 to rank 3) since the functions</span></div>
<div class="line"><span class="lineno"> 3676</span>  <span class="comment"># receive rank 3 tensor for image</span></div>
<div class="line"><span class="lineno"> 3677</span>  <span class="keywordflow">if</span> fields.InputDataFields.image <span class="keywordflow">in</span> tensor_dict:</div>
<div class="line"><span class="lineno"> 3678</span>    images = tensor_dict[fields.InputDataFields.image]</div>
<div class="line"><span class="lineno"> 3679</span>    <span class="keywordflow">if</span> len(images.get_shape()) != 4:</div>
<div class="line"><span class="lineno"> 3680</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;images in tensor_dict should be rank 4&#39;</span>)</div>
<div class="line"><span class="lineno"> 3681</span>    image = tf.squeeze(images, axis=0)</div>
<div class="line"><span class="lineno"> 3682</span>    tensor_dict[fields.InputDataFields.image] = image</div>
<div class="line"><span class="lineno"> 3683</span> </div>
<div class="line"><span class="lineno"> 3684</span>  <span class="comment"># Preprocess inputs based on preprocess_options</span></div>
<div class="line"><span class="lineno"> 3685</span>  <span class="keywordflow">for</span> option <span class="keywordflow">in</span> preprocess_options:</div>
<div class="line"><span class="lineno"> 3686</span>    func, params = option</div>
<div class="line"><span class="lineno"> 3687</span>    <span class="keywordflow">if</span> func <span class="keywordflow">not</span> <span class="keywordflow">in</span> func_arg_map:</div>
<div class="line"><span class="lineno"> 3688</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;The function %s does not exist in func_arg_map&#39;</span> %</div>
<div class="line"><span class="lineno"> 3689</span>                       (func.__name__))</div>
<div class="line"><span class="lineno"> 3690</span>    arg_names = func_arg_map[func]</div>
<div class="line"><span class="lineno"> 3691</span>    <span class="keywordflow">for</span> a <span class="keywordflow">in</span> arg_names:</div>
<div class="line"><span class="lineno"> 3692</span>      <span class="keywordflow">if</span> a <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> a <span class="keywordflow">not</span> <span class="keywordflow">in</span> tensor_dict:</div>
<div class="line"><span class="lineno"> 3693</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;The function %s requires argument %s&#39;</span> %</div>
<div class="line"><span class="lineno"> 3694</span>                         (func.__name__, a))</div>
<div class="line"><span class="lineno"> 3695</span> </div>
<div class="line"><span class="lineno"> 3696</span>    <span class="keyword">def </span>get_arg(key):</div>
<div class="line"><span class="lineno"> 3697</span>      <span class="keywordflow">return</span> tensor_dict[key] <span class="keywordflow">if</span> key <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">else</span> <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3698</span> </div>
<div class="line"><span class="lineno"> 3699</span>    args = [get_arg(a) <span class="keywordflow">for</span> a <span class="keywordflow">in</span> arg_names]</div>
<div class="line"><span class="lineno"> 3700</span>    <span class="keywordflow">if</span> preprocess_vars_cache <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3701</span>      <span class="keywordflow">if</span> six.PY2:</div>
<div class="line"><span class="lineno"> 3702</span>        <span class="comment"># pylint: disable=deprecated-method</span></div>
<div class="line"><span class="lineno"> 3703</span>        arg_spec = inspect.getargspec(func)</div>
<div class="line"><span class="lineno"> 3704</span>        <span class="comment"># pylint: enable=deprecated-method</span></div>
<div class="line"><span class="lineno"> 3705</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 3706</span>        arg_spec = inspect.getfullargspec(func)</div>
<div class="line"><span class="lineno"> 3707</span>      <span class="keywordflow">if</span> <span class="stringliteral">&#39;preprocess_vars_cache&#39;</span> <span class="keywordflow">in</span> arg_spec.args:</div>
<div class="line"><span class="lineno"> 3708</span>        params[<span class="stringliteral">&#39;preprocess_vars_cache&#39;</span>] = preprocess_vars_cache</div>
<div class="line"><span class="lineno"> 3709</span> </div>
<div class="line"><span class="lineno"> 3710</span>    results = func(*args, **params)</div>
<div class="line"><span class="lineno"> 3711</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(results, (list, tuple)):</div>
<div class="line"><span class="lineno"> 3712</span>      results = (results,)</div>
<div class="line"><span class="lineno"> 3713</span>    <span class="comment"># Removes None args since the return values will not contain those.</span></div>
<div class="line"><span class="lineno"> 3714</span>    arg_names = [arg_name <span class="keywordflow">for</span> arg_name <span class="keywordflow">in</span> arg_names <span class="keywordflow">if</span> arg_name <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno"> 3715</span>    <span class="keywordflow">for</span> res, arg_name <span class="keywordflow">in</span> zip(results, arg_names):</div>
<div class="line"><span class="lineno"> 3716</span>      tensor_dict[arg_name] = res</div>
<div class="line"><span class="lineno"> 3717</span> </div>
<div class="line"><span class="lineno"> 3718</span>  <span class="comment"># changes the image to images (rank 3 to rank 4) to be compatible to what</span></div>
<div class="line"><span class="lineno"> 3719</span>  <span class="comment"># we received in the first place</span></div>
<div class="line"><span class="lineno"> 3720</span>  <span class="keywordflow">if</span> fields.InputDataFields.image <span class="keywordflow">in</span> tensor_dict:</div>
<div class="line"><span class="lineno"> 3721</span>    image = tensor_dict[fields.InputDataFields.image]</div>
<div class="line"><span class="lineno"> 3722</span>    images = tf.expand_dims(image, 0)</div>
<div class="line"><span class="lineno"> 3723</span>    tensor_dict[fields.InputDataFields.image] = images</div>
<div class="line"><span class="lineno"> 3724</span> </div>
<div class="line"><span class="lineno"> 3725</span>  <span class="keywordflow">return</span> tensor_dict</div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a7806fdbc8bcd478d285ebb8873c8321c_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a7806fdbc8bcd478d285ebb8873c8321c_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a7806fdbc8bcd478d285ebb8873c8321c_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a7806fdbc8bcd478d285ebb8873c8321c_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,288,38"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#af58a25a2d72d84c921a575c3900c74d0" title=" " alt="" coords="336,5,572,45"/>
<area shape="poly" title=" " alt="" coords="288,23,322,23,322,28,288,28"/>
</map>
</div>

</div>
</div>
<a id="a3abbb64d99b25decfe25fec40a92a6b9" name="a3abbb64d99b25decfe25fec40a92a6b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3abbb64d99b25decfe25fec40a92a6b9">&#9670;&#160;</a></span>random_absolute_pad_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_absolute_pad_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_height_padding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_width_padding</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pad_color</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly pads the image by small absolute amounts.

As random_pad_image above, but the padding is of size [0, max_height_padding]
or [0, max_width_padding] instead of padding to a fixed size of
max_height_padding for all images.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  max_height_padding: a scalar tf.int32 tensor denoting the maximum amount of
                      height padding. The padding will be chosen uniformly at
                      random from [0, max_height_padding).
  max_width_padding: a scalar tf.int32 tensor denoting the maximum amount of
                     width padding. The padding will be chosen uniformly at
                     random from [0, max_width_padding).
  pad_color: padding color. A rank 1 tensor of [3] with dtype=tf.float32.
             if set as None, it will be set to average color of the input
             image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: Image shape will be [new_height, new_width, channels].
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01696">1696</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1702</span>                              preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1703</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly pads the image by small absolute amounts.</span></div>
<div class="line"><span class="lineno"> 1704</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1705</span><span class="stringliteral">  As random_pad_image above, but the padding </span><span class="keywordflow">is</span> of size [0, max_height_padding]</div>
<div class="line"><span class="lineno"> 1706</span>  <span class="keywordflow">or</span> [0, max_width_padding] instead of padding to a fixed size of</div>
<div class="line"><span class="lineno"> 1707</span>  max_height_padding <span class="keywordflow">for</span> all images.</div>
<div class="line"><span class="lineno"> 1708</span> </div>
<div class="line"><span class="lineno"> 1709</span>  Args:</div>
<div class="line"><span class="lineno"> 1710</span>    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1711</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1712</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 1713</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1714</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1715</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1716</span>    max_height_padding: a scalar tf.int32 tensor denoting the maximum amount of</div>
<div class="line"><span class="lineno"> 1717</span>                        height padding. The padding will be chosen uniformly at</div>
<div class="line"><span class="lineno"> 1718</span>                        random <span class="keyword">from</span> [0, max_height_padding).</div>
<div class="line"><span class="lineno"> 1719</span>    max_width_padding: a scalar tf.int32 tensor denoting the maximum amount of</div>
<div class="line"><span class="lineno"> 1720</span>                       width padding. The padding will be chosen uniformly at</div>
<div class="line"><span class="lineno"> 1721</span>                       random <span class="keyword">from</span> [0, max_width_padding).</div>
<div class="line"><span class="lineno"> 1722</span>    pad_color: padding color. A rank 1 tensor of [3] <span class="keyword">with</span> dtype=tf.float32.</div>
<div class="line"><span class="lineno"> 1723</span>               <span class="keywordflow">if</span> set <span class="keyword">as</span> <span class="keywordtype">None</span>, it will be set to average color of the input</div>
<div class="line"><span class="lineno"> 1724</span>               image.</div>
<div class="line"><span class="lineno"> 1725</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1726</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1727</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1728</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1729</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1730</span> </div>
<div class="line"><span class="lineno"> 1731</span>  Returns:</div>
<div class="line"><span class="lineno"> 1732</span>    image: Image shape will be [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 1733</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 1734</span>           form.</div>
<div class="line"><span class="lineno"> 1735</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1736</span><span class="stringliteral">  min_image_size = tf.shape(image)[:2]</span></div>
<div class="line"><span class="lineno"> 1737</span><span class="stringliteral">  max_image_size = min_image_size + tf.cast(</span></div>
<div class="line"><span class="lineno"> 1738</span><span class="stringliteral">      [max_height_padding, max_width_padding], dtype=tf.int32)</span></div>
<div class="line"><span class="lineno"> 1739</span><span class="stringliteral">  </span><span class="keywordflow">return</span> random_pad_image(image, boxes, min_image_size=min_image_size,</div>
<div class="line"><span class="lineno"> 1740</span>                          max_image_size=max_image_size, pad_color=pad_color,</div>
<div class="line"><span class="lineno"> 1741</span>                          seed=seed,</div>
<div class="line"><span class="lineno"> 1742</span>                          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1743</span> </div>
<div class="line"><span class="lineno"> 1744</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3abbb64d99b25decfe25fec40a92a6b9_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3abbb64d99b25decfe25fec40a92a6b9_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3abbb64d99b25decfe25fec40a92a6b9_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a3abbb64d99b25decfe25fec40a92a6b9_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc" title=" " alt="" coords="315,37,576,77"/>
<area shape="poly" title=" " alt="" coords="267,55,301,55,301,60,267,60"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="624,5,865,45"/>
<area shape="poly" title=" " alt="" coords="576,41,610,37,610,42,577,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="635,69,854,109"/>
<area shape="poly" title=" " alt="" coords="577,69,622,74,621,79,576,74"/>
</map>
</div>

</div>
</div>
<a id="a1a79d5114c3c558ffb325b491e93921a" name="a1a79d5114c3c558ffb325b491e93921a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a79d5114c3c558ffb325b491e93921a">&#9670;&#160;</a></span>random_adjust_brightness()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_adjust_brightness </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_delta</em> = <code>0.2</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly adjusts brightness.

Makes sure the output image is still between 0 and 255.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  max_delta: how much to change the brightness. A value between [0, 1).
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
  boxes: boxes which is the same shape as input boxes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00992">992</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  995</span>                             preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  996</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly adjusts brightness.</span></div>
<div class="line"><span class="lineno">  997</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  998</span><span class="stringliteral">  Makes sure the output image </span><span class="keywordflow">is</span> still between 0 <span class="keywordflow">and</span> 255.</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>  Args:</div>
<div class="line"><span class="lineno"> 1001</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1002</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 1003</span>    max_delta: how much to change the brightness. A value between [0, 1).</div>
<div class="line"><span class="lineno"> 1004</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1005</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1006</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1007</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1008</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span>  Returns:</div>
<div class="line"><span class="lineno"> 1011</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1012</span>    boxes: boxes which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 1013</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomAdjustBrightness&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1015</span>    generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 1016</span>                                       -max_delta, max_delta, seed=seed)</div>
<div class="line"><span class="lineno"> 1017</span>    delta = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1018</span>        generator_func,</div>
<div class="line"><span class="lineno"> 1019</span>        preprocessor_cache.PreprocessorCache.ADJUST_BRIGHTNESS,</div>
<div class="line"><span class="lineno"> 1020</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>    <span class="keyword">def </span>_adjust_brightness(image):</div>
<div class="line"><span class="lineno"> 1023</span>      image = tf.image.adjust_brightness(image / 255, delta) * 255</div>
<div class="line"><span class="lineno"> 1024</span>      image = tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=255.0)</div>
<div class="line"><span class="lineno"> 1025</span>      <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1026</span> </div>
<div class="line"><span class="lineno"> 1027</span>    image = _augment_only_rgb_channels(image, _adjust_brightness)</div>
<div class="line"><span class="lineno"> 1028</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1029</span> </div>
<div class="line"><span class="lineno"> 1030</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="267,41,312,36,313,41,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,69,556,109"/>
<area shape="poly" title=" " alt="" coords="267,69,301,72,300,78,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1a79d5114c3c558ffb325b491e93921a_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,576,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a299a97f4d9fc15b96cd138d910b0d4d7" name="a299a97f4d9fc15b96cd138d910b0d4d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a299a97f4d9fc15b96cd138d910b0d4d7">&#9670;&#160;</a></span>random_adjust_contrast()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_adjust_contrast </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_delta</em> = <code>0.8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_delta</em> = <code>1.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly adjusts contrast.

Makes sure the output image is still between 0 and 255.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  min_delta: see max_delta.
  max_delta: how much to change the contrast. Contrast will change with a
             value between min_delta and max_delta. This value will be
             multiplied to the current contrast of the image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01031">1031</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1035</span>                           preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1036</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly adjusts contrast.</span></div>
<div class="line"><span class="lineno"> 1037</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1038</span><span class="stringliteral">  Makes sure the output image </span><span class="keywordflow">is</span> still between 0 <span class="keywordflow">and</span> 255.</div>
<div class="line"><span class="lineno"> 1039</span> </div>
<div class="line"><span class="lineno"> 1040</span>  Args:</div>
<div class="line"><span class="lineno"> 1041</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1042</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 1043</span>    min_delta: see max_delta.</div>
<div class="line"><span class="lineno"> 1044</span>    max_delta: how much to change the contrast. Contrast will change <span class="keyword">with</span> a</div>
<div class="line"><span class="lineno"> 1045</span>               value between min_delta <span class="keywordflow">and</span> max_delta. This value will be</div>
<div class="line"><span class="lineno"> 1046</span>               multiplied to the current contrast of the image.</div>
<div class="line"><span class="lineno"> 1047</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1048</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1049</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1050</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1051</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>  Returns:</div>
<div class="line"><span class="lineno"> 1054</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1055</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomAdjustContrast&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1057</span>    generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 1058</span>                                       min_delta, max_delta, seed=seed)</div>
<div class="line"><span class="lineno"> 1059</span>    contrast_factor = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1060</span>        generator_func,</div>
<div class="line"><span class="lineno"> 1061</span>        preprocessor_cache.PreprocessorCache.ADJUST_CONTRAST,</div>
<div class="line"><span class="lineno"> 1062</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>    <span class="keyword">def </span>_adjust_contrast(image):</div>
<div class="line"><span class="lineno"> 1065</span>      image = tf.image.adjust_contrast(image / 255, contrast_factor) * 255</div>
<div class="line"><span class="lineno"> 1066</span>      image = tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=255.0)</div>
<div class="line"><span class="lineno"> 1067</span>      <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1068</span>    image = _augment_only_rgb_channels(image, _adjust_contrast)</div>
<div class="line"><span class="lineno"> 1069</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="267,41,312,36,313,41,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,69,556,109"/>
<area shape="poly" title=" " alt="" coords="267,69,301,72,300,78,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a299a97f4d9fc15b96cd138d910b0d4d7_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,576,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a1840c66a7b36bfefbcf7e2832cdbd881" name="a1840c66a7b36bfefbcf7e2832cdbd881"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1840c66a7b36bfefbcf7e2832cdbd881">&#9670;&#160;</a></span>random_adjust_hue()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_adjust_hue </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_delta</em> = <code>0.02</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly adjusts hue.

Makes sure the output image is still between 0 and 255.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  max_delta: change hue randomly with a value between 0 and max_delta.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01072">1072</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1075</span>                      preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1076</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly adjusts hue.</span></div>
<div class="line"><span class="lineno"> 1077</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1078</span><span class="stringliteral">  Makes sure the output image </span><span class="keywordflow">is</span> still between 0 <span class="keywordflow">and</span> 255.</div>
<div class="line"><span class="lineno"> 1079</span> </div>
<div class="line"><span class="lineno"> 1080</span>  Args:</div>
<div class="line"><span class="lineno"> 1081</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1082</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 1083</span>    max_delta: change hue randomly <span class="keyword">with</span> a value between 0 <span class="keywordflow">and</span> max_delta.</div>
<div class="line"><span class="lineno"> 1084</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1085</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1086</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1087</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1088</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1089</span> </div>
<div class="line"><span class="lineno"> 1090</span>  Returns:</div>
<div class="line"><span class="lineno"> 1091</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1092</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1093</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomAdjustHue&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1094</span>    generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 1095</span>                                       -max_delta, max_delta, seed=seed)</div>
<div class="line"><span class="lineno"> 1096</span>    delta = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1097</span>        generator_func, preprocessor_cache.PreprocessorCache.ADJUST_HUE,</div>
<div class="line"><span class="lineno"> 1098</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1099</span>    <span class="keyword">def </span>_adjust_hue(image):</div>
<div class="line"><span class="lineno"> 1100</span>      image = tf.image.adjust_hue(image / 255, delta) * 255</div>
<div class="line"><span class="lineno"> 1101</span>      image = tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=255.0)</div>
<div class="line"><span class="lineno"> 1102</span>      <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1103</span>    image = _augment_only_rgb_channels(image, _adjust_hue)</div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="267,41,312,36,313,41,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,69,556,109"/>
<area shape="poly" title=" " alt="" coords="267,69,301,72,300,78,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a1840c66a7b36bfefbcf7e2832cdbd881_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,576,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="ab7fcba6b229393eb466d7163c8b27e36" name="ab7fcba6b229393eb466d7163c8b27e36"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab7fcba6b229393eb466d7163c8b27e36">&#9670;&#160;</a></span>random_adjust_saturation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_adjust_saturation </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_delta</em> = <code>0.8</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_delta</em> = <code>1.25</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly adjusts saturation.

Makes sure the output image is still between 0 and 255.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  min_delta: see max_delta.
  max_delta: how much to change the saturation. Saturation will change with a
             value between min_delta and max_delta. This value will be
             multiplied to the current saturation of the image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01107">1107</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1111</span>                             preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1112</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly adjusts saturation.</span></div>
<div class="line"><span class="lineno"> 1113</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1114</span><span class="stringliteral">  Makes sure the output image </span><span class="keywordflow">is</span> still between 0 <span class="keywordflow">and</span> 255.</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>  Args:</div>
<div class="line"><span class="lineno"> 1117</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1118</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 1119</span>    min_delta: see max_delta.</div>
<div class="line"><span class="lineno"> 1120</span>    max_delta: how much to change the saturation. Saturation will change <span class="keyword">with</span> a</div>
<div class="line"><span class="lineno"> 1121</span>               value between min_delta <span class="keywordflow">and</span> max_delta. This value will be</div>
<div class="line"><span class="lineno"> 1122</span>               multiplied to the current saturation of the image.</div>
<div class="line"><span class="lineno"> 1123</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1124</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1125</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1126</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1127</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>  Returns:</div>
<div class="line"><span class="lineno"> 1130</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1131</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomAdjustSaturation&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1133</span>    generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 1134</span>                                       min_delta, max_delta, seed=seed)</div>
<div class="line"><span class="lineno"> 1135</span>    saturation_factor = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1136</span>        generator_func,</div>
<div class="line"><span class="lineno"> 1137</span>        preprocessor_cache.PreprocessorCache.ADJUST_SATURATION,</div>
<div class="line"><span class="lineno"> 1138</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1139</span>    <span class="keyword">def </span>_adjust_saturation(image):</div>
<div class="line"><span class="lineno"> 1140</span>      image = tf.image.adjust_saturation(image / 255, saturation_factor) * 255</div>
<div class="line"><span class="lineno"> 1141</span>      image = tf.clip_by_value(image, clip_value_min=0.0, clip_value_max=255.0)</div>
<div class="line"><span class="lineno"> 1142</span>      <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1143</span>    image = _augment_only_rgb_channels(image, _adjust_saturation)</div>
<div class="line"><span class="lineno"> 1144</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="267,41,312,36,313,41,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,69,556,109"/>
<area shape="poly" title=" " alt="" coords="267,69,301,72,300,78,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab7fcba6b229393eb466d7163c8b27e36_icgraph">
<area shape="rect" title=" " alt="" coords="315,5,576,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6b87ac3b4ca959406f78a5e8f2782848" title=" " alt="" coords="5,5,267,45"/>
<area shape="poly" title=" " alt="" coords="301,28,267,28,267,23,301,23"/>
</map>
</div>

</div>
</div>
<a id="a840b20876c98b893ebbca8c363ecb020" name="a840b20876c98b893ebbca8c363ecb020"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a840b20876c98b893ebbca8c363ecb020">&#9670;&#160;</a></span>random_black_patches()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_black_patches </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_black_patches</em> = <code>10</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>probability</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>size_to_image_ratio</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly adds some black patches to the image.

This op adds up to max_black_patches square black patches of a fixed size
to the image where size is specified via the size_to_image_ratio parameter.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  max_black_patches: number of times that the function tries to add a
                     black box to the image.
  probability: at each try, what is the chance of adding a box.
  size_to_image_ratio: Determines the ratio of the size of the black patches
                       to the size of the image.
                       box_size = size_to_image_ratio *
                                  min(image_width, image_height)
  random_seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02198">2198</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2203</span>                         preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2204</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly adds some black patches to the image.</span></div>
<div class="line"><span class="lineno"> 2205</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2206</span><span class="stringliteral">  This op adds up to max_black_patches square black patches of a fixed size</span></div>
<div class="line"><span class="lineno"> 2207</span><span class="stringliteral">  to the image where size </span><span class="keywordflow">is</span> specified via the size_to_image_ratio parameter.</div>
<div class="line"><span class="lineno"> 2208</span> </div>
<div class="line"><span class="lineno"> 2209</span>  Args:</div>
<div class="line"><span class="lineno"> 2210</span>    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 2211</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 2212</span>    max_black_patches: number of times that the function tries to add a</div>
<div class="line"><span class="lineno"> 2213</span>                       black box to the image.</div>
<div class="line"><span class="lineno"> 2214</span>    probability: at each <span class="keywordflow">try</span>, what <span class="keywordflow">is</span> the chance of adding a box.</div>
<div class="line"><span class="lineno"> 2215</span>    size_to_image_ratio: Determines the ratio of the size of the black patches</div>
<div class="line"><span class="lineno"> 2216</span>                         to the size of the image.</div>
<div class="line"><span class="lineno"> 2217</span>                         box_size = size_to_image_ratio *</div>
<div class="line"><span class="lineno"> 2218</span>                                    min(image_width, image_height)</div>
<div class="line"><span class="lineno"> 2219</span>    random_seed: random seed.</div>
<div class="line"><span class="lineno"> 2220</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 2221</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 2222</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 2223</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 2224</span> </div>
<div class="line"><span class="lineno"> 2225</span>  Returns:</div>
<div class="line"><span class="lineno"> 2226</span>    image</div>
<div class="line"><span class="lineno"> 2227</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2228</span><span class="stringliteral">  </span><span class="keyword">def </span>add_black_patch_to_image(image, idx):</div>
<div class="line"><span class="lineno"> 2229</span>    <span class="stringliteral">&quot;&quot;&quot;Function for adding one patch to the image.</span></div>
<div class="line"><span class="lineno"> 2230</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2231</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno"> 2232</span><span class="stringliteral">      image: image</span></div>
<div class="line"><span class="lineno"> 2233</span><span class="stringliteral">      idx: counter </span><span class="keywordflow">for</span> number of patches that could have been added</div>
<div class="line"><span class="lineno"> 2234</span> </div>
<div class="line"><span class="lineno"> 2235</span>    Returns:</div>
<div class="line"><span class="lineno"> 2236</span>      image <span class="keyword">with</span> a randomly added black box</div>
<div class="line"><span class="lineno"> 2237</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2238</span><span class="stringliteral">    image_shape = tf.shape(image)</span></div>
<div class="line"><span class="lineno"> 2239</span><span class="stringliteral">    image_height = image_shape[0]</span></div>
<div class="line"><span class="lineno"> 2240</span><span class="stringliteral">    image_width = image_shape[1]</span></div>
<div class="line"><span class="lineno"> 2241</span><span class="stringliteral">    box_size = tf.cast(</span></div>
<div class="line"><span class="lineno"> 2242</span><span class="stringliteral">        tf.multiply(</span></div>
<div class="line"><span class="lineno"> 2243</span><span class="stringliteral">            tf.minimum(</span></div>
<div class="line"><span class="lineno"> 2244</span><span class="stringliteral">                tf.cast(image_height, dtype=tf.float32),</span></div>
<div class="line"><span class="lineno"> 2245</span><span class="stringliteral">                tf.cast(image_width, dtype=tf.float32)), size_to_image_ratio),</span></div>
<div class="line"><span class="lineno"> 2246</span><span class="stringliteral">        dtype=tf.int32)</span></div>
<div class="line"><span class="lineno"> 2247</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2248</span><span class="stringliteral">    generator_func = functools.partial(tf.random_uniform, [], minval=0.0,</span></div>
<div class="line"><span class="lineno"> 2249</span><span class="stringliteral">                                       maxval=(1.0 - size_to_image_ratio),</span></div>
<div class="line"><span class="lineno"> 2250</span><span class="stringliteral">                                       seed=random_seed)</span></div>
<div class="line"><span class="lineno"> 2251</span><span class="stringliteral">    normalized_y_min = _get_or_create_preprocess_rand_vars(</span></div>
<div class="line"><span class="lineno"> 2252</span><span class="stringliteral">        generator_func,</span></div>
<div class="line"><span class="lineno"> 2253</span><span class="stringliteral">        preprocessor_cache.PreprocessorCache.ADD_BLACK_PATCH,</span></div>
<div class="line"><span class="lineno"> 2254</span><span class="stringliteral">        preprocess_vars_cache, key=str(idx) + &#39;y&#39;</span>)</div>
<div class="line"><span class="lineno"> 2255</span>    normalized_x_min = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 2256</span>        generator_func,</div>
<div class="line"><span class="lineno"> 2257</span>        preprocessor_cache.PreprocessorCache.ADD_BLACK_PATCH,</div>
<div class="line"><span class="lineno"> 2258</span>        preprocess_vars_cache, key=str(idx) + <span class="stringliteral">&#39;x&#39;</span>)</div>
<div class="line"><span class="lineno"> 2259</span> </div>
<div class="line"><span class="lineno"> 2260</span>    y_min = tf.cast(</div>
<div class="line"><span class="lineno"> 2261</span>        normalized_y_min * tf.cast(image_height, dtype=tf.float32),</div>
<div class="line"><span class="lineno"> 2262</span>        dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2263</span>    x_min = tf.cast(</div>
<div class="line"><span class="lineno"> 2264</span>        normalized_x_min * tf.cast(image_width, dtype=tf.float32),</div>
<div class="line"><span class="lineno"> 2265</span>        dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2266</span>    black_box = tf.ones([box_size, box_size, 3], dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2267</span>    mask = 1.0 - tf.image.pad_to_bounding_box(black_box, y_min, x_min,</div>
<div class="line"><span class="lineno"> 2268</span>                                              image_height, image_width)</div>
<div class="line"><span class="lineno"> 2269</span>    image = tf.multiply(image, mask)</div>
<div class="line"><span class="lineno"> 2270</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 2271</span> </div>
<div class="line"><span class="lineno"> 2272</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomBlackPatchInImage&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 2273</span>    <span class="keywordflow">for</span> idx <span class="keywordflow">in</span> range(max_black_patches):</div>
<div class="line"><span class="lineno"> 2274</span>      generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 2275</span>                                         minval=0.0, maxval=1.0,</div>
<div class="line"><span class="lineno"> 2276</span>                                         dtype=tf.float32, seed=random_seed)</div>
<div class="line"><span class="lineno"> 2277</span>      random_prob = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 2278</span>          generator_func,</div>
<div class="line"><span class="lineno"> 2279</span>          preprocessor_cache.PreprocessorCache.BLACK_PATCHES,</div>
<div class="line"><span class="lineno"> 2280</span>          preprocess_vars_cache, key=idx)</div>
<div class="line"><span class="lineno"> 2281</span>      image = tf.cond(</div>
<div class="line"><span class="lineno"> 2282</span>          tf.greater(random_prob, probability), <span class="keyword">lambda</span>: image,</div>
<div class="line"><span class="lineno"> 2283</span>          functools.partial(add_black_patch_to_image, image=image, idx=idx))</div>
<div class="line"><span class="lineno"> 2284</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 2285</span> </div>
<div class="line"><span class="lineno"> 2286</span> </div>
<div class="line"><span class="lineno"> 2287</span><span class="comment"># TODO(barretzoph): Put in AutoAugment Paper link when paper is live.</span></div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a840b20876c98b893ebbca8c363ecb020_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a840b20876c98b893ebbca8c363ecb020_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a840b20876c98b893ebbca8c363ecb020_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a840b20876c98b893ebbca8c363ecb020_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
</map>
</div>

</div>
</div>
<a id="ae53f685c9e071ec37c0829148e5067fe" name="ae53f685c9e071ec37c0829148e5067fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae53f685c9e071ec37c0829148e5067fe">&#9670;&#160;</a></span>random_crop_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_crop_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>(0.75,&#160;1.33)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>(0.1,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly crops the image.

Given the input image and its bounding boxes, this op randomly
crops a subimage.  Given a user-provided set of input constraints,
the crop window is resampled until it satisfies these constraints.
If within 100 trials it is unable to find a valid crop, the original
image is returned. See the Args section for a description of the input
constraints. Both input boxes and returned Boxes are in normalized
form (e.g., lie in the unit square [0, 1]).
This function will return the original image with probability random_coef.

Note: Keypoint coordinates that are outside the crop will be set to NaN, which
is consistent with the original keypoint encoding for non-existing keypoints.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes with shape
         [num_instances, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: (optional) float32 tensor of shape [num_instances].
    representing the confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: Image shape will be [new_height, new_width, channels].
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form.
  labels: new labels.

  If label_weights, multiclass_scores, masks, or keypoints is not None, the
  function also returns:
  label_weights: rank 1 float32 tensor with shape [num_instances].
  multiclass_scores: rank 2 float32 tensor with shape
                     [num_instances, num_classes]
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01430">1430</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1445</span>                      preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1446</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly crops the image.</span></div>
<div class="line"><span class="lineno"> 1447</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1448</span><span class="stringliteral">  Given the input image </span><span class="keywordflow">and</span> its bounding boxes, this op randomly</div>
<div class="line"><span class="lineno"> 1449</span>  crops a subimage.  Given a user-provided set of input constraints,</div>
<div class="line"><span class="lineno"> 1450</span>  the crop window <span class="keywordflow">is</span> resampled until it satisfies these constraints.</div>
<div class="line"><span class="lineno"> 1451</span>  If within 100 trials it <span class="keywordflow">is</span> unable to find a valid crop, the original</div>
<div class="line"><span class="lineno"> 1452</span>  image <span class="keywordflow">is</span> returned. See the Args section <span class="keywordflow">for</span> a description of the input</div>
<div class="line"><span class="lineno"> 1453</span>  constraints. Both input boxes <span class="keywordflow">and</span> returned Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 1454</span>  form (e.g., lie <span class="keywordflow">in</span> the unit square [0, 1]).</div>
<div class="line"><span class="lineno"> 1455</span>  This function will <span class="keywordflow">return</span> the original image <span class="keyword">with</span> probability random_coef.</div>
<div class="line"><span class="lineno"> 1456</span> </div>
<div class="line"><span class="lineno"> 1457</span>  Note: Keypoint coordinates that are outside the crop will be set to NaN, which</div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keywordflow">is</span> consistent <span class="keyword">with</span> the original keypoint encoding <span class="keywordflow">for</span> non-existing keypoints.</div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span>  Args:</div>
<div class="line"><span class="lineno"> 1461</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1462</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1463</span>    boxes: rank 2 float32 tensor containing the bounding boxes <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1464</span>           [num_instances, 4].</div>
<div class="line"><span class="lineno"> 1465</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1466</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1467</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1468</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 1469</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 1470</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1471</span>    label_confidences: (optional) float32 tensor of shape [num_instances].</div>
<div class="line"><span class="lineno"> 1472</span>      representing the confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1473</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 1474</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 1475</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 1476</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1477</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 1478</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 1479</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1480</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 1481</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 1482</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 1483</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 1484</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 1485</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 1486</span>                original image.</div>
<div class="line"><span class="lineno"> 1487</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 1488</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 1489</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 1490</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 1491</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 1492</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 1493</span>                 original image.</div>
<div class="line"><span class="lineno"> 1494</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1495</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1496</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1497</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1498</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1499</span> </div>
<div class="line"><span class="lineno"> 1500</span>  Returns:</div>
<div class="line"><span class="lineno"> 1501</span>    image: Image shape will be [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 1502</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 1503</span>           form.</div>
<div class="line"><span class="lineno"> 1504</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 1505</span> </div>
<div class="line"><span class="lineno"> 1506</span>    If label_weights, multiclass_scores, masks, <span class="keywordflow">or</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the</div>
<div class="line"><span class="lineno"> 1507</span>    function also returns:</div>
<div class="line"><span class="lineno"> 1508</span>    label_weights: rank 1 float32 tensor <span class="keyword">with</span> shape [num_instances].</div>
<div class="line"><span class="lineno"> 1509</span>    multiclass_scores: rank 2 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1510</span>                       [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 1511</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 1512</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 1513</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1514</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 1515</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1516</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1517</span><span class="stringliteral">  </span><span class="keyword">def </span>strict_random_crop_image_fn():</div>
<div class="line"><span class="lineno"> 1518</span>    <span class="keywordflow">return</span> _strict_random_crop_image(</div>
<div class="line"><span class="lineno"> 1519</span>        image,</div>
<div class="line"><span class="lineno"> 1520</span>        boxes,</div>
<div class="line"><span class="lineno"> 1521</span>        labels,</div>
<div class="line"><span class="lineno"> 1522</span>        label_weights,</div>
<div class="line"><span class="lineno"> 1523</span>        label_confidences=label_confidences,</div>
<div class="line"><span class="lineno"> 1524</span>        multiclass_scores=multiclass_scores,</div>
<div class="line"><span class="lineno"> 1525</span>        masks=masks,</div>
<div class="line"><span class="lineno"> 1526</span>        keypoints=keypoints,</div>
<div class="line"><span class="lineno"> 1527</span>        min_object_covered=min_object_covered,</div>
<div class="line"><span class="lineno"> 1528</span>        aspect_ratio_range=aspect_ratio_range,</div>
<div class="line"><span class="lineno"> 1529</span>        area_range=area_range,</div>
<div class="line"><span class="lineno"> 1530</span>        overlap_thresh=overlap_thresh,</div>
<div class="line"><span class="lineno"> 1531</span>        clip_boxes=clip_boxes,</div>
<div class="line"><span class="lineno"> 1532</span>        preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1533</span> </div>
<div class="line"><span class="lineno"> 1534</span>  <span class="comment"># avoids tf.cond to make faster RCNN training on borg. See b/140057645.</span></div>
<div class="line"><span class="lineno"> 1535</span>  <span class="keywordflow">if</span> random_coef &lt; sys.float_info.min:</div>
<div class="line"><span class="lineno"> 1536</span>    result = strict_random_crop_image_fn()</div>
<div class="line"><span class="lineno"> 1537</span>  <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1538</span>    generator_func = functools.partial(tf.random_uniform, [], seed=seed)</div>
<div class="line"><span class="lineno"> 1539</span>    do_a_crop_random = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1540</span>        generator_func, preprocessor_cache.PreprocessorCache.CROP_IMAGE,</div>
<div class="line"><span class="lineno"> 1541</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1542</span>    do_a_crop_random = tf.greater(do_a_crop_random, random_coef)</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>    outputs = [image, boxes, labels]</div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1547</span>      outputs.append(label_weights)</div>
<div class="line"><span class="lineno"> 1548</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1549</span>      outputs.append(label_confidences)</div>
<div class="line"><span class="lineno"> 1550</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1551</span>      outputs.append(multiclass_scores)</div>
<div class="line"><span class="lineno"> 1552</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1553</span>      outputs.append(masks)</div>
<div class="line"><span class="lineno"> 1554</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1555</span>      outputs.append(keypoints)</div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>    result = tf.cond(do_a_crop_random, strict_random_crop_image_fn,</div>
<div class="line"><span class="lineno"> 1558</span>                     <span class="keyword">lambda</span>: tuple(outputs))</div>
<div class="line"><span class="lineno"> 1559</span>  <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 1560</span> </div>
<div class="line"><span class="lineno"> 1561</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="581,5,823,45"/>
<area shape="poly" title=" " alt="" coords="267,19,315,19,533,19,567,19,567,25,533,24,315,24,267,25"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="315,33,533,73"/>
<area shape="poly" title=" " alt="" coords="267,35,301,39,301,44,267,41"/>
<area shape="poly" title=" " alt="" coords="533,40,567,36,568,42,534,45"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae53f685c9e071ec37c0829148e5067fe_icgraph">
<area shape="rect" title=" " alt="" coords="607,37,868,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="297,5,559,45"/>
<area shape="poly" title=" " alt="" coords="593,45,559,42,559,36,593,40"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="309,69,547,109"/>
<area shape="poly" title=" " alt="" coords="593,75,548,80,547,74,593,70"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="8,5,247,45"/>
<area shape="poly" title=" " alt="" coords="284,28,247,28,247,23,284,23"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="8,69,247,109"/>
<area shape="poly" title=" " alt="" coords="295,92,247,92,247,87,295,87"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,133,249,173"/>
<area shape="poly" title=" " alt="" coords="321,115,222,136,221,131,320,110"/>
</map>
</div>

</div>
</div>
<a id="ad862ff65e576da434816a69fd341b3ff" name="ad862ff65e576da434816a69fd341b3ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad862ff65e576da434816a69fd341b3ff">&#9670;&#160;</a></span>random_crop_pad_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_crop_pad_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>(0.75,&#160;1.33)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>(0.1,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>0.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_padded_size_ratio</em> = <code>(1.0,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_padded_size_ratio</em> = <code>(2.0,&#160;2.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pad_color</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly crops and pads the image.

Given an input image and its bounding boxes, this op first randomly crops
the image and then randomly pads the image with background values. Parameters
min_padded_size_ratio and max_padded_size_ratio, determine the range of the
final output image size.  Specifically, the final image size will have a size
in the range of min_padded_size_ratio * tf.shape(image) and
max_padded_size_ratio * tf.shape(image). Note that these ratios are with
respect to the size of the original image, so we can't capture the same
effect easily by independently applying RandomCropImage
followed by RandomPadImage.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: rank 1 float32 containing the label weights.
  label_confidences: rank 1 float32 containing the label confidences.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  min_padded_size_ratio: min ratio of padded image height and width to the
                         input image's height and width.
  max_padded_size_ratio: max ratio of padded image height and width to the
                         input image's height and width.
  pad_color: padding color. A rank 1 tensor of [3] with dtype=tf.float32.
             if set as None, it will be set to average color of the randomly
             cropped image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  padded_image: padded image.
  padded_boxes: boxes which is the same rank as input boxes. Boxes are in
                normalized form.
  cropped_labels: cropped labels.
  if label_weights is not None also returns:
  cropped_label_weights: cropped label weights.
  if multiclass_scores is not None also returns:
  cropped_multiclass_scores: cropped_multiclass_scores.</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01745">1745</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1761</span>                          preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1762</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly crops and pads the image.</span></div>
<div class="line"><span class="lineno"> 1763</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1764</span><span class="stringliteral">  Given an input image </span><span class="keywordflow">and</span> its bounding boxes, this op first randomly crops</div>
<div class="line"><span class="lineno"> 1765</span>  the image <span class="keywordflow">and</span> then randomly pads the image <span class="keyword">with</span> background values. Parameters</div>
<div class="line"><span class="lineno"> 1766</span>  min_padded_size_ratio <span class="keywordflow">and</span> max_padded_size_ratio, determine the range of the</div>
<div class="line"><span class="lineno"> 1767</span>  final output image size.  Specifically, the final image size will have a size</div>
<div class="line"><span class="lineno"> 1768</span>  <span class="keywordflow">in</span> the range of min_padded_size_ratio * tf.shape(image) <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno"> 1769</span>  max_padded_size_ratio * tf.shape(image). Note that these ratios are <span class="keyword">with</span></div>
<div class="line"><span class="lineno"> 1770</span>  respect to the size of the original image, so we can<span class="stringliteral">&#39;t capture the same</span></div>
<div class="line"><span class="lineno"> 1771</span><span class="stringliteral">  effect easily by independently applying RandomCropImage</span></div>
<div class="line"><span class="lineno"> 1772</span><span class="stringliteral">  followed by RandomPadImage.</span></div>
<div class="line"><span class="lineno"> 1773</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1774</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 1775</span><span class="stringliteral">    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 1776</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1777</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 1778</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1779</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1780</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1781</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 1782</span>    label_weights: rank 1 float32 containing the label weights.</div>
<div class="line"><span class="lineno"> 1783</span>    label_confidences: rank 1 float32 containing the label confidences.</div>
<div class="line"><span class="lineno"> 1784</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 1785</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 1786</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 1787</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 1788</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 1789</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 1790</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 1791</span>                original image.</div>
<div class="line"><span class="lineno"> 1792</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 1793</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 1794</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 1795</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 1796</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 1797</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 1798</span>                 original image.</div>
<div class="line"><span class="lineno"> 1799</span>    min_padded_size_ratio: min ratio of padded image height <span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 1800</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 1801</span><span class="stringliteral">    max_padded_size_ratio: max ratio of padded image height </span><span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 1802</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 1803</span><span class="stringliteral">    pad_color: padding color. A rank 1 tensor of [3] </span><span class="keyword">with</span> dtype=tf.float32.</div>
<div class="line"><span class="lineno"> 1804</span>               <span class="keywordflow">if</span> set <span class="keyword">as</span> <span class="keywordtype">None</span>, it will be set to average color of the randomly</div>
<div class="line"><span class="lineno"> 1805</span>               cropped image.</div>
<div class="line"><span class="lineno"> 1806</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1807</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1808</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1809</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1810</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>  Returns:</div>
<div class="line"><span class="lineno"> 1813</span>    padded_image: padded image.</div>
<div class="line"><span class="lineno"> 1814</span>    padded_boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span></div>
<div class="line"><span class="lineno"> 1815</span>                  normalized form.</div>
<div class="line"><span class="lineno"> 1816</span>    cropped_labels: cropped labels.</div>
<div class="line"><span class="lineno"> 1817</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> also returns:</div>
<div class="line"><span class="lineno"> 1818</span>    cropped_label_weights: cropped label weights.</div>
<div class="line"><span class="lineno"> 1819</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> also returns:</div>
<div class="line"><span class="lineno"> 1820</span>    cropped_multiclass_scores: cropped_multiclass_scores.</div>
<div class="line"><span class="lineno"> 1821</span> </div>
<div class="line"><span class="lineno"> 1822</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1823</span><span class="stringliteral">  image_size = tf.shape(image)</span></div>
<div class="line"><span class="lineno"> 1824</span><span class="stringliteral">  image_height = image_size[0]</span></div>
<div class="line"><span class="lineno"> 1825</span><span class="stringliteral">  image_width = image_size[1]</span></div>
<div class="line"><span class="lineno"> 1826</span><span class="stringliteral">  result = random_crop_image(</span></div>
<div class="line"><span class="lineno"> 1827</span><span class="stringliteral">      image=image,</span></div>
<div class="line"><span class="lineno"> 1828</span><span class="stringliteral">      boxes=boxes,</span></div>
<div class="line"><span class="lineno"> 1829</span><span class="stringliteral">      labels=labels,</span></div>
<div class="line"><span class="lineno"> 1830</span><span class="stringliteral">      label_weights=label_weights,</span></div>
<div class="line"><span class="lineno"> 1831</span><span class="stringliteral">      label_confidences=label_confidences,</span></div>
<div class="line"><span class="lineno"> 1832</span><span class="stringliteral">      multiclass_scores=multiclass_scores,</span></div>
<div class="line"><span class="lineno"> 1833</span><span class="stringliteral">      min_object_covered=min_object_covered,</span></div>
<div class="line"><span class="lineno"> 1834</span><span class="stringliteral">      aspect_ratio_range=aspect_ratio_range,</span></div>
<div class="line"><span class="lineno"> 1835</span><span class="stringliteral">      area_range=area_range,</span></div>
<div class="line"><span class="lineno"> 1836</span><span class="stringliteral">      overlap_thresh=overlap_thresh,</span></div>
<div class="line"><span class="lineno"> 1837</span><span class="stringliteral">      clip_boxes=clip_boxes,</span></div>
<div class="line"><span class="lineno"> 1838</span><span class="stringliteral">      random_coef=random_coef,</span></div>
<div class="line"><span class="lineno"> 1839</span><span class="stringliteral">      seed=seed,</span></div>
<div class="line"><span class="lineno"> 1840</span><span class="stringliteral">      preprocess_vars_cache=preprocess_vars_cache)</span></div>
<div class="line"><span class="lineno"> 1841</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1842</span><span class="stringliteral">  cropped_image, cropped_boxes, cropped_labels = result[:3]</span></div>
<div class="line"><span class="lineno"> 1843</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1844</span><span class="stringliteral">  min_image_size = tf.cast(</span></div>
<div class="line"><span class="lineno"> 1845</span><span class="stringliteral">      tf.cast(tf.stack([image_height, image_width]), dtype=tf.float32) *</span></div>
<div class="line"><span class="lineno"> 1846</span><span class="stringliteral">      min_padded_size_ratio,</span></div>
<div class="line"><span class="lineno"> 1847</span><span class="stringliteral">      dtype=tf.int32)</span></div>
<div class="line"><span class="lineno"> 1848</span><span class="stringliteral">  max_image_size = tf.cast(</span></div>
<div class="line"><span class="lineno"> 1849</span><span class="stringliteral">      tf.cast(tf.stack([image_height, image_width]), dtype=tf.float32) *</span></div>
<div class="line"><span class="lineno"> 1850</span><span class="stringliteral">      max_padded_size_ratio,</span></div>
<div class="line"><span class="lineno"> 1851</span><span class="stringliteral">      dtype=tf.int32)</span></div>
<div class="line"><span class="lineno"> 1852</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1853</span><span class="stringliteral">  padded_image, padded_boxes = random_pad_image(</span></div>
<div class="line"><span class="lineno"> 1854</span><span class="stringliteral">      cropped_image,</span></div>
<div class="line"><span class="lineno"> 1855</span><span class="stringliteral">      cropped_boxes,</span></div>
<div class="line"><span class="lineno"> 1856</span><span class="stringliteral">      min_image_size=min_image_size,</span></div>
<div class="line"><span class="lineno"> 1857</span><span class="stringliteral">      max_image_size=max_image_size,</span></div>
<div class="line"><span class="lineno"> 1858</span><span class="stringliteral">      pad_color=pad_color,</span></div>
<div class="line"><span class="lineno"> 1859</span><span class="stringliteral">      seed=seed,</span></div>
<div class="line"><span class="lineno"> 1860</span><span class="stringliteral">      preprocess_vars_cache=preprocess_vars_cache)</span></div>
<div class="line"><span class="lineno"> 1861</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1862</span><span class="stringliteral">  cropped_padded_output = (padded_image, padded_boxes, cropped_labels)</span></div>
<div class="line"><span class="lineno"> 1863</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1864</span><span class="stringliteral">  index = 3</span></div>
<div class="line"><span class="lineno"> 1865</span><span class="stringliteral">  </span><span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1866</span>    cropped_label_weights = result[index]</div>
<div class="line"><span class="lineno"> 1867</span>    cropped_padded_output += (cropped_label_weights,)</div>
<div class="line"><span class="lineno"> 1868</span>    index += 1</div>
<div class="line"><span class="lineno"> 1869</span> </div>
<div class="line"><span class="lineno"> 1870</span>  <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1871</span>    cropped_label_confidences = result[index]</div>
<div class="line"><span class="lineno"> 1872</span>    cropped_padded_output += (cropped_label_confidences,)</div>
<div class="line"><span class="lineno"> 1873</span>    index += 1</div>
<div class="line"><span class="lineno"> 1874</span> </div>
<div class="line"><span class="lineno"> 1875</span>  <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1876</span>    cropped_multiclass_scores = result[index]</div>
<div class="line"><span class="lineno"> 1877</span>    cropped_padded_output += (cropped_multiclass_scores,)</div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span>  <span class="keywordflow">return</span> cropped_padded_output</div>
<div class="line"><span class="lineno"> 1880</span> </div>
<div class="line"><span class="lineno"> 1881</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_cgraph">
<area shape="rect" title=" " alt="" coords="5,53,267,93"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="315,21,576,61"/>
<area shape="poly" title=" " alt="" coords="267,57,301,54,301,59,267,62"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc" title=" " alt="" coords="315,85,576,125"/>
<area shape="poly" title=" " alt="" coords="267,84,301,88,301,93,267,89"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="891,24,1132,64"/>
<area shape="poly" title=" " alt="" coords="550,19,624,9,733,3,843,9,909,19,908,24,842,15,733,8,624,15,550,24"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="624,24,843,64"/>
<area shape="poly" title=" " alt="" coords="576,40,610,40,610,45,576,45"/>
<area shape="poly" title=" " alt="" coords="843,41,877,41,877,47,843,47"/>
<area shape="poly" title=" " alt="" coords="576,97,705,88,842,73,902,64,903,69,843,79,706,93,577,102"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="624,139,843,179"/>
<area shape="poly" title=" " alt="" coords="554,123,612,133,611,139,553,128"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ad862ff65e576da434816a69fd341b3ff_icgraph">
<area shape="rect" title=" " alt="" coords="292,5,553,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="5,5,244,45"/>
<area shape="poly" title=" " alt="" coords="278,28,244,28,244,23,278,23"/>
</map>
</div>

</div>
</div>
<a id="aed03769aeaaf1e8b96f676996f870e8c" name="aed03769aeaaf1e8b96f676996f870e8c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed03769aeaaf1e8b96f676996f870e8c">&#9670;&#160;</a></span>random_crop_to_aspect_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_crop_to_aspect_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>0.3</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>True</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly crops an image to the specified aspect ratio.

Randomly crops the a portion of the image such that the crop is of the
specified aspect ratio, and the crop is as large as possible. If the specified
aspect ratio is larger than the aspect ratio of the image, this op will
randomly remove rows from the top and bottom of the image. If the specified
aspect ratio is less than the aspect ratio of the image, this op will randomly
remove cols from the left and right of the image. If the specified aspect
ratio is the same as the aspect ratio of the image, this op will return the
image.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: (optional) float32 tensor of shape [num_instances]
    representing the confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  aspect_ratio: the aspect ratio of cropped image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If label_weights, masks, keypoints, or multiclass_scores is not None, the
  function also returns:
  label_weights: rank 1 float32 tensor with shape [num_instances].
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
  multiclass_scores: rank 2 float32 tensor with shape
                     [num_instances, num_classes]

Raises:
  ValueError: If image is not a 3D tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01882">1882</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1894</span>                                preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1895</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly crops an image to the specified aspect ratio.</span></div>
<div class="line"><span class="lineno"> 1896</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1897</span><span class="stringliteral">  Randomly crops the a portion of the image such that the crop </span><span class="keywordflow">is</span> of the</div>
<div class="line"><span class="lineno"> 1898</span>  specified aspect ratio, <span class="keywordflow">and</span> the crop <span class="keywordflow">is</span> <span class="keyword">as</span> large <span class="keyword">as</span> possible. If the specified</div>
<div class="line"><span class="lineno"> 1899</span>  aspect ratio <span class="keywordflow">is</span> larger than the aspect ratio of the image, this op will</div>
<div class="line"><span class="lineno"> 1900</span>  randomly remove rows <span class="keyword">from</span> the top <span class="keywordflow">and</span> bottom of the image. If the specified</div>
<div class="line"><span class="lineno"> 1901</span>  aspect ratio <span class="keywordflow">is</span> less than the aspect ratio of the image, this op will randomly</div>
<div class="line"><span class="lineno"> 1902</span>  remove cols <span class="keyword">from</span> the left <span class="keywordflow">and</span> right of the image. If the specified aspect</div>
<div class="line"><span class="lineno"> 1903</span>  ratio <span class="keywordflow">is</span> the same <span class="keyword">as</span> the aspect ratio of the image, this op will <span class="keywordflow">return</span> the</div>
<div class="line"><span class="lineno"> 1904</span>  image.</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>  Args:</div>
<div class="line"><span class="lineno"> 1907</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1908</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1909</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 1910</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1911</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1912</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1913</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 1914</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 1915</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1916</span>    label_confidences: (optional) float32 tensor of shape [num_instances]</div>
<div class="line"><span class="lineno"> 1917</span>      representing the confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 1918</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 1919</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 1920</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 1921</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1922</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 1923</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 1924</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1925</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 1926</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 1927</span>    aspect_ratio: the aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 1928</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 1929</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 1930</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 1931</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1932</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1933</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1934</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1935</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1936</span> </div>
<div class="line"><span class="lineno"> 1937</span>  Returns:</div>
<div class="line"><span class="lineno"> 1938</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1939</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 1940</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 1941</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 1942</span> </div>
<div class="line"><span class="lineno"> 1943</span>    If label_weights, masks, keypoints, <span class="keywordflow">or</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the</div>
<div class="line"><span class="lineno"> 1944</span>    function also returns:</div>
<div class="line"><span class="lineno"> 1945</span>    label_weights: rank 1 float32 tensor <span class="keyword">with</span> shape [num_instances].</div>
<div class="line"><span class="lineno"> 1946</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 1947</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 1948</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1949</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 1950</span>    multiclass_scores: rank 2 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1951</span>                       [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 1952</span> </div>
<div class="line"><span class="lineno"> 1953</span>  Raises:</div>
<div class="line"><span class="lineno"> 1954</span>    ValueError: If image <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 3D tensor.</div>
<div class="line"><span class="lineno"> 1955</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1956</span><span class="stringliteral">  </span><span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 1957</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Image should be 3D tensor&#39;</span>)</div>
<div class="line"><span class="lineno"> 1958</span> </div>
<div class="line"><span class="lineno"> 1959</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomCropToAspectRatio&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1960</span>    image_shape = tf.shape(image)</div>
<div class="line"><span class="lineno"> 1961</span>    orig_height = image_shape[0]</div>
<div class="line"><span class="lineno"> 1962</span>    orig_width = image_shape[1]</div>
<div class="line"><span class="lineno"> 1963</span>    orig_aspect_ratio = tf.cast(</div>
<div class="line"><span class="lineno"> 1964</span>        orig_width, dtype=tf.float32) / tf.cast(</div>
<div class="line"><span class="lineno"> 1965</span>            orig_height, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 1966</span>    new_aspect_ratio = tf.constant(aspect_ratio, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 1967</span> </div>
<div class="line"><span class="lineno"> 1968</span>    <span class="keyword">def </span>target_height_fn():</div>
<div class="line"><span class="lineno"> 1969</span>      <span class="keywordflow">return</span> tf.cast(</div>
<div class="line"><span class="lineno"> 1970</span>          tf.round(tf.cast(orig_width, dtype=tf.float32) / new_aspect_ratio),</div>
<div class="line"><span class="lineno"> 1971</span>          dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 1972</span> </div>
<div class="line"><span class="lineno"> 1973</span>    target_height = tf.cond(orig_aspect_ratio &gt;= new_aspect_ratio,</div>
<div class="line"><span class="lineno"> 1974</span>                            <span class="keyword">lambda</span>: orig_height, target_height_fn)</div>
<div class="line"><span class="lineno"> 1975</span> </div>
<div class="line"><span class="lineno"> 1976</span>    <span class="keyword">def </span>target_width_fn():</div>
<div class="line"><span class="lineno"> 1977</span>      <span class="keywordflow">return</span> tf.cast(</div>
<div class="line"><span class="lineno"> 1978</span>          tf.round(tf.cast(orig_height, dtype=tf.float32) * new_aspect_ratio),</div>
<div class="line"><span class="lineno"> 1979</span>          dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 1980</span> </div>
<div class="line"><span class="lineno"> 1981</span>    target_width = tf.cond(orig_aspect_ratio &lt;= new_aspect_ratio,</div>
<div class="line"><span class="lineno"> 1982</span>                           <span class="keyword">lambda</span>: orig_width, target_width_fn)</div>
<div class="line"><span class="lineno"> 1983</span> </div>
<div class="line"><span class="lineno"> 1984</span>    <span class="comment"># either offset_height = 0 and offset_width is randomly chosen from</span></div>
<div class="line"><span class="lineno"> 1985</span>    <span class="comment"># [0, offset_width - target_width), or else offset_width = 0 and</span></div>
<div class="line"><span class="lineno"> 1986</span>    <span class="comment"># offset_height is randomly chosen from [0, offset_height - target_height)</span></div>
<div class="line"><span class="lineno"> 1987</span>    offset_height = _random_integer(0, orig_height - target_height + 1, seed)</div>
<div class="line"><span class="lineno"> 1988</span>    offset_width = _random_integer(0, orig_width - target_width + 1, seed)</div>
<div class="line"><span class="lineno"> 1989</span> </div>
<div class="line"><span class="lineno"> 1990</span>    generator_func = <span class="keyword">lambda</span>: (offset_height, offset_width)</div>
<div class="line"><span class="lineno"> 1991</span>    offset_height, offset_width = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1992</span>        generator_func,</div>
<div class="line"><span class="lineno"> 1993</span>        preprocessor_cache.PreprocessorCache.CROP_TO_ASPECT_RATIO,</div>
<div class="line"><span class="lineno"> 1994</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1995</span> </div>
<div class="line"><span class="lineno"> 1996</span>    new_image = tf.image.crop_to_bounding_box(</div>
<div class="line"><span class="lineno"> 1997</span>        image, offset_height, offset_width, target_height, target_width)</div>
<div class="line"><span class="lineno"> 1998</span> </div>
<div class="line"><span class="lineno"> 1999</span>    im_box = tf.stack([</div>
<div class="line"><span class="lineno"> 2000</span>        tf.cast(offset_height, dtype=tf.float32) /</div>
<div class="line"><span class="lineno"> 2001</span>        tf.cast(orig_height, dtype=tf.float32),</div>
<div class="line"><span class="lineno"> 2002</span>        tf.cast(offset_width, dtype=tf.float32) /</div>
<div class="line"><span class="lineno"> 2003</span>        tf.cast(orig_width, dtype=tf.float32),</div>
<div class="line"><span class="lineno"> 2004</span>        tf.cast(offset_height + target_height, dtype=tf.float32) /</div>
<div class="line"><span class="lineno"> 2005</span>        tf.cast(orig_height, dtype=tf.float32),</div>
<div class="line"><span class="lineno"> 2006</span>        tf.cast(offset_width + target_width, dtype=tf.float32) /</div>
<div class="line"><span class="lineno"> 2007</span>        tf.cast(orig_width, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2008</span>    ])</div>
<div class="line"><span class="lineno"> 2009</span> </div>
<div class="line"><span class="lineno"> 2010</span>    boxlist = box_list.BoxList(boxes)</div>
<div class="line"><span class="lineno"> 2011</span>    boxlist.add_field(<span class="stringliteral">&#39;labels&#39;</span>, labels)</div>
<div class="line"><span class="lineno"> 2012</span> </div>
<div class="line"><span class="lineno"> 2013</span>    boxlist.add_field(<span class="stringliteral">&#39;label_weights&#39;</span>, label_weights)</div>
<div class="line"><span class="lineno"> 2014</span> </div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2016</span>      boxlist.add_field(<span class="stringliteral">&#39;label_confidences&#39;</span>, label_confidences)</div>
<div class="line"><span class="lineno"> 2017</span> </div>
<div class="line"><span class="lineno"> 2018</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2019</span>      boxlist.add_field(<span class="stringliteral">&#39;multiclass_scores&#39;</span>, multiclass_scores)</div>
<div class="line"><span class="lineno"> 2020</span> </div>
<div class="line"><span class="lineno"> 2021</span>    im_boxlist = box_list.BoxList(tf.expand_dims(im_box, 0))</div>
<div class="line"><span class="lineno"> 2022</span> </div>
<div class="line"><span class="lineno"> 2023</span>    <span class="comment"># remove boxes whose overlap with the image is less than overlap_thresh</span></div>
<div class="line"><span class="lineno"> 2024</span>    overlapping_boxlist, keep_ids = box_list_ops.prune_non_overlapping_boxes(</div>
<div class="line"><span class="lineno"> 2025</span>        boxlist, im_boxlist, overlap_thresh)</div>
<div class="line"><span class="lineno"> 2026</span> </div>
<div class="line"><span class="lineno"> 2027</span>    <span class="comment"># change the coordinate of the remaining boxes</span></div>
<div class="line"><span class="lineno"> 2028</span>    new_labels = overlapping_boxlist.get_field(<span class="stringliteral">&#39;labels&#39;</span>)</div>
<div class="line"><span class="lineno"> 2029</span>    new_boxlist = box_list_ops.change_coordinate_frame(overlapping_boxlist,</div>
<div class="line"><span class="lineno"> 2030</span>                                                       im_box)</div>
<div class="line"><span class="lineno"> 2031</span>    <span class="keywordflow">if</span> clip_boxes:</div>
<div class="line"><span class="lineno"> 2032</span>      new_boxlist = box_list_ops.clip_to_window(</div>
<div class="line"><span class="lineno"> 2033</span>          new_boxlist, tf.constant([0.0, 0.0, 1.0, 1.0], tf.float32))</div>
<div class="line"><span class="lineno"> 2034</span>    new_boxes = new_boxlist.get()</div>
<div class="line"><span class="lineno"> 2035</span> </div>
<div class="line"><span class="lineno"> 2036</span>    result = [new_image, new_boxes, new_labels]</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span>    new_label_weights = overlapping_boxlist.get_field(<span class="stringliteral">&#39;label_weights&#39;</span>)</div>
<div class="line"><span class="lineno"> 2039</span>    result.append(new_label_weights)</div>
<div class="line"><span class="lineno"> 2040</span> </div>
<div class="line"><span class="lineno"> 2041</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2042</span>      new_label_confidences = (</div>
<div class="line"><span class="lineno"> 2043</span>          overlapping_boxlist.get_field(<span class="stringliteral">&#39;label_confidences&#39;</span>))</div>
<div class="line"><span class="lineno"> 2044</span>      result.append(new_label_confidences)</div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2047</span>      new_multiclass_scores = overlapping_boxlist.get_field(<span class="stringliteral">&#39;multiclass_scores&#39;</span>)</div>
<div class="line"><span class="lineno"> 2048</span>      result.append(new_multiclass_scores)</div>
<div class="line"><span class="lineno"> 2049</span> </div>
<div class="line"><span class="lineno"> 2050</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2051</span>      masks_inside_window = tf.gather(masks, keep_ids)</div>
<div class="line"><span class="lineno"> 2052</span>      masks_box_begin = tf.stack([0, offset_height, offset_width])</div>
<div class="line"><span class="lineno"> 2053</span>      masks_box_size = tf.stack([-1, target_height, target_width])</div>
<div class="line"><span class="lineno"> 2054</span>      new_masks = tf.slice(masks_inside_window, masks_box_begin, masks_box_size)</div>
<div class="line"><span class="lineno"> 2055</span>      result.append(new_masks)</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2058</span>      keypoints_inside_window = tf.gather(keypoints, keep_ids)</div>
<div class="line"><span class="lineno"> 2059</span>      new_keypoints = keypoint_ops.change_coordinate_frame(</div>
<div class="line"><span class="lineno"> 2060</span>          keypoints_inside_window, im_box)</div>
<div class="line"><span class="lineno"> 2061</span>      <span class="keywordflow">if</span> clip_boxes:</div>
<div class="line"><span class="lineno"> 2062</span>        new_keypoints = keypoint_ops.prune_outside_window(new_keypoints,</div>
<div class="line"><span class="lineno"> 2063</span>                                                          [0.0, 0.0, 1.0, 1.0])</div>
<div class="line"><span class="lineno"> 2064</span>      result.append(new_keypoints)</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 2067</span> </div>
<div class="line"><span class="lineno"> 2068</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,41,300,37,301,42,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="326,69,545,109"/>
<area shape="poly" title=" " alt="" coords="267,69,313,74,312,79,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aed03769aeaaf1e8b96f676996f870e8c_icgraph">
<area shape="rect" title=" " alt="" coords="292,5,553,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="5,5,244,45"/>
<area shape="poly" title=" " alt="" coords="278,28,244,28,244,23,278,23"/>
</map>
</div>

</div>
</div>
<a id="a6b87ac3b4ca959406f78a5e8f2782848" name="a6b87ac3b4ca959406f78a5e8f2782848"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b87ac3b4ca959406f78a5e8f2782848">&#9670;&#160;</a></span>random_distort_color()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_distort_color </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>color_ordering</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly distorts color.

Randomly distorts color using a combination of brightness, hue, contrast and
saturation changes. Makes sure the output image is still between 0 and 255.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  color_ordering: Python int, a type of distortion (valid values: 0, 1).
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.

Raises:
  ValueError: if color_ordering is not in {0, 1}.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01147">1147</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1147</span><span class="keyword">def </span>random_distort_color(image, color_ordering=0, preprocess_vars_cache=None):</div>
<div class="line"><span class="lineno"> 1148</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly distorts color.</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1150</span><span class="stringliteral">  Randomly distorts color using a combination of brightness, hue, contrast </span><span class="keywordflow">and</span></div>
<div class="line"><span class="lineno"> 1151</span>  saturation changes. Makes sure the output image <span class="keywordflow">is</span> still between 0 <span class="keywordflow">and</span> 255.</div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>  Args:</div>
<div class="line"><span class="lineno"> 1154</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1155</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno"> 1156</span>    color_ordering: Python int, a type of distortion (valid values: 0, 1).</div>
<div class="line"><span class="lineno"> 1157</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1158</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1159</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1160</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>  Returns:</div>
<div class="line"><span class="lineno"> 1163</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  Raises:</div>
<div class="line"><span class="lineno"> 1166</span>    ValueError: <span class="keywordflow">if</span> color_ordering <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordflow">in</span> {0, 1}.</div>
<div class="line"><span class="lineno"> 1167</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1168</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomDistortColor&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 1169</span>    <span class="keywordflow">if</span> color_ordering == 0:</div>
<div class="line"><span class="lineno"> 1170</span>      image = random_adjust_brightness(</div>
<div class="line"><span class="lineno"> 1171</span>          image, max_delta=32. / 255.,</div>
<div class="line"><span class="lineno"> 1172</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1173</span>      image = random_adjust_saturation(</div>
<div class="line"><span class="lineno"> 1174</span>          image, min_delta=0.5, max_delta=1.5,</div>
<div class="line"><span class="lineno"> 1175</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1176</span>      image = random_adjust_hue(</div>
<div class="line"><span class="lineno"> 1177</span>          image, max_delta=0.2,</div>
<div class="line"><span class="lineno"> 1178</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1179</span>      image = random_adjust_contrast(</div>
<div class="line"><span class="lineno"> 1180</span>          image, min_delta=0.5, max_delta=1.5,</div>
<div class="line"><span class="lineno"> 1181</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1182</span> </div>
<div class="line"><span class="lineno"> 1183</span>    <span class="keywordflow">elif</span> color_ordering == 1:</div>
<div class="line"><span class="lineno"> 1184</span>      image = random_adjust_brightness(</div>
<div class="line"><span class="lineno"> 1185</span>          image, max_delta=32. / 255.,</div>
<div class="line"><span class="lineno"> 1186</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1187</span>      image = random_adjust_contrast(</div>
<div class="line"><span class="lineno"> 1188</span>          image, min_delta=0.5, max_delta=1.5,</div>
<div class="line"><span class="lineno"> 1189</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1190</span>      image = random_adjust_saturation(</div>
<div class="line"><span class="lineno"> 1191</span>          image, min_delta=0.5, max_delta=1.5,</div>
<div class="line"><span class="lineno"> 1192</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1193</span>      image = random_adjust_hue(</div>
<div class="line"><span class="lineno"> 1194</span>          image, max_delta=0.2,</div>
<div class="line"><span class="lineno"> 1195</span>          preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1196</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 1197</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;color_ordering must be in {0, 1}&#39;</span>)</div>
<div class="line"><span class="lineno"> 1198</span>    <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6b87ac3b4ca959406f78a5e8f2782848_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6b87ac3b4ca959406f78a5e8f2782848_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6b87ac3b4ca959406f78a5e8f2782848_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6b87ac3b4ca959406f78a5e8f2782848_cgraph">
<area shape="rect" title=" " alt="" coords="5,101,267,141"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1a79d5114c3c558ffb325b491e93921a" title=" " alt="" coords="315,133,576,173"/>
<area shape="poly" title=" " alt="" coords="267,132,301,136,301,141,267,138"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a299a97f4d9fc15b96cd138d910b0d4d7" title=" " alt="" coords="315,197,576,237"/>
<area shape="poly" title=" " alt="" coords="189,139,315,183,346,191,344,196,314,188,188,144"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a1840c66a7b36bfefbcf7e2832cdbd881" title=" " alt="" coords="315,5,576,45"/>
<area shape="poly" title=" " alt="" coords="188,99,314,55,344,46,346,51,315,60,189,104"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7fcba6b229393eb466d7163c8b27e36" title=" " alt="" coords="315,69,576,109"/>
<area shape="poly" title=" " alt="" coords="267,105,301,102,301,107,267,110"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="635,69,854,109"/>
<area shape="poly" title=" " alt="" coords="539,131,637,110,638,115,540,136"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="624,133,865,173"/>
<area shape="poly" title=" " alt="" coords="576,151,610,151,610,156,576,156"/>
<area shape="poly" title=" " alt="" coords="552,195,574,183,590,168,598,152,606,135,622,119,632,113,635,118,626,123,610,139,602,155,594,171,578,187,555,200"/>
<area shape="poly" title=" " alt="" coords="539,195,637,174,638,179,540,200"/>
<area shape="poly" title=" " alt="" coords="540,43,638,64,637,69,539,48"/>
<area shape="poly" title=" " alt="" coords="555,43,578,55,594,71,602,88,610,104,626,119,635,125,632,129,622,123,606,107,598,90,590,74,574,59,552,48"/>
<area shape="poly" title=" " alt="" coords="576,87,622,87,622,92,576,92"/>
<area shape="poly" title=" " alt="" coords="540,107,638,128,637,133,539,112"/>
</map>
</div>

</div>
</div>
<a id="a9ad2674a88326abe9a620d33dc6dbaa7" name="a9ad2674a88326abe9a620d33dc6dbaa7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ad2674a88326abe9a620d33dc6dbaa7">&#9670;&#160;</a></span>random_horizontal_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_horizontal_flip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoint_flip_permutation</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly flips the image and detections horizontally.

The probability of flipping the image is 50%.

Args:
  image: rank 3 float32 tensor with shape [height, width, channels].
  boxes: (optional) rank 2 float32 tensor with shape [N, 4]
         containing the bounding boxes.
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  keypoint_flip_permutation: rank 1 int32 tensor containing the keypoint flip
                             permutation.
  seed: random seed
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.

  If boxes, masks, keypoints, and keypoint_flip_permutation are not None,
  the function also returns the following tensors.

  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]

Raises:
  ValueError: if keypoints are provided but keypoint_flip_permutation is not.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00564">564</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  570</span>                           preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  571</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly flips the image and detections horizontally.</span></div>
<div class="line"><span class="lineno">  572</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">  The probability of flipping the image </span><span class="keywordflow">is</span> 50%.</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>  Args:</div>
<div class="line"><span class="lineno">  576</span>    image: rank 3 float32 tensor <span class="keyword">with</span> shape [height, width, channels].</div>
<div class="line"><span class="lineno">  577</span>    boxes: (optional) rank 2 float32 tensor <span class="keyword">with</span> shape [N, 4]</div>
<div class="line"><span class="lineno">  578</span>           containing the bounding boxes.</div>
<div class="line"><span class="lineno">  579</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  580</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  581</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  582</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  583</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno">  584</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno">  585</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  586</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno">  587</span>               normalized coordinates.</div>
<div class="line"><span class="lineno">  588</span>    keypoint_flip_permutation: rank 1 int32 tensor containing the keypoint flip</div>
<div class="line"><span class="lineno">  589</span>                               permutation.</div>
<div class="line"><span class="lineno">  590</span>    seed: random seed</div>
<div class="line"><span class="lineno">  591</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  592</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  593</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  594</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  Returns:</div>
<div class="line"><span class="lineno">  597</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    If boxes, masks, keypoints, <span class="keywordflow">and</span> keypoint_flip_permutation are <span class="keywordflow">not</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  600</span>    the function also returns the following tensors.</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno">  603</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  604</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  605</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno">  606</span>           containing instance masks.</div>
<div class="line"><span class="lineno">  607</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  608</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>  Raises:</div>
<div class="line"><span class="lineno">  611</span>    ValueError: <span class="keywordflow">if</span> keypoints are provided but keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordflow">not</span>.</div>
<div class="line"><span class="lineno">  612</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  613</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  614</span><span class="stringliteral">  </span><span class="keyword">def </span>_flip_image(image):</div>
<div class="line"><span class="lineno">  615</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  616</span>    image_flipped = tf.image.flip_left_right(image)</div>
<div class="line"><span class="lineno">  617</span>    <span class="keywordflow">return</span> image_flipped</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  621</span>        <span class="stringliteral">&#39;keypoints are provided but keypoints_flip_permutation is not provided&#39;</span>)</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomHorizontalFlip&#39;</span>, values=[image, boxes]):</div>
<div class="line"><span class="lineno">  624</span>    result = []</div>
<div class="line"><span class="lineno">  625</span>    <span class="comment"># random variable defining whether to do flip or not</span></div>
<div class="line"><span class="lineno">  626</span>    generator_func = functools.partial(tf.random_uniform, [], seed=seed)</div>
<div class="line"><span class="lineno">  627</span>    do_a_flip_random = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  628</span>        generator_func,</div>
<div class="line"><span class="lineno">  629</span>        preprocessor_cache.PreprocessorCache.HORIZONTAL_FLIP,</div>
<div class="line"><span class="lineno">  630</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  631</span>    do_a_flip_random = tf.greater(do_a_flip_random, 0.5)</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  634</span>    image = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_image(image), <span class="keyword">lambda</span>: image)</div>
<div class="line"><span class="lineno">  635</span>    result.append(image)</div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>    <span class="comment"># flip boxes</span></div>
<div class="line"><span class="lineno">  638</span>    <span class="keywordflow">if</span> boxes <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  639</span>      boxes = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_boxes_left_right(boxes),</div>
<div class="line"><span class="lineno">  640</span>                      <span class="keyword">lambda</span>: boxes)</div>
<div class="line"><span class="lineno">  641</span>      result.append(boxes)</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    <span class="comment"># flip masks</span></div>
<div class="line"><span class="lineno">  644</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  645</span>      masks = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_masks_left_right(masks),</div>
<div class="line"><span class="lineno">  646</span>                      <span class="keyword">lambda</span>: masks)</div>
<div class="line"><span class="lineno">  647</span>      result.append(masks)</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>    <span class="comment"># flip keypoints</span></div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  651</span>      permutation = keypoint_flip_permutation</div>
<div class="line"><span class="lineno">  652</span>      keypoints = tf.cond(</div>
<div class="line"><span class="lineno">  653</span>          do_a_flip_random,</div>
<div class="line"><span class="lineno">  654</span>          <span class="keyword">lambda</span>: keypoint_ops.flip_horizontal(keypoints, 0.5, permutation),</div>
<div class="line"><span class="lineno">  655</span>          <span class="keyword">lambda</span>: keypoints)</div>
<div class="line"><span class="lineno">  656</span>      result.append(keypoints)</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9ad2674a88326abe9a620d33dc6dbaa7_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9ad2674a88326abe9a620d33dc6dbaa7_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9ad2674a88326abe9a620d33dc6dbaa7_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a9ad2674a88326abe9a620d33dc6dbaa7_cgraph">
<area shape="rect" title=" " alt="" coords="5,69,267,109"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a9de9f58390f2e1d905e660c6f3f8b3da" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="230,67,327,46,328,51,231,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aab2ac5f063f9892ff6d043f70b5026e9" title=" " alt="" coords="326,69,545,109"/>
<area shape="poly" title=" " alt="" coords="267,87,312,87,312,92,267,92"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,133,556,173"/>
<area shape="poly" title=" " alt="" coords="231,107,328,128,327,133,230,112"/>
</map>
</div>

</div>
</div>
<a id="adc0c8803b353e7a6795ba372e1a1640a" name="adc0c8803b353e7a6795ba372e1a1640a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc0c8803b353e7a6795ba372e1a1640a">&#9670;&#160;</a></span>random_image_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_image_scale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_scale_ratio</em> = <code>0.5</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_scale_ratio</em> = <code>2.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Scales the image size.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels].
  masks: (optional) rank 3 float32 tensor containing masks with
    size [height, width, num_masks]. The value is set to None if there are no
    masks.
  min_scale_ratio: minimum scaling ratio.
  max_scale_ratio: maximum scaling ratio.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  masks: If masks is not none, resized masks which are the same rank as input
    masks will be returned.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00888">888</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  893</span>                       preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  894</span>  <span class="stringliteral">&quot;&quot;&quot;Scales the image size.</span></div>
<div class="line"><span class="lineno">  895</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  896</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  897</span><span class="stringliteral">    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels].</span></div>
<div class="line"><span class="lineno">  898</span><span class="stringliteral">    masks: (optional) rank 3 float32 tensor containing masks </span><span class="keyword">with</span></div>
<div class="line"><span class="lineno">  899</span>      size [height, width, num_masks]. The value <span class="keywordflow">is</span> set to <span class="keywordtype">None</span> <span class="keywordflow">if</span> there are no</div>
<div class="line"><span class="lineno">  900</span>      masks.</div>
<div class="line"><span class="lineno">  901</span>    min_scale_ratio: minimum scaling ratio.</div>
<div class="line"><span class="lineno">  902</span>    max_scale_ratio: maximum scaling ratio.</div>
<div class="line"><span class="lineno">  903</span>    seed: random seed.</div>
<div class="line"><span class="lineno">  904</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  905</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  906</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  907</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>  Returns:</div>
<div class="line"><span class="lineno">  910</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  911</span>    masks: If masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> none, resized masks which are the same rank <span class="keyword">as</span> input</div>
<div class="line"><span class="lineno">  912</span>      masks will be returned.</div>
<div class="line"><span class="lineno">  913</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  914</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomImageScale&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno">  915</span>    result = []</div>
<div class="line"><span class="lineno">  916</span>    image_shape = tf.shape(image)</div>
<div class="line"><span class="lineno">  917</span>    image_height = image_shape[0]</div>
<div class="line"><span class="lineno">  918</span>    image_width = image_shape[1]</div>
<div class="line"><span class="lineno">  919</span>    generator_func = functools.partial(</div>
<div class="line"><span class="lineno">  920</span>        tf.random_uniform, [],</div>
<div class="line"><span class="lineno">  921</span>        minval=min_scale_ratio, maxval=max_scale_ratio,</div>
<div class="line"><span class="lineno">  922</span>        dtype=tf.float32, seed=seed)</div>
<div class="line"><span class="lineno">  923</span>    size_coef = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  924</span>        generator_func, preprocessor_cache.PreprocessorCache.IMAGE_SCALE,</div>
<div class="line"><span class="lineno">  925</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>    image_newysize = tf.cast(</div>
<div class="line"><span class="lineno">  928</span>        tf.multiply(tf.cast(image_height, dtype=tf.float32), size_coef),</div>
<div class="line"><span class="lineno">  929</span>        dtype=tf.int32)</div>
<div class="line"><span class="lineno">  930</span>    image_newxsize = tf.cast(</div>
<div class="line"><span class="lineno">  931</span>        tf.multiply(tf.cast(image_width, dtype=tf.float32), size_coef),</div>
<div class="line"><span class="lineno">  932</span>        dtype=tf.int32)</div>
<div class="line"><span class="lineno">  933</span>    image = tf.image.resize_images(</div>
<div class="line"><span class="lineno">  934</span>        image, [image_newysize, image_newxsize], align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  935</span>    result.append(image)</div>
<div class="line"><span class="lineno">  936</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  937</span>      masks = tf.image.resize_images(</div>
<div class="line"><span class="lineno">  938</span>          masks, [image_newysize, image_newxsize],</div>
<div class="line"><span class="lineno">  939</span>          method=tf.image.ResizeMethod.NEAREST_NEIGHBOR,</div>
<div class="line"><span class="lineno">  940</span>          align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno">  941</span>      result.append(masks)</div>
<div class="line"><span class="lineno">  942</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_adc0c8803b353e7a6795ba372e1a1640a_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_adc0c8803b353e7a6795ba372e1a1640a_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_adc0c8803b353e7a6795ba372e1a1640a_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_adc0c8803b353e7a6795ba372e1a1640a_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
</map>
</div>

</div>
</div>
<a id="a882986d9b1f998bc17947fce90f1af4d" name="a882986d9b1f998bc17947fce90f1af4d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a882986d9b1f998bc17947fce90f1af4d">&#9670;&#160;</a></span>random_jitter_boxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_jitter_boxes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>ratio</em> = <code>0.05</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly jitter boxes in image.

Args:
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  ratio: The ratio of the box width and height that the corners can jitter.
         For example if the width is 100 pixels and ratio is 0.05,
         the corners can jitter up to 5 pixels in the x direction.
  seed: random seed.

Returns:
  boxes: boxes which is the same shape as input boxes.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01201">1201</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1201</span><span class="keyword">def </span>random_jitter_boxes(boxes, ratio=0.05, seed=None):</div>
<div class="line"><span class="lineno"> 1202</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly jitter boxes in image.</span></div>
<div class="line"><span class="lineno"> 1203</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1204</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 1205</span><span class="stringliteral">    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</span></div>
<div class="line"><span class="lineno"> 1206</span><span class="stringliteral">           Boxes are </span><span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1207</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1208</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1209</span>    ratio: The ratio of the box width <span class="keywordflow">and</span> height that the corners can jitter.</div>
<div class="line"><span class="lineno"> 1210</span>           For example <span class="keywordflow">if</span> the width <span class="keywordflow">is</span> 100 pixels <span class="keywordflow">and</span> ratio <span class="keywordflow">is</span> 0.05,</div>
<div class="line"><span class="lineno"> 1211</span>           the corners can jitter up to 5 pixels <span class="keywordflow">in</span> the x direction.</div>
<div class="line"><span class="lineno"> 1212</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>  Returns:</div>
<div class="line"><span class="lineno"> 1215</span>    boxes: boxes which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 1216</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1217</span><span class="stringliteral">  </span><span class="keyword">def </span>random_jitter_box(box, ratio, seed):</div>
<div class="line"><span class="lineno"> 1218</span>    <span class="stringliteral">&quot;&quot;&quot;Randomly jitter box.</span></div>
<div class="line"><span class="lineno"> 1219</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1220</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno"> 1221</span><span class="stringliteral">      box: bounding box [1, 1, 4].</span></div>
<div class="line"><span class="lineno"> 1222</span><span class="stringliteral">      ratio: max ratio between jittered box </span><span class="keywordflow">and</span> original box,</div>
<div class="line"><span class="lineno"> 1223</span>      a number between [0, 0.5].</div>
<div class="line"><span class="lineno"> 1224</span>      seed: random seed.</div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span>    Returns:</div>
<div class="line"><span class="lineno"> 1227</span>      jittered_box: jittered box.</div>
<div class="line"><span class="lineno"> 1228</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1229</span><span class="stringliteral">    rand_numbers = tf.random_uniform(</span></div>
<div class="line"><span class="lineno"> 1230</span><span class="stringliteral">        [1, 1, 4], minval=-ratio, maxval=ratio, dtype=tf.float32, seed=seed)</span></div>
<div class="line"><span class="lineno"> 1231</span><span class="stringliteral">    box_width = tf.subtract(box[0, 0, 3], box[0, 0, 1])</span></div>
<div class="line"><span class="lineno"> 1232</span><span class="stringliteral">    box_height = tf.subtract(box[0, 0, 2], box[0, 0, 0])</span></div>
<div class="line"><span class="lineno"> 1233</span><span class="stringliteral">    hw_coefs = tf.stack([box_height, box_width, box_height, box_width])</span></div>
<div class="line"><span class="lineno"> 1234</span><span class="stringliteral">    hw_rand_coefs = tf.multiply(hw_coefs, rand_numbers)</span></div>
<div class="line"><span class="lineno"> 1235</span><span class="stringliteral">    jittered_box = tf.add(box, hw_rand_coefs)</span></div>
<div class="line"><span class="lineno"> 1236</span><span class="stringliteral">    jittered_box = tf.clip_by_value(jittered_box, 0.0, 1.0)</span></div>
<div class="line"><span class="lineno"> 1237</span><span class="stringliteral">    </span><span class="keywordflow">return</span> jittered_box</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomJitterBoxes&#39;</span>, values=[boxes]):</div>
<div class="line"><span class="lineno"> 1240</span>    <span class="comment"># boxes are [N, 4]. Lets first make them [N, 1, 1, 4]</span></div>
<div class="line"><span class="lineno"> 1241</span>    boxes_shape = tf.shape(boxes)</div>
<div class="line"><span class="lineno"> 1242</span>    boxes = tf.expand_dims(boxes, 1)</div>
<div class="line"><span class="lineno"> 1243</span>    boxes = tf.expand_dims(boxes, 2)</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>    distorted_boxes = tf.map_fn(</div>
<div class="line"><span class="lineno"> 1246</span>        <span class="keyword">lambda</span> x: random_jitter_box(x, ratio, seed), boxes, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>    distorted_boxes = tf.reshape(distorted_boxes, boxes_shape)</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>    <span class="keywordflow">return</span> distorted_boxes</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a052201bdd4a37a3579ad79d129b0f4dc" name="a052201bdd4a37a3579ad79d129b0f4dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a052201bdd4a37a3579ad79d129b0f4dc">&#9670;&#160;</a></span>random_pad_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_pad_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_image_size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_image_size</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pad_color</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly pads the image.

This function randomly pads the image with zeros. The final size of the
padded image will be between min_image_size and max_image_size.
if min_image_size is smaller than the input image size, min_image_size will
be set to the input image size. The same for max_image_size. The input image
will be located at a uniformly random location inside the padded image.
The relative location of the boxes to the original image will remain the same.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  keypoints: (optional) rank 3 float32 tensor with shape
             [N, num_keypoints, 2]. The keypoints are in y-x normalized
             coordinates.
  min_image_size: a tensor of size [min_height, min_width], type tf.int32.
                  If passed as None, will be set to image size
                  [height, width].
  max_image_size: a tensor of size [max_height, max_width], type tf.int32.
                  If passed as None, will be set to twice the
                  image [height * 2, width * 2].
  pad_color: padding color. A rank 1 tensor of [channels] with dtype=
             tf.float32. if set as None, it will be set to average color of
             the input image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: Image shape will be [new_height, new_width, channels].
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form.

  if keypoints is not None, the function also returns:
  keypoints: rank 3 float32 tensor with shape [N, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l01562">1562</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1569</span>                     preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 1570</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly pads the image.</span></div>
<div class="line"><span class="lineno"> 1571</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 1572</span><span class="stringliteral">  This function randomly pads the image </span><span class="keyword">with</span> zeros. The final size of the</div>
<div class="line"><span class="lineno"> 1573</span>  padded image will be between min_image_size <span class="keywordflow">and</span> max_image_size.</div>
<div class="line"><span class="lineno"> 1574</span>  <span class="keywordflow">if</span> min_image_size <span class="keywordflow">is</span> smaller than the input image size, min_image_size will</div>
<div class="line"><span class="lineno"> 1575</span>  be set to the input image size. The same <span class="keywordflow">for</span> max_image_size. The input image</div>
<div class="line"><span class="lineno"> 1576</span>  will be located at a uniformly random location inside the padded image.</div>
<div class="line"><span class="lineno"> 1577</span>  The relative location of the boxes to the original image will remain the same.</div>
<div class="line"><span class="lineno"> 1578</span> </div>
<div class="line"><span class="lineno"> 1579</span>  Args:</div>
<div class="line"><span class="lineno"> 1580</span>    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 1581</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 1582</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 1583</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 1584</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 1585</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 1586</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 1587</span>               [N, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x normalized</div>
<div class="line"><span class="lineno"> 1588</span>               coordinates.</div>
<div class="line"><span class="lineno"> 1589</span>    min_image_size: a tensor of size [min_height, min_width], type tf.int32.</div>
<div class="line"><span class="lineno"> 1590</span>                    If passed <span class="keyword">as</span> <span class="keywordtype">None</span>, will be set to image size</div>
<div class="line"><span class="lineno"> 1591</span>                    [height, width].</div>
<div class="line"><span class="lineno"> 1592</span>    max_image_size: a tensor of size [max_height, max_width], type tf.int32.</div>
<div class="line"><span class="lineno"> 1593</span>                    If passed <span class="keyword">as</span> <span class="keywordtype">None</span>, will be set to twice the</div>
<div class="line"><span class="lineno"> 1594</span>                    image [height * 2, width * 2].</div>
<div class="line"><span class="lineno"> 1595</span>    pad_color: padding color. A rank 1 tensor of [channels] <span class="keyword">with</span> dtype=</div>
<div class="line"><span class="lineno"> 1596</span>               tf.float32. <span class="keywordflow">if</span> set <span class="keyword">as</span> <span class="keywordtype">None</span>, it will be set to average color of</div>
<div class="line"><span class="lineno"> 1597</span>               the input image.</div>
<div class="line"><span class="lineno"> 1598</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 1599</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 1600</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 1601</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 1602</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 1603</span> </div>
<div class="line"><span class="lineno"> 1604</span>  Returns:</div>
<div class="line"><span class="lineno"> 1605</span>    image: Image shape will be [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 1606</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 1607</span>           form.</div>
<div class="line"><span class="lineno"> 1608</span> </div>
<div class="line"><span class="lineno"> 1609</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also returns:</div>
<div class="line"><span class="lineno"> 1610</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape [N, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 1611</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 1612</span><span class="stringliteral">  </span><span class="keywordflow">if</span> pad_color <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1613</span>    pad_color = tf.reduce_mean(image, axis=[0, 1])</div>
<div class="line"><span class="lineno"> 1614</span> </div>
<div class="line"><span class="lineno"> 1615</span>  image_shape = tf.shape(image)</div>
<div class="line"><span class="lineno"> 1616</span>  image_height = image_shape[0]</div>
<div class="line"><span class="lineno"> 1617</span>  image_width = image_shape[1]</div>
<div class="line"><span class="lineno"> 1618</span> </div>
<div class="line"><span class="lineno"> 1619</span>  <span class="keywordflow">if</span> max_image_size <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1620</span>    max_image_size = tf.stack([image_height * 2, image_width * 2])</div>
<div class="line"><span class="lineno"> 1621</span>  max_image_size = tf.maximum(max_image_size,</div>
<div class="line"><span class="lineno"> 1622</span>                              tf.stack([image_height, image_width]))</div>
<div class="line"><span class="lineno"> 1623</span> </div>
<div class="line"><span class="lineno"> 1624</span>  <span class="keywordflow">if</span> min_image_size <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1625</span>    min_image_size = tf.stack([image_height, image_width])</div>
<div class="line"><span class="lineno"> 1626</span>  min_image_size = tf.maximum(min_image_size,</div>
<div class="line"><span class="lineno"> 1627</span>                              tf.stack([image_height, image_width]))</div>
<div class="line"><span class="lineno"> 1628</span> </div>
<div class="line"><span class="lineno"> 1629</span>  target_height = tf.cond(</div>
<div class="line"><span class="lineno"> 1630</span>      max_image_size[0] &gt; min_image_size[0],</div>
<div class="line"><span class="lineno"> 1631</span>      <span class="keyword">lambda</span>: _random_integer(min_image_size[0], max_image_size[0], seed),</div>
<div class="line"><span class="lineno"> 1632</span>      <span class="keyword">lambda</span>: max_image_size[0])</div>
<div class="line"><span class="lineno"> 1633</span> </div>
<div class="line"><span class="lineno"> 1634</span>  target_width = tf.cond(</div>
<div class="line"><span class="lineno"> 1635</span>      max_image_size[1] &gt; min_image_size[1],</div>
<div class="line"><span class="lineno"> 1636</span>      <span class="keyword">lambda</span>: _random_integer(min_image_size[1], max_image_size[1], seed),</div>
<div class="line"><span class="lineno"> 1637</span>      <span class="keyword">lambda</span>: max_image_size[1])</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>  offset_height = tf.cond(</div>
<div class="line"><span class="lineno"> 1640</span>      target_height &gt; image_height,</div>
<div class="line"><span class="lineno"> 1641</span>      <span class="keyword">lambda</span>: _random_integer(0, target_height - image_height, seed),</div>
<div class="line"><span class="lineno"> 1642</span>      <span class="keyword">lambda</span>: tf.constant(0, dtype=tf.int32))</div>
<div class="line"><span class="lineno"> 1643</span> </div>
<div class="line"><span class="lineno"> 1644</span>  offset_width = tf.cond(</div>
<div class="line"><span class="lineno"> 1645</span>      target_width &gt; image_width,</div>
<div class="line"><span class="lineno"> 1646</span>      <span class="keyword">lambda</span>: _random_integer(0, target_width - image_width, seed),</div>
<div class="line"><span class="lineno"> 1647</span>      <span class="keyword">lambda</span>: tf.constant(0, dtype=tf.int32))</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>  gen_func = <span class="keyword">lambda</span>: (target_height, target_width, offset_height, offset_width)</div>
<div class="line"><span class="lineno"> 1650</span>  params = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 1651</span>      gen_func, preprocessor_cache.PreprocessorCache.PAD_IMAGE,</div>
<div class="line"><span class="lineno"> 1652</span>      preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 1653</span>  target_height, target_width, offset_height, offset_width = params</div>
<div class="line"><span class="lineno"> 1654</span> </div>
<div class="line"><span class="lineno"> 1655</span>  new_image = tf.image.pad_to_bounding_box(</div>
<div class="line"><span class="lineno"> 1656</span>      image,</div>
<div class="line"><span class="lineno"> 1657</span>      offset_height=offset_height,</div>
<div class="line"><span class="lineno"> 1658</span>      offset_width=offset_width,</div>
<div class="line"><span class="lineno"> 1659</span>      target_height=target_height,</div>
<div class="line"><span class="lineno"> 1660</span>      target_width=target_width)</div>
<div class="line"><span class="lineno"> 1661</span> </div>
<div class="line"><span class="lineno"> 1662</span>  <span class="comment"># Setting color of the padded pixels</span></div>
<div class="line"><span class="lineno"> 1663</span>  image_ones = tf.ones_like(image)</div>
<div class="line"><span class="lineno"> 1664</span>  image_ones_padded = tf.image.pad_to_bounding_box(</div>
<div class="line"><span class="lineno"> 1665</span>      image_ones,</div>
<div class="line"><span class="lineno"> 1666</span>      offset_height=offset_height,</div>
<div class="line"><span class="lineno"> 1667</span>      offset_width=offset_width,</div>
<div class="line"><span class="lineno"> 1668</span>      target_height=target_height,</div>
<div class="line"><span class="lineno"> 1669</span>      target_width=target_width)</div>
<div class="line"><span class="lineno"> 1670</span>  image_color_padded = (1.0 - image_ones_padded) * pad_color</div>
<div class="line"><span class="lineno"> 1671</span>  new_image += image_color_padded</div>
<div class="line"><span class="lineno"> 1672</span> </div>
<div class="line"><span class="lineno"> 1673</span>  <span class="comment"># setting boxes</span></div>
<div class="line"><span class="lineno"> 1674</span>  new_window = tf.cast(</div>
<div class="line"><span class="lineno"> 1675</span>      tf.stack([</div>
<div class="line"><span class="lineno"> 1676</span>          -offset_height, -offset_width, target_height - offset_height,</div>
<div class="line"><span class="lineno"> 1677</span>          target_width - offset_width</div>
<div class="line"><span class="lineno"> 1678</span>      ]),</div>
<div class="line"><span class="lineno"> 1679</span>      dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 1680</span>  new_window /= tf.cast(</div>
<div class="line"><span class="lineno"> 1681</span>      tf.stack([image_height, image_width, image_height, image_width]),</div>
<div class="line"><span class="lineno"> 1682</span>      dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 1683</span>  boxlist = box_list.BoxList(boxes)</div>
<div class="line"><span class="lineno"> 1684</span>  new_boxlist = box_list_ops.change_coordinate_frame(boxlist, new_window)</div>
<div class="line"><span class="lineno"> 1685</span>  new_boxes = new_boxlist.get()</div>
<div class="line"><span class="lineno"> 1686</span> </div>
<div class="line"><span class="lineno"> 1687</span>  result = [new_image, new_boxes]</div>
<div class="line"><span class="lineno"> 1688</span> </div>
<div class="line"><span class="lineno"> 1689</span>  <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 1690</span>    new_keypoints = keypoint_ops.change_coordinate_frame(keypoints, new_window)</div>
<div class="line"><span class="lineno"> 1691</span>    result.append(new_keypoints)</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>  <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 1694</span> </div>
<div class="line"><span class="lineno"> 1695</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_cgraph">
<area shape="rect" title=" " alt="" coords="5,37,267,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,41,300,37,301,42,267,46"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="326,69,545,109"/>
<area shape="poly" title=" " alt="" coords="267,69,313,74,312,79,267,74"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a052201bdd4a37a3579ad79d129b0f4dc_icgraph">
<area shape="rect" title=" " alt="" coords="601,37,863,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3abbb64d99b25decfe25fec40a92a6b9" title=" " alt="" coords="292,5,553,45"/>
<area shape="poly" title=" " alt="" coords="587,45,553,42,554,36,588,40"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="292,69,553,109"/>
<area shape="poly" title=" " alt="" coords="588,75,554,78,553,73,587,70"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6141ebcaa14a24e9903a50821b45b576" title=" " alt="" coords="5,69,244,109"/>
<area shape="poly" title=" " alt="" coords="278,92,244,92,244,87,278,87"/>
</map>
</div>

</div>
</div>
<a id="ab0a1f9342a5127f9b80e0ffdfe94fc59" name="ab0a1f9342a5127f9b80e0ffdfe94fc59"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab0a1f9342a5127f9b80e0ffdfe94fc59">&#9670;&#160;</a></span>random_pad_to_aspect_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_pad_to_aspect_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_padded_size_ratio</em> = <code>(1.0,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_padded_size_ratio</em> = <code>(2.0,&#160;2.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly zero pads an image to the specified aspect ratio.

Pads the image so that the resulting image will have the specified aspect
ratio without scaling less than the min_padded_size_ratio or more than the
max_padded_size_ratio. If the min_padded_size_ratio or max_padded_size_ratio
is lower than what is possible to maintain the aspect ratio, then this method
will use the least padding to achieve the specified aspect ratio.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  aspect_ratio: aspect ratio of the final image.
  min_padded_size_ratio: min ratio of padded image height and width to the
                         input image's height and width.
  max_padded_size_ratio: max ratio of padded image height and width to the
                         input image's height and width.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If masks, or keypoints is not None, the function also returns:
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]

Raises:
  ValueError: If image is not a 3D tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02069">2069</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2077</span>                               preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2078</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly zero pads an image to the specified aspect ratio.</span></div>
<div class="line"><span class="lineno"> 2079</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2080</span><span class="stringliteral">  Pads the image so that the resulting image will have the specified aspect</span></div>
<div class="line"><span class="lineno"> 2081</span><span class="stringliteral">  ratio without scaling less than the min_padded_size_ratio </span><span class="keywordflow">or</span> more than the</div>
<div class="line"><span class="lineno"> 2082</span>  max_padded_size_ratio. If the min_padded_size_ratio <span class="keywordflow">or</span> max_padded_size_ratio</div>
<div class="line"><span class="lineno"> 2083</span>  <span class="keywordflow">is</span> lower than what <span class="keywordflow">is</span> possible to maintain the aspect ratio, then this method</div>
<div class="line"><span class="lineno"> 2084</span>  will use the least padding to achieve the specified aspect ratio.</div>
<div class="line"><span class="lineno"> 2085</span> </div>
<div class="line"><span class="lineno"> 2086</span>  Args:</div>
<div class="line"><span class="lineno"> 2087</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 2088</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 2089</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 2090</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 2091</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 2092</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 2093</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2094</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 2095</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 2096</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2097</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 2098</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 2099</span>    aspect_ratio: aspect ratio of the final image.</div>
<div class="line"><span class="lineno"> 2100</span>    min_padded_size_ratio: min ratio of padded image height <span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 2101</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 2102</span><span class="stringliteral">    max_padded_size_ratio: max ratio of padded image height </span><span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 2103</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 2104</span><span class="stringliteral">    seed: random seed.</span></div>
<div class="line"><span class="lineno"> 2105</span><span class="stringliteral">    preprocess_vars_cache: PreprocessorCache object that records previously</span></div>
<div class="line"><span class="lineno"> 2106</span><span class="stringliteral">                           performed augmentations. Updated </span><span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 2107</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 2108</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 2109</span> </div>
<div class="line"><span class="lineno"> 2110</span>  Returns:</div>
<div class="line"><span class="lineno"> 2111</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 2112</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 2113</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 2114</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 2115</span> </div>
<div class="line"><span class="lineno"> 2116</span>    If masks, <span class="keywordflow">or</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also returns:</div>
<div class="line"><span class="lineno"> 2117</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 2118</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 2119</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2120</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 2121</span> </div>
<div class="line"><span class="lineno"> 2122</span>  Raises:</div>
<div class="line"><span class="lineno"> 2123</span>    ValueError: If image <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 3D tensor.</div>
<div class="line"><span class="lineno"> 2124</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2125</span><span class="stringliteral">  </span><span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 2126</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Image should be 3D tensor&#39;</span>)</div>
<div class="line"><span class="lineno"> 2127</span> </div>
<div class="line"><span class="lineno"> 2128</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomPadToAspectRatio&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno"> 2129</span>    image_shape = tf.shape(image)</div>
<div class="line"><span class="lineno"> 2130</span>    image_height = tf.cast(image_shape[0], dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2131</span>    image_width = tf.cast(image_shape[1], dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2132</span>    image_aspect_ratio = image_width / image_height</div>
<div class="line"><span class="lineno"> 2133</span>    new_aspect_ratio = tf.constant(aspect_ratio, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2134</span>    target_height = tf.cond(</div>
<div class="line"><span class="lineno"> 2135</span>        image_aspect_ratio &lt;= new_aspect_ratio,</div>
<div class="line"><span class="lineno"> 2136</span>        <span class="keyword">lambda</span>: image_height,</div>
<div class="line"><span class="lineno"> 2137</span>        <span class="keyword">lambda</span>: image_width / new_aspect_ratio)</div>
<div class="line"><span class="lineno"> 2138</span>    target_width = tf.cond(</div>
<div class="line"><span class="lineno"> 2139</span>        image_aspect_ratio &gt;= new_aspect_ratio,</div>
<div class="line"><span class="lineno"> 2140</span>        <span class="keyword">lambda</span>: image_width,</div>
<div class="line"><span class="lineno"> 2141</span>        <span class="keyword">lambda</span>: image_height * new_aspect_ratio)</div>
<div class="line"><span class="lineno"> 2142</span> </div>
<div class="line"><span class="lineno"> 2143</span>    min_height = tf.maximum(</div>
<div class="line"><span class="lineno"> 2144</span>        min_padded_size_ratio[0] * image_height, target_height)</div>
<div class="line"><span class="lineno"> 2145</span>    min_width = tf.maximum(</div>
<div class="line"><span class="lineno"> 2146</span>        min_padded_size_ratio[1] * image_width, target_width)</div>
<div class="line"><span class="lineno"> 2147</span>    max_height = tf.maximum(</div>
<div class="line"><span class="lineno"> 2148</span>        max_padded_size_ratio[0] * image_height, target_height)</div>
<div class="line"><span class="lineno"> 2149</span>    max_width = tf.maximum(</div>
<div class="line"><span class="lineno"> 2150</span>        max_padded_size_ratio[1] * image_width, target_width)</div>
<div class="line"><span class="lineno"> 2151</span> </div>
<div class="line"><span class="lineno"> 2152</span>    max_scale = tf.minimum(max_height / target_height, max_width / target_width)</div>
<div class="line"><span class="lineno"> 2153</span>    min_scale = tf.minimum(</div>
<div class="line"><span class="lineno"> 2154</span>        max_scale,</div>
<div class="line"><span class="lineno"> 2155</span>        tf.maximum(min_height / target_height, min_width / target_width))</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span>    generator_func = functools.partial(tf.random_uniform, [],</div>
<div class="line"><span class="lineno"> 2158</span>                                       min_scale, max_scale, seed=seed)</div>
<div class="line"><span class="lineno"> 2159</span>    scale = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 2160</span>        generator_func,</div>
<div class="line"><span class="lineno"> 2161</span>        preprocessor_cache.PreprocessorCache.PAD_TO_ASPECT_RATIO,</div>
<div class="line"><span class="lineno"> 2162</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 2163</span> </div>
<div class="line"><span class="lineno"> 2164</span>    target_height = tf.round(scale * target_height)</div>
<div class="line"><span class="lineno"> 2165</span>    target_width = tf.round(scale * target_width)</div>
<div class="line"><span class="lineno"> 2166</span> </div>
<div class="line"><span class="lineno"> 2167</span>    new_image = tf.image.pad_to_bounding_box(</div>
<div class="line"><span class="lineno"> 2168</span>        image, 0, 0, tf.cast(target_height, dtype=tf.int32),</div>
<div class="line"><span class="lineno"> 2169</span>        tf.cast(target_width, dtype=tf.int32))</div>
<div class="line"><span class="lineno"> 2170</span> </div>
<div class="line"><span class="lineno"> 2171</span>    im_box = tf.stack([</div>
<div class="line"><span class="lineno"> 2172</span>        0.0,</div>
<div class="line"><span class="lineno"> 2173</span>        0.0,</div>
<div class="line"><span class="lineno"> 2174</span>        target_height / image_height,</div>
<div class="line"><span class="lineno"> 2175</span>        target_width / image_width</div>
<div class="line"><span class="lineno"> 2176</span>    ])</div>
<div class="line"><span class="lineno"> 2177</span>    boxlist = box_list.BoxList(boxes)</div>
<div class="line"><span class="lineno"> 2178</span>    new_boxlist = box_list_ops.change_coordinate_frame(boxlist, im_box)</div>
<div class="line"><span class="lineno"> 2179</span>    new_boxes = new_boxlist.get()</div>
<div class="line"><span class="lineno"> 2180</span> </div>
<div class="line"><span class="lineno"> 2181</span>    result = [new_image, new_boxes]</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2184</span>      new_masks = tf.expand_dims(masks, -1)</div>
<div class="line"><span class="lineno"> 2185</span>      new_masks = tf.image.pad_to_bounding_box(</div>
<div class="line"><span class="lineno"> 2186</span>          new_masks, 0, 0, tf.cast(target_height, dtype=tf.int32),</div>
<div class="line"><span class="lineno"> 2187</span>          tf.cast(target_width, dtype=tf.int32))</div>
<div class="line"><span class="lineno"> 2188</span>      new_masks = tf.squeeze(new_masks, [-1])</div>
<div class="line"><span class="lineno"> 2189</span>      result.append(new_masks)</div>
<div class="line"><span class="lineno"> 2190</span> </div>
<div class="line"><span class="lineno"> 2191</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2192</span>      new_keypoints = keypoint_ops.change_coordinate_frame(keypoints, im_box)</div>
<div class="line"><span class="lineno"> 2193</span>      result.append(new_keypoints)</div>
<div class="line"><span class="lineno"> 2194</span> </div>
<div class="line"><span class="lineno"> 2195</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ab0a1f9342a5127f9b80e0ffdfe94fc59_icgraph">
<area shape="rect" title=" " alt="" coords="297,5,559,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,5,249,45"/>
<area shape="poly" title=" " alt="" coords="284,28,249,28,249,23,284,23"/>
</map>
</div>

</div>
</div>
<a id="a8d0c42728a0663d83a70ed01f309c393" name="a8d0c42728a0663d83a70ed01f309c393"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d0c42728a0663d83a70ed01f309c393">&#9670;&#160;</a></span>random_pixel_value_scale()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_pixel_value_scale </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>minval</em> = <code>0.9</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>maxval</em> = <code>1.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Scales each value in the pixels of the image.

   This function scales each pixel independent of the other ones.
   For each value in image tensor, draws a random number between
   minval and maxval and multiples the values with them.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  minval: lower ratio of scaling pixel values.
  maxval: upper ratio of scaling pixel values.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00847">847</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  851</span>                             preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  852</span>  <span class="stringliteral">&quot;&quot;&quot;Scales each value in the pixels of the image.</span></div>
<div class="line"><span class="lineno">  853</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  854</span><span class="stringliteral">     This function scales each pixel independent of the other ones.</span></div>
<div class="line"><span class="lineno">  855</span><span class="stringliteral">     For each value </span><span class="keywordflow">in</span> image tensor, draws a random number between</div>
<div class="line"><span class="lineno">  856</span>     minval <span class="keywordflow">and</span> maxval <span class="keywordflow">and</span> multiples the values <span class="keyword">with</span> them.</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>  Args:</div>
<div class="line"><span class="lineno">  859</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno">  860</span>           <span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno">  861</span>    minval: lower ratio of scaling pixel values.</div>
<div class="line"><span class="lineno">  862</span>    maxval: upper ratio of scaling pixel values.</div>
<div class="line"><span class="lineno">  863</span>    seed: random seed.</div>
<div class="line"><span class="lineno">  864</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  865</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  866</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  867</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span>  Returns:</div>
<div class="line"><span class="lineno">  870</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  871</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  872</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomPixelValueScale&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno">  873</span>    generator_func = functools.partial(</div>
<div class="line"><span class="lineno">  874</span>        tf.random_uniform, tf.shape(image),</div>
<div class="line"><span class="lineno">  875</span>        minval=minval, maxval=maxval,</div>
<div class="line"><span class="lineno">  876</span>        dtype=tf.float32, seed=seed)</div>
<div class="line"><span class="lineno">  877</span>    color_coef = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  878</span>        generator_func,</div>
<div class="line"><span class="lineno">  879</span>        preprocessor_cache.PreprocessorCache.PIXEL_VALUE_SCALE,</div>
<div class="line"><span class="lineno">  880</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  881</span> </div>
<div class="line"><span class="lineno">  882</span>    image = tf.multiply(image, color_coef)</div>
<div class="line"><span class="lineno">  883</span>    image = tf.clip_by_value(image, 0.0, 255.0)</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>  <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8d0c42728a0663d83a70ed01f309c393_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8d0c42728a0663d83a70ed01f309c393_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8d0c42728a0663d83a70ed01f309c393_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a8d0c42728a0663d83a70ed01f309c393_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
</map>
</div>

</div>
</div>
<a id="a06cc1c1f5cce3566bc6f1a4a865b613e" name="a06cc1c1f5cce3566bc6f1a4a865b613e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a06cc1c1f5cce3566bc6f1a4a865b613e">&#9670;&#160;</a></span>random_resize_method()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_resize_method </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>target_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Uses a random resize method to resize the image to target size.

Args:
  image: a rank 3 tensor.
  target_size: a list of [target_height, target_width]
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  resized image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02332">2332</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2332</span><span class="keyword">def </span>random_resize_method(image, target_size, preprocess_vars_cache=None):</div>
<div class="line"><span class="lineno"> 2333</span>  <span class="stringliteral">&quot;&quot;&quot;Uses a random resize method to resize the image to target size.</span></div>
<div class="line"><span class="lineno"> 2334</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2335</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2336</span><span class="stringliteral">    image: a rank 3 tensor.</span></div>
<div class="line"><span class="lineno"> 2337</span><span class="stringliteral">    target_size: a list of [target_height, target_width]</span></div>
<div class="line"><span class="lineno"> 2338</span><span class="stringliteral">    preprocess_vars_cache: PreprocessorCache object that records previously</span></div>
<div class="line"><span class="lineno"> 2339</span><span class="stringliteral">                           performed augmentations. Updated </span><span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 2340</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 2341</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 2342</span> </div>
<div class="line"><span class="lineno"> 2343</span>  Returns:</div>
<div class="line"><span class="lineno"> 2344</span>    resized image.</div>
<div class="line"><span class="lineno"> 2345</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2346</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2347</span><span class="stringliteral">  resized_image = _apply_with_random_selector(</span></div>
<div class="line"><span class="lineno"> 2348</span><span class="stringliteral">      image,</span></div>
<div class="line"><span class="lineno"> 2349</span><span class="stringliteral">      </span><span class="keyword">lambda</span> x, method: tf.image.resize_images(x, target_size, method),</div>
<div class="line"><span class="lineno"> 2350</span>      num_cases=4,</div>
<div class="line"><span class="lineno"> 2351</span>      preprocess_vars_cache=preprocess_vars_cache,</div>
<div class="line"><span class="lineno"> 2352</span>      key=preprocessor_cache.PreprocessorCache.RESIZE_METHOD)</div>
<div class="line"><span class="lineno"> 2353</span> </div>
<div class="line"><span class="lineno"> 2354</span>  <span class="keywordflow">return</span> resized_image</div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a06cc1c1f5cce3566bc6f1a4a865b613e_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a06cc1c1f5cce3566bc6f1a4a865b613e_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a06cc1c1f5cce3566bc6f1a4a865b613e_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a06cc1c1f5cce3566bc6f1a4a865b613e_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a72948ea20f73ededa0777968bb83c27f" title=" " alt="" coords="315,5,533,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="581,5,823,45"/>
<area shape="poly" title=" " alt="" coords="533,23,568,23,568,28,533,28"/>
</map>
</div>

</div>
</div>
<a id="a643bc2872b76f353d6f342b56070c112" name="a643bc2872b76f353d6f342b56070c112"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643bc2872b76f353d6f342b56070c112">&#9670;&#160;</a></span>random_rgb_to_gray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_rgb_to_gray </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>probability</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Changes the image from RGB to Grayscale with the given probability.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 255].
  probability: the probability of returning a grayscale image.
          The probability should be a number between [0, 1].
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00953">953</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  956</span>                       preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  957</span>  <span class="stringliteral">&quot;&quot;&quot;Changes the image from RGB to Grayscale with the given probability.</span></div>
<div class="line"><span class="lineno">  958</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  959</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  960</span><span class="stringliteral">    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</span></div>
<div class="line"><span class="lineno">  961</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 255].</div>
<div class="line"><span class="lineno">  962</span>    probability: the probability of returning a grayscale image.</div>
<div class="line"><span class="lineno">  963</span>            The probability should be a number between [0, 1].</div>
<div class="line"><span class="lineno">  964</span>    seed: random seed.</div>
<div class="line"><span class="lineno">  965</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  966</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  967</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  968</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>  Returns:</div>
<div class="line"><span class="lineno">  971</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  972</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  973</span><span class="stringliteral">  </span><span class="keyword">def </span>_image_to_gray(image):</div>
<div class="line"><span class="lineno">  974</span>    image_gray1 = _rgb_to_grayscale(image)</div>
<div class="line"><span class="lineno">  975</span>    image_gray3 = tf.image.grayscale_to_rgb(image_gray1)</div>
<div class="line"><span class="lineno">  976</span>    <span class="keywordflow">return</span> image_gray3</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomRGBtoGray&#39;</span>, values=[image]):</div>
<div class="line"><span class="lineno">  979</span>    <span class="comment"># random variable defining whether to change to grayscale or not</span></div>
<div class="line"><span class="lineno">  980</span>    generator_func = functools.partial(tf.random_uniform, [], seed=seed)</div>
<div class="line"><span class="lineno">  981</span>    do_gray_random = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  982</span>        generator_func, preprocessor_cache.PreprocessorCache.RGB_TO_GRAY,</div>
<div class="line"><span class="lineno">  983</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>    image = tf.cond(</div>
<div class="line"><span class="lineno">  986</span>        tf.greater(do_gray_random, probability), <span class="keyword">lambda</span>: image,</div>
<div class="line"><span class="lineno">  987</span>        <span class="keyword">lambda</span>: _augment_only_rgb_channels(image, _image_to_gray))</div>
<div class="line"><span class="lineno">  988</span> </div>
<div class="line"><span class="lineno">  989</span>  <span class="keywordflow">return</span> image</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a643bc2872b76f353d6f342b56070c112_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a643bc2872b76f353d6f342b56070c112_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a643bc2872b76f353d6f342b56070c112_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a643bc2872b76f353d6f342b56070c112_cgraph">
<area shape="rect" title=" " alt="" coords="5,69,267,109"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a0f844301a276e66ee5b6443f5ea4594b" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="230,67,327,46,328,51,231,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,69,556,109"/>
<area shape="poly" title=" " alt="" coords="267,87,301,87,301,92,267,92"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a21e6f1c05910c4acb3c33771326514b5" title=" " alt="" coords="326,133,545,173"/>
<area shape="poly" title=" " alt="" coords="231,107,328,128,327,133,230,112"/>
</map>
</div>

</div>
</div>
<a id="a29eea225a5c9bad4c280532e7e51d401" name="a29eea225a5c9bad4c280532e7e51d401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29eea225a5c9bad4c280532e7e51d401">&#9670;&#160;</a></span>random_rotation90()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_rotation90 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly rotates the image and detections 90 degrees counter-clockwise.

The probability of rotating the image is 50%. This can be combined with
random_horizontal_flip and random_vertical_flip to produce an output with a
uniform distribution of the eight possible 90 degree rotation / reflection
combinations.

Args:
  image: rank 3 float32 tensor with shape [height, width, channels].
  boxes: (optional) rank 2 float32 tensor with shape [N, 4]
         containing the bounding boxes.
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  seed: random seed
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.

  If boxes, masks, and keypoints, are not None,
  the function also returns the following tensors.

  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00757">757</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  762</span>                      preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  763</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly rotates the image and detections 90 degrees counter-clockwise.</span></div>
<div class="line"><span class="lineno">  764</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  765</span><span class="stringliteral">  The probability of rotating the image </span><span class="keywordflow">is</span> 50%. This can be combined <span class="keyword">with</span></div>
<div class="line"><span class="lineno">  766</span>  random_horizontal_flip <span class="keywordflow">and</span> random_vertical_flip to produce an output <span class="keyword">with</span> a</div>
<div class="line"><span class="lineno">  767</span>  uniform distribution of the eight possible 90 degree rotation / reflection</div>
<div class="line"><span class="lineno">  768</span>  combinations.</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>  Args:</div>
<div class="line"><span class="lineno">  771</span>    image: rank 3 float32 tensor <span class="keyword">with</span> shape [height, width, channels].</div>
<div class="line"><span class="lineno">  772</span>    boxes: (optional) rank 2 float32 tensor <span class="keyword">with</span> shape [N, 4]</div>
<div class="line"><span class="lineno">  773</span>           containing the bounding boxes.</div>
<div class="line"><span class="lineno">  774</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  775</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  776</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  777</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  778</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno">  779</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno">  780</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  781</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno">  782</span>               normalized coordinates.</div>
<div class="line"><span class="lineno">  783</span>    seed: random seed</div>
<div class="line"><span class="lineno">  784</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  785</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  786</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  787</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  788</span> </div>
<div class="line"><span class="lineno">  789</span>  Returns:</div>
<div class="line"><span class="lineno">  790</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>    If boxes, masks, <span class="keywordflow">and</span> keypoints, are <span class="keywordflow">not</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  793</span>    the function also returns the following tensors.</div>
<div class="line"><span class="lineno">  794</span> </div>
<div class="line"><span class="lineno">  795</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno">  796</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  797</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  798</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno">  799</span>           containing instance masks.</div>
<div class="line"><span class="lineno">  800</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  801</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno">  802</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  803</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  804</span><span class="stringliteral">  </span><span class="keyword">def </span>_rot90_image(image):</div>
<div class="line"><span class="lineno">  805</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  806</span>    image_rotated = tf.image.rot90(image)</div>
<div class="line"><span class="lineno">  807</span>    <span class="keywordflow">return</span> image_rotated</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomRotation90&#39;</span>, values=[image, boxes]):</div>
<div class="line"><span class="lineno">  810</span>    result = []</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>    <span class="comment"># random variable defining whether to rotate by 90 degrees or not</span></div>
<div class="line"><span class="lineno">  813</span>    generator_func = functools.partial(tf.random_uniform, [], seed=seed)</div>
<div class="line"><span class="lineno">  814</span>    do_a_rot90_random = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  815</span>        generator_func, preprocessor_cache.PreprocessorCache.ROTATION90,</div>
<div class="line"><span class="lineno">  816</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  817</span>    do_a_rot90_random = tf.greater(do_a_rot90_random, 0.5)</div>
<div class="line"><span class="lineno">  818</span> </div>
<div class="line"><span class="lineno">  819</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  820</span>    image = tf.cond(do_a_rot90_random, <span class="keyword">lambda</span>: _rot90_image(image),</div>
<div class="line"><span class="lineno">  821</span>                    <span class="keyword">lambda</span>: image)</div>
<div class="line"><span class="lineno">  822</span>    result.append(image)</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>    <span class="comment"># flip boxes</span></div>
<div class="line"><span class="lineno">  825</span>    <span class="keywordflow">if</span> boxes <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  826</span>      boxes = tf.cond(do_a_rot90_random, <span class="keyword">lambda</span>: _rot90_boxes(boxes),</div>
<div class="line"><span class="lineno">  827</span>                      <span class="keyword">lambda</span>: boxes)</div>
<div class="line"><span class="lineno">  828</span>      result.append(boxes)</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>    <span class="comment"># flip masks</span></div>
<div class="line"><span class="lineno">  831</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  832</span>      masks = tf.cond(do_a_rot90_random, <span class="keyword">lambda</span>: _rot90_masks(masks),</div>
<div class="line"><span class="lineno">  833</span>                      <span class="keyword">lambda</span>: masks)</div>
<div class="line"><span class="lineno">  834</span>      result.append(masks)</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>    <span class="comment"># flip keypoints</span></div>
<div class="line"><span class="lineno">  837</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  838</span>      keypoints = tf.cond(</div>
<div class="line"><span class="lineno">  839</span>          do_a_rot90_random,</div>
<div class="line"><span class="lineno">  840</span>          <span class="keyword">lambda</span>: keypoint_ops.rot90(keypoints),</div>
<div class="line"><span class="lineno">  841</span>          <span class="keyword">lambda</span>: keypoints)</div>
<div class="line"><span class="lineno">  842</span>      result.append(keypoints)</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a29eea225a5c9bad4c280532e7e51d401_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a29eea225a5c9bad4c280532e7e51d401_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a29eea225a5c9bad4c280532e7e51d401_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a29eea225a5c9bad4c280532e7e51d401_cgraph">
<area shape="rect" title=" " alt="" coords="5,69,267,109"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="230,67,327,46,328,51,231,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a5ed6539fa8576bc65e30e46a3f030140" title=" " alt="" coords="326,69,545,109"/>
<area shape="poly" title=" " alt="" coords="267,87,312,87,312,92,267,92"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad4f95650b0d5024695ff3d9e18284e3c" title=" " alt="" coords="326,133,545,173"/>
<area shape="poly" title=" " alt="" coords="231,107,328,128,327,133,230,112"/>
</map>
</div>

</div>
</div>
<a id="a28ed9f2cfed49a54b767a131fb3e7cde" name="a28ed9f2cfed49a54b767a131fb3e7cde"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a28ed9f2cfed49a54b767a131fb3e7cde">&#9670;&#160;</a></span>random_self_concat_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_self_concat_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>concat_vertical_probability</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>concat_horizontal_probability</em> = <code>0.1</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly concatenates the image with itself.

This function randomly concatenates the image with itself; the random
variables for vertical and horizontal concatenation are independent.
Afterwards, we adjust the old bounding boxes, and add new bounding boxes
for the new objects.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: rank 1 float32 containing the label weights.
  label_confidences: (optional) rank 1 float32 containing the label
                     confidences.
  multiclass_scores: (optional) float32 tensor of shape
                     [num_instances, num_classes] representing the score for
                     each box for each class.
  concat_vertical_probability: (optional) a tf.float32 scalar denoting the
                               probability of a vertical concatenation.
  concat_horizontal_probability: (optional) a tf.float32 scalar denoting the
                                 probability of a horizontal concatenation.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: Image shape will be [new_height, new_width, channels].
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form.
  if label_confidences is not None also returns:
  maybe_concat_label_confidences: cropped label weights.
  if multiclass_scores is not None also returns:
  maybe_concat_multiclass_scores: cropped_multiclass_scores.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02750">2750</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2754</span>    preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2755</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly concatenates the image with itself.</span></div>
<div class="line"><span class="lineno"> 2756</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2757</span><span class="stringliteral">  This function randomly concatenates the image </span><span class="keyword">with</span> itself; the random</div>
<div class="line"><span class="lineno"> 2758</span>  variables <span class="keywordflow">for</span> vertical <span class="keywordflow">and</span> horizontal concatenation are independent.</div>
<div class="line"><span class="lineno"> 2759</span>  Afterwards, we adjust the old bounding boxes, <span class="keywordflow">and</span> add new bounding boxes</div>
<div class="line"><span class="lineno"> 2760</span>  <span class="keywordflow">for</span> the new objects.</div>
<div class="line"><span class="lineno"> 2761</span> </div>
<div class="line"><span class="lineno"> 2762</span>  Args:</div>
<div class="line"><span class="lineno"> 2763</span>    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 2764</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 2765</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 2766</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 2767</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 2768</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 2769</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 2770</span>    label_weights: rank 1 float32 containing the label weights.</div>
<div class="line"><span class="lineno"> 2771</span>    label_confidences: (optional) rank 1 float32 containing the label</div>
<div class="line"><span class="lineno"> 2772</span>                       confidences.</div>
<div class="line"><span class="lineno"> 2773</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 2774</span>                       [num_instances, num_classes] representing the score <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno"> 2775</span>                       each box <span class="keywordflow">for</span> each <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 2776</span>    concat_vertical_probability: (optional) a tf.float32 scalar denoting the</div>
<div class="line"><span class="lineno"> 2777</span>                                 probability of a vertical concatenation.</div>
<div class="line"><span class="lineno"> 2778</span>    concat_horizontal_probability: (optional) a tf.float32 scalar denoting the</div>
<div class="line"><span class="lineno"> 2779</span>                                   probability of a horizontal concatenation.</div>
<div class="line"><span class="lineno"> 2780</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 2781</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 2782</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 2783</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 2784</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 2785</span> </div>
<div class="line"><span class="lineno"> 2786</span>  Returns:</div>
<div class="line"><span class="lineno"> 2787</span>    image: Image shape will be [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 2788</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 2789</span>           form.</div>
<div class="line"><span class="lineno"> 2790</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> also returns:</div>
<div class="line"><span class="lineno"> 2791</span>    maybe_concat_label_confidences: cropped label weights.</div>
<div class="line"><span class="lineno"> 2792</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> also returns:</div>
<div class="line"><span class="lineno"> 2793</span>    maybe_concat_multiclass_scores: cropped_multiclass_scores.</div>
<div class="line"><span class="lineno"> 2794</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2795</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2796</span><span class="stringliteral">  concat_vertical = (tf.random_uniform([], seed=seed) &lt;</span></div>
<div class="line"><span class="lineno"> 2797</span><span class="stringliteral">                     concat_vertical_probability)</span></div>
<div class="line"><span class="lineno"> 2798</span><span class="stringliteral">  </span><span class="comment"># Note the seed + 1 so we get some semblance of independence even with</span></div>
<div class="line"><span class="lineno"> 2799</span>  <span class="comment"># fixed seeds.</span></div>
<div class="line"><span class="lineno"> 2800</span>  concat_horizontal = (tf.random_uniform([], seed=seed + 1 <span class="keywordflow">if</span> seed <span class="keywordflow">else</span> <span class="keywordtype">None</span>)</div>
<div class="line"><span class="lineno"> 2801</span>                       &lt; concat_horizontal_probability)</div>
<div class="line"><span class="lineno"> 2802</span> </div>
<div class="line"><span class="lineno"> 2803</span>  gen_func = <span class="keyword">lambda</span>: (concat_vertical, concat_horizontal)</div>
<div class="line"><span class="lineno"> 2804</span>  params = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno"> 2805</span>      gen_func, preprocessor_cache.PreprocessorCache.SELF_CONCAT_IMAGE,</div>
<div class="line"><span class="lineno"> 2806</span>      preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 2807</span>  concat_vertical, concat_horizontal = params</div>
<div class="line"><span class="lineno"> 2808</span> </div>
<div class="line"><span class="lineno"> 2809</span>  <span class="keyword">def </span>_concat_image(image, boxes, labels, label_weights, axis):</div>
<div class="line"><span class="lineno"> 2810</span>    <span class="stringliteral">&quot;&quot;&quot;Concats the image to itself on `axis`.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2811</span>    output_images = tf.concat([image, image], axis=axis)</div>
<div class="line"><span class="lineno"> 2812</span> </div>
<div class="line"><span class="lineno"> 2813</span>    <span class="keywordflow">if</span> axis == 0:</div>
<div class="line"><span class="lineno"> 2814</span>      <span class="comment"># Concat vertically, so need to reduce the y coordinates.</span></div>
<div class="line"><span class="lineno"> 2815</span>      old_scaling = tf.constant([0.5, 1.0, 0.5, 1.0])</div>
<div class="line"><span class="lineno"> 2816</span>      new_translation = tf.constant([0.5, 0.0, 0.5, 0.0])</div>
<div class="line"><span class="lineno"> 2817</span>    <span class="keywordflow">elif</span> axis == 1:</div>
<div class="line"><span class="lineno"> 2818</span>      old_scaling = tf.constant([1.0, 0.5, 1.0, 0.5])</div>
<div class="line"><span class="lineno"> 2819</span>      new_translation = tf.constant([0.0, 0.5, 0.0, 0.5])</div>
<div class="line"><span class="lineno"> 2820</span> </div>
<div class="line"><span class="lineno"> 2821</span>    old_boxes = old_scaling * boxes</div>
<div class="line"><span class="lineno"> 2822</span>    new_boxes = old_boxes + new_translation</div>
<div class="line"><span class="lineno"> 2823</span>    all_boxes = tf.concat([old_boxes, new_boxes], axis=0)</div>
<div class="line"><span class="lineno"> 2824</span> </div>
<div class="line"><span class="lineno"> 2825</span>    <span class="keywordflow">return</span> [output_images, all_boxes, tf.tile(labels, [2]), tf.tile(</div>
<div class="line"><span class="lineno"> 2826</span>        label_weights, [2])]</div>
<div class="line"><span class="lineno"> 2827</span> </div>
<div class="line"><span class="lineno"> 2828</span>  image, boxes, labels, label_weights = tf.cond(</div>
<div class="line"><span class="lineno"> 2829</span>      concat_vertical,</div>
<div class="line"><span class="lineno"> 2830</span>      <span class="keyword">lambda</span>: _concat_image(image, boxes, labels, label_weights, axis=0),</div>
<div class="line"><span class="lineno"> 2831</span>      <span class="keyword">lambda</span>: [image, boxes, labels, label_weights],</div>
<div class="line"><span class="lineno"> 2832</span>      strict=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2833</span> </div>
<div class="line"><span class="lineno"> 2834</span>  outputs = tf.cond(</div>
<div class="line"><span class="lineno"> 2835</span>      concat_horizontal,</div>
<div class="line"><span class="lineno"> 2836</span>      <span class="keyword">lambda</span>: _concat_image(image, boxes, labels, label_weights, axis=1),</div>
<div class="line"><span class="lineno"> 2837</span>      <span class="keyword">lambda</span>: [image, boxes, labels, label_weights],</div>
<div class="line"><span class="lineno"> 2838</span>      strict=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2839</span> </div>
<div class="line"><span class="lineno"> 2840</span>  <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2841</span>    label_confidences = tf.cond(concat_vertical,</div>
<div class="line"><span class="lineno"> 2842</span>                                <span class="keyword">lambda</span>: tf.tile(label_confidences, [2]),</div>
<div class="line"><span class="lineno"> 2843</span>                                <span class="keyword">lambda</span>: label_confidences)</div>
<div class="line"><span class="lineno"> 2844</span>    outputs.append(tf.cond(concat_horizontal,</div>
<div class="line"><span class="lineno"> 2845</span>                           <span class="keyword">lambda</span>: tf.tile(label_confidences, [2]),</div>
<div class="line"><span class="lineno"> 2846</span>                           <span class="keyword">lambda</span>: label_confidences))</div>
<div class="line"><span class="lineno"> 2847</span> </div>
<div class="line"><span class="lineno"> 2848</span>  <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2849</span>    multiclass_scores = tf.cond(concat_vertical,</div>
<div class="line"><span class="lineno"> 2850</span>                                <span class="keyword">lambda</span>: tf.tile(multiclass_scores, [2, 1]),</div>
<div class="line"><span class="lineno"> 2851</span>                                <span class="keyword">lambda</span>: multiclass_scores)</div>
<div class="line"><span class="lineno"> 2852</span>    outputs.append(tf.cond(concat_horizontal,</div>
<div class="line"><span class="lineno"> 2853</span>                           <span class="keyword">lambda</span>: tf.tile(multiclass_scores, [2, 1]),</div>
<div class="line"><span class="lineno"> 2854</span>                           <span class="keyword">lambda</span>: multiclass_scores))</div>
<div class="line"><span class="lineno"> 2855</span> </div>
<div class="line"><span class="lineno"> 2856</span>  <span class="keywordflow">return</span> outputs</div>
<div class="line"><span class="lineno"> 2857</span> </div>
<div class="line"><span class="lineno"> 2858</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a28ed9f2cfed49a54b767a131fb3e7cde_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a28ed9f2cfed49a54b767a131fb3e7cde_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a28ed9f2cfed49a54b767a131fb3e7cde_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a28ed9f2cfed49a54b767a131fb3e7cde_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,267,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,5,556,45"/>
<area shape="poly" title=" " alt="" coords="267,23,301,23,301,28,267,28"/>
</map>
</div>

</div>
</div>
<a id="ae3b102c4ba64515724d250cb08523bf3" name="ae3b102c4ba64515724d250cb08523bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3b102c4ba64515724d250cb08523bf3">&#9670;&#160;</a></span>random_vertical_flip()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.random_vertical_flip </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoint_flip_permutation</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Randomly flips the image and detections vertically.

The probability of flipping the image is 50%.

Args:
  image: rank 3 float32 tensor with shape [height, width, channels].
  boxes: (optional) rank 2 float32 tensor with shape [N, 4]
         containing the bounding boxes.
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  keypoint_flip_permutation: rank 1 int32 tensor containing the keypoint flip
                             permutation.
  seed: random seed
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same shape as input image.

  If boxes, masks, keypoints, and keypoint_flip_permutation are not None,
  the function also returns the following tensors.

  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]

Raises:
  ValueError: if keypoints are provided but keypoint_flip_permutation is not.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00661">661</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  667</span>                         preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  668</span>  <span class="stringliteral">&quot;&quot;&quot;Randomly flips the image and detections vertically.</span></div>
<div class="line"><span class="lineno">  669</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  670</span><span class="stringliteral">  The probability of flipping the image </span><span class="keywordflow">is</span> 50%.</div>
<div class="line"><span class="lineno">  671</span> </div>
<div class="line"><span class="lineno">  672</span>  Args:</div>
<div class="line"><span class="lineno">  673</span>    image: rank 3 float32 tensor <span class="keyword">with</span> shape [height, width, channels].</div>
<div class="line"><span class="lineno">  674</span>    boxes: (optional) rank 2 float32 tensor <span class="keyword">with</span> shape [N, 4]</div>
<div class="line"><span class="lineno">  675</span>           containing the bounding boxes.</div>
<div class="line"><span class="lineno">  676</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  677</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  678</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno">  679</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  680</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno">  681</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno">  682</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  683</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno">  684</span>               normalized coordinates.</div>
<div class="line"><span class="lineno">  685</span>    keypoint_flip_permutation: rank 1 int32 tensor containing the keypoint flip</div>
<div class="line"><span class="lineno">  686</span>                               permutation.</div>
<div class="line"><span class="lineno">  687</span>    seed: random seed</div>
<div class="line"><span class="lineno">  688</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno">  689</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno">  690</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno">  691</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  Returns:</div>
<div class="line"><span class="lineno">  694</span>    image: image which <span class="keywordflow">is</span> the same shape <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno">  695</span> </div>
<div class="line"><span class="lineno">  696</span>    If boxes, masks, keypoints, <span class="keywordflow">and</span> keypoint_flip_permutation are <span class="keywordflow">not</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  697</span>    the function also returns the following tensors.</div>
<div class="line"><span class="lineno">  698</span> </div>
<div class="line"><span class="lineno">  699</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno">  700</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno">  701</span>           between [0, 1].</div>
<div class="line"><span class="lineno">  702</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno">  703</span>           containing instance masks.</div>
<div class="line"><span class="lineno">  704</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  705</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  Raises:</div>
<div class="line"><span class="lineno">  708</span>    ValueError: <span class="keywordflow">if</span> keypoints are provided but keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordflow">not</span>.</div>
<div class="line"><span class="lineno">  709</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  710</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  711</span><span class="stringliteral">  </span><span class="keyword">def </span>_flip_image(image):</div>
<div class="line"><span class="lineno">  712</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  713</span>    image_flipped = tf.image.flip_up_down(image)</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">return</span> image_flipped</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordflow">raise</span> ValueError(</div>
<div class="line"><span class="lineno">  718</span>        <span class="stringliteral">&#39;keypoints are provided but keypoints_flip_permutation is not provided&#39;</span>)</div>
<div class="line"><span class="lineno">  719</span> </div>
<div class="line"><span class="lineno">  720</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RandomVerticalFlip&#39;</span>, values=[image, boxes]):</div>
<div class="line"><span class="lineno">  721</span>    result = []</div>
<div class="line"><span class="lineno">  722</span>    <span class="comment"># random variable defining whether to do flip or not</span></div>
<div class="line"><span class="lineno">  723</span>    generator_func = functools.partial(tf.random_uniform, [], seed=seed)</div>
<div class="line"><span class="lineno">  724</span>    do_a_flip_random = _get_or_create_preprocess_rand_vars(</div>
<div class="line"><span class="lineno">  725</span>        generator_func, preprocessor_cache.PreprocessorCache.VERTICAL_FLIP,</div>
<div class="line"><span class="lineno">  726</span>        preprocess_vars_cache)</div>
<div class="line"><span class="lineno">  727</span>    do_a_flip_random = tf.greater(do_a_flip_random, 0.5)</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="comment"># flip image</span></div>
<div class="line"><span class="lineno">  730</span>    image = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_image(image), <span class="keyword">lambda</span>: image)</div>
<div class="line"><span class="lineno">  731</span>    result.append(image)</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span>    <span class="comment"># flip boxes</span></div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">if</span> boxes <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  735</span>      boxes = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_boxes_up_down(boxes),</div>
<div class="line"><span class="lineno">  736</span>                      <span class="keyword">lambda</span>: boxes)</div>
<div class="line"><span class="lineno">  737</span>      result.append(boxes)</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>    <span class="comment"># flip masks</span></div>
<div class="line"><span class="lineno">  740</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  741</span>      masks = tf.cond(do_a_flip_random, <span class="keyword">lambda</span>: _flip_masks_up_down(masks),</div>
<div class="line"><span class="lineno">  742</span>                      <span class="keyword">lambda</span>: masks)</div>
<div class="line"><span class="lineno">  743</span>      result.append(masks)</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>    <span class="comment"># flip keypoints</span></div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> keypoint_flip_permutation <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  747</span>      permutation = keypoint_flip_permutation</div>
<div class="line"><span class="lineno">  748</span>      keypoints = tf.cond(</div>
<div class="line"><span class="lineno">  749</span>          do_a_flip_random,</div>
<div class="line"><span class="lineno">  750</span>          <span class="keyword">lambda</span>: keypoint_ops.flip_vertical(keypoints, 0.5, permutation),</div>
<div class="line"><span class="lineno">  751</span>          <span class="keyword">lambda</span>: keypoints)</div>
<div class="line"><span class="lineno">  752</span>      result.append(keypoints)</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae3b102c4ba64515724d250cb08523bf3_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae3b102c4ba64515724d250cb08523bf3_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae3b102c4ba64515724d250cb08523bf3_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae3b102c4ba64515724d250cb08523bf3_cgraph">
<area shape="rect" title=" " alt="" coords="5,69,267,109"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab7aadde1361f08d837700bfdc9e01b13" title=" " alt="" coords="326,5,545,45"/>
<area shape="poly" title=" " alt="" coords="230,67,327,46,328,51,231,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a916daef65c5c27ef1c9a3efd2d89e80a" title=" " alt="" coords="326,69,545,109"/>
<area shape="poly" title=" " alt="" coords="267,87,312,87,312,92,267,92"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="315,133,556,173"/>
<area shape="poly" title=" " alt="" coords="231,107,328,128,327,133,230,112"/>
</map>
</div>

</div>
</div>
<a id="aedfac18f6ff4fa9921ab6862cf931b37" name="aedfac18f6ff4fa9921ab6862cf931b37"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedfac18f6ff4fa9921ab6862cf931b37">&#9670;&#160;</a></span>remap_labels()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.remap_labels </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>original_labels</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_label</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Remaps labels that have an id in original_labels to new_label.

Args:
  labels: rank 1 int32 tensor of shape [num_instance] containing the object
    classes.
    original_labels: int list of original labels that should be mapped from.
    new_label: int label to map to
Returns:
  Remapped labels
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00435">435</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  437</span>                 new_label=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  438</span>  <span class="stringliteral">&quot;&quot;&quot;Remaps labels that have an id in original_labels to new_label.</span></div>
<div class="line"><span class="lineno">  439</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  440</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  441</span><span class="stringliteral">    labels: rank 1 int32 tensor of shape [num_instance] containing the object</span></div>
<div class="line"><span class="lineno">  442</span><span class="stringliteral">      classes.</span></div>
<div class="line"><span class="lineno">  443</span><span class="stringliteral">      original_labels: int list of original labels that should be mapped </span><span class="keyword">from</span>.</div>
<div class="line"><span class="lineno">  444</span>      new_label: int label to map to</div>
<div class="line"><span class="lineno">  445</span>  Returns:</div>
<div class="line"><span class="lineno">  446</span>    Remapped labels</div>
<div class="line"><span class="lineno">  447</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  448</span><span class="stringliteral">  new_labels = labels</span></div>
<div class="line"><span class="lineno">  449</span><span class="stringliteral">  </span><span class="keywordflow">for</span> original_label <span class="keywordflow">in</span> original_labels:</div>
<div class="line"><span class="lineno">  450</span>    change = tf.where(</div>
<div class="line"><span class="lineno">  451</span>        tf.equal(new_labels, original_label),</div>
<div class="line"><span class="lineno">  452</span>        tf.add(tf.zeros_like(new_labels), new_label - original_label),</div>
<div class="line"><span class="lineno">  453</span>        tf.zeros_like(new_labels))</div>
<div class="line"><span class="lineno">  454</span>    new_labels = tf.add(</div>
<div class="line"><span class="lineno">  455</span>        new_labels,</div>
<div class="line"><span class="lineno">  456</span>        change)</div>
<div class="line"><span class="lineno">  457</span>  new_labels = tf.reshape(new_labels, tf.shape(labels))</div>
<div class="line"><span class="lineno">  458</span>  <span class="keywordflow">return</span> new_labels</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a594f3c0e2cdc3464ad0cf5c85359293b" name="a594f3c0e2cdc3464ad0cf5c85359293b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a594f3c0e2cdc3464ad0cf5c85359293b">&#9670;&#160;</a></span>resize_image()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.resize_image </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_height</em> = <code>600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>new_width</em> = <code>1024</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>tf.image.ResizeMethod.BILINEAR</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>align_corners</em> = <code>False</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Resizes images to the given height and width.

Args:
  image: A 3D tensor of shape [height, width, channels]
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks.
  new_height: (optional) (scalar) desired height of the image.
  new_width: (optional) (scalar) desired width of the image.
  method: (optional) interpolation method used in resizing. Defaults to
          BILINEAR.
  align_corners: bool. If true, exactly align all 4 corners of the input
                 and output. Defaults to False.

Returns:
  Note that the position of the resized_image_shape changes based on whether
  masks are present.
  resized_image: A tensor of size [new_height, new_width, channels].
  resized_masks: If masks is not None, also outputs masks. A 3D tensor of
    shape [num_instances, new_height, new_width]
  resized_image_shape: A 1D tensor of shape [3] containing the shape of the
    resized image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02629">2629</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2634</span>                 align_corners=<span class="keyword">False</span>):</div>
<div class="line"><span class="lineno"> 2635</span>  <span class="stringliteral">&quot;&quot;&quot;Resizes images to the given height and width.</span></div>
<div class="line"><span class="lineno"> 2636</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2637</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2638</span><span class="stringliteral">    image: A 3D tensor of shape [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 2639</span><span class="stringliteral">    masks: (optional) rank 3 float32 tensor </span><span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2640</span>           [num_instances, height, width] containing instance masks.</div>
<div class="line"><span class="lineno"> 2641</span>    new_height: (optional) (scalar) desired height of the image.</div>
<div class="line"><span class="lineno"> 2642</span>    new_width: (optional) (scalar) desired width of the image.</div>
<div class="line"><span class="lineno"> 2643</span>    method: (optional) interpolation method used <span class="keywordflow">in</span> resizing. Defaults to</div>
<div class="line"><span class="lineno"> 2644</span>            BILINEAR.</div>
<div class="line"><span class="lineno"> 2645</span>    align_corners: bool. If true, exactly align all 4 corners of the input</div>
<div class="line"><span class="lineno"> 2646</span>                   <span class="keywordflow">and</span> output. Defaults to <span class="keyword">False</span>.</div>
<div class="line"><span class="lineno"> 2647</span> </div>
<div class="line"><span class="lineno"> 2648</span>  Returns:</div>
<div class="line"><span class="lineno"> 2649</span>    Note that the position of the resized_image_shape changes based on whether</div>
<div class="line"><span class="lineno"> 2650</span>    masks are present.</div>
<div class="line"><span class="lineno"> 2651</span>    resized_image: A tensor of size [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 2652</span>    resized_masks: If masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, also outputs masks. A 3D tensor of</div>
<div class="line"><span class="lineno"> 2653</span>      shape [num_instances, new_height, new_width]</div>
<div class="line"><span class="lineno"> 2654</span>    resized_image_shape: A 1D tensor of shape [3] containing the shape of the</div>
<div class="line"><span class="lineno"> 2655</span>      resized image.</div>
<div class="line"><span class="lineno"> 2656</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2657</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(</div>
<div class="line"><span class="lineno"> 2658</span>      <span class="stringliteral">&#39;ResizeImage&#39;</span>,</div>
<div class="line"><span class="lineno"> 2659</span>      values=[image, new_height, new_width, method, align_corners]):</div>
<div class="line"><span class="lineno"> 2660</span>    new_image = tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2661</span>        image, tf.stack([new_height, new_width]),</div>
<div class="line"><span class="lineno"> 2662</span>        method=method,</div>
<div class="line"><span class="lineno"> 2663</span>        align_corners=align_corners)</div>
<div class="line"><span class="lineno"> 2664</span>    image_shape = shape_utils.combined_static_and_dynamic_shape(image)</div>
<div class="line"><span class="lineno"> 2665</span>    result = [new_image]</div>
<div class="line"><span class="lineno"> 2666</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2667</span>      num_instances = tf.shape(masks)[0]</div>
<div class="line"><span class="lineno"> 2668</span>      new_size = tf.stack([new_height, new_width])</div>
<div class="line"><span class="lineno"> 2669</span>      <span class="keyword">def </span>resize_masks_branch():</div>
<div class="line"><span class="lineno"> 2670</span>        new_masks = tf.expand_dims(masks, 3)</div>
<div class="line"><span class="lineno"> 2671</span>        new_masks = tf.image.resize_nearest_neighbor(</div>
<div class="line"><span class="lineno"> 2672</span>            new_masks, new_size, align_corners=align_corners)</div>
<div class="line"><span class="lineno"> 2673</span>        new_masks = tf.squeeze(new_masks, axis=3)</div>
<div class="line"><span class="lineno"> 2674</span>        <span class="keywordflow">return</span> new_masks</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>      <span class="keyword">def </span>reshape_masks_branch():</div>
<div class="line"><span class="lineno"> 2677</span>        <span class="comment"># The shape function will be computed for both branches of the</span></div>
<div class="line"><span class="lineno"> 2678</span>        <span class="comment"># condition, regardless of which branch is actually taken. Make sure</span></div>
<div class="line"><span class="lineno"> 2679</span>        <span class="comment"># that we don&#39;t trigger an assertion in the shape function when trying</span></div>
<div class="line"><span class="lineno"> 2680</span>        <span class="comment"># to reshape a non empty tensor into an empty one.</span></div>
<div class="line"><span class="lineno"> 2681</span>        new_masks = tf.reshape(masks, [-1, new_size[0], new_size[1]])</div>
<div class="line"><span class="lineno"> 2682</span>        <span class="keywordflow">return</span> new_masks</div>
<div class="line"><span class="lineno"> 2683</span> </div>
<div class="line"><span class="lineno"> 2684</span>      masks = tf.cond(num_instances &gt; 0, resize_masks_branch,</div>
<div class="line"><span class="lineno"> 2685</span>                      reshape_masks_branch)</div>
<div class="line"><span class="lineno"> 2686</span>      result.append(masks)</div>
<div class="line"><span class="lineno"> 2687</span> </div>
<div class="line"><span class="lineno"> 2688</span>    result.append(tf.stack([new_height, new_width, image_shape[2]]))</div>
<div class="line"><span class="lineno"> 2689</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2690</span> </div>
<div class="line"><span class="lineno"> 2691</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ad8ce6e9aabff130be4839677d2ece3" name="a0ad8ce6e9aabff130be4839677d2ece3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ad8ce6e9aabff130be4839677d2ece3">&#9670;&#160;</a></span>resize_to_max_dimension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.resize_to_max_dimension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_dimension</em> = <code>600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>tf.image.ResizeMethod.BILINEAR</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Resizes image and masks given the max size maintaining the aspect ratio.

If one of the image dimensions is greater than max_dimension, it will scale
the image such that its largest dimension is equal to max_dimension.
Otherwise, will keep the image size as is.

Args:
  image: a tensor of size [height, width, channels].
  masks: (optional) a tensors of size [num_instances, height, width].
  max_dimension: maximum image dimension.
  method: (optional) interpolation method used in resizing. Defaults to
  BILINEAR.

Returns:
  An array containing resized_image, resized_masks, and resized_image_shape.
  Note that the position of the resized_image_shape changes based on whether
  masks are present.
  resized_image: A tensor of size [new_height, new_width, channels].
  resized_masks: If masks is not None, also outputs masks. A 3D tensor of
    shape [num_instances, new_height, new_width]
  resized_image_shape: A 1D tensor of shape [3] containing the shape of the
    resized image.

Raises:
  ValueError: if the image is not a 3D tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02537">2537</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2538</span>                            method=tf.image.ResizeMethod.BILINEAR):</div>
<div class="line"><span class="lineno"> 2539</span>  <span class="stringliteral">&quot;&quot;&quot;Resizes image and masks given the max size maintaining the aspect ratio.</span></div>
<div class="line"><span class="lineno"> 2540</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2541</span><span class="stringliteral">  If one of the image dimensions </span><span class="keywordflow">is</span> greater than max_dimension, it will scale</div>
<div class="line"><span class="lineno"> 2542</span>  the image such that its largest dimension <span class="keywordflow">is</span> equal to max_dimension.</div>
<div class="line"><span class="lineno"> 2543</span>  Otherwise, will keep the image size <span class="keyword">as</span> <span class="keywordflow">is</span>.</div>
<div class="line"><span class="lineno"> 2544</span> </div>
<div class="line"><span class="lineno"> 2545</span>  Args:</div>
<div class="line"><span class="lineno"> 2546</span>    image: a tensor of size [height, width, channels].</div>
<div class="line"><span class="lineno"> 2547</span>    masks: (optional) a tensors of size [num_instances, height, width].</div>
<div class="line"><span class="lineno"> 2548</span>    max_dimension: maximum image dimension.</div>
<div class="line"><span class="lineno"> 2549</span>    method: (optional) interpolation method used <span class="keywordflow">in</span> resizing. Defaults to</div>
<div class="line"><span class="lineno"> 2550</span>    BILINEAR.</div>
<div class="line"><span class="lineno"> 2551</span> </div>
<div class="line"><span class="lineno"> 2552</span>  Returns:</div>
<div class="line"><span class="lineno"> 2553</span>    An array containing resized_image, resized_masks, <span class="keywordflow">and</span> resized_image_shape.</div>
<div class="line"><span class="lineno"> 2554</span>    Note that the position of the resized_image_shape changes based on whether</div>
<div class="line"><span class="lineno"> 2555</span>    masks are present.</div>
<div class="line"><span class="lineno"> 2556</span>    resized_image: A tensor of size [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 2557</span>    resized_masks: If masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, also outputs masks. A 3D tensor of</div>
<div class="line"><span class="lineno"> 2558</span>      shape [num_instances, new_height, new_width]</div>
<div class="line"><span class="lineno"> 2559</span>    resized_image_shape: A 1D tensor of shape [3] containing the shape of the</div>
<div class="line"><span class="lineno"> 2560</span>      resized image.</div>
<div class="line"><span class="lineno"> 2561</span> </div>
<div class="line"><span class="lineno"> 2562</span>  Raises:</div>
<div class="line"><span class="lineno"> 2563</span>    ValueError: <span class="keywordflow">if</span> the image <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 3D tensor.</div>
<div class="line"><span class="lineno"> 2564</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2565</span><span class="stringliteral">  </span><span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 2566</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Image should be 3D tensor&#39;</span>)</div>
<div class="line"><span class="lineno"> 2567</span> </div>
<div class="line"><span class="lineno"> 2568</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;ResizeGivenMaxDimension&#39;</span>, values=[image, max_dimension]):</div>
<div class="line"><span class="lineno"> 2569</span>    (image_height, image_width, num_channels) = _get_image_info(image)</div>
<div class="line"><span class="lineno"> 2570</span>    max_image_dimension = tf.maximum(image_height, image_width)</div>
<div class="line"><span class="lineno"> 2571</span>    max_target_dimension = tf.minimum(max_image_dimension, max_dimension)</div>
<div class="line"><span class="lineno"> 2572</span>    target_ratio = tf.cast(max_target_dimension, dtype=tf.float32) / tf.cast(</div>
<div class="line"><span class="lineno"> 2573</span>        max_image_dimension, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2574</span>    target_height = tf.cast(</div>
<div class="line"><span class="lineno"> 2575</span>        tf.cast(image_height, dtype=tf.float32) * target_ratio, dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2576</span>    target_width = tf.cast(</div>
<div class="line"><span class="lineno"> 2577</span>        tf.cast(image_width, dtype=tf.float32) * target_ratio, dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2578</span>    image = tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2579</span>        tf.expand_dims(image, axis=0), size=[target_height, target_width],</div>
<div class="line"><span class="lineno"> 2580</span>        method=method,</div>
<div class="line"><span class="lineno"> 2581</span>        align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2582</span>    result = [tf.squeeze(image, axis=0)]</div>
<div class="line"><span class="lineno"> 2583</span> </div>
<div class="line"><span class="lineno"> 2584</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2585</span>      masks = tf.image.resize_nearest_neighbor(</div>
<div class="line"><span class="lineno"> 2586</span>          tf.expand_dims(masks, axis=3),</div>
<div class="line"><span class="lineno"> 2587</span>          size=[target_height, target_width],</div>
<div class="line"><span class="lineno"> 2588</span>          align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2589</span>      result.append(tf.squeeze(masks, axis=3))</div>
<div class="line"><span class="lineno"> 2590</span> </div>
<div class="line"><span class="lineno"> 2591</span>    result.append(tf.stack([target_height, target_width, num_channels]))</div>
<div class="line"><span class="lineno"> 2592</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2593</span> </div>
<div class="line"><span class="lineno"> 2594</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0ad8ce6e9aabff130be4839677d2ece3_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0ad8ce6e9aabff130be4839677d2ece3_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0ad8ce6e9aabff130be4839677d2ece3_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a0ad8ce6e9aabff130be4839677d2ece3_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,259,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6a294fdb039f62a6de9b9be007481357" title=" " alt="" coords="307,5,525,45"/>
<area shape="poly" title=" " alt="" coords="259,23,293,23,293,28,259,28"/>
</map>
</div>

</div>
</div>
<a id="ae31da8a2456c9fd96e951ec2564a04ef" name="ae31da8a2456c9fd96e951ec2564a04ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae31da8a2456c9fd96e951ec2564a04ef">&#9670;&#160;</a></span>resize_to_min_dimension()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.resize_to_min_dimension </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_dimension</em> = <code>600</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>tf.image.ResizeMethod.BILINEAR</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Resizes image and masks given the min size maintaining the aspect ratio.

If one of the image dimensions is smaller than min_dimension, it will scale
the image such that its smallest dimension is equal to min_dimension.
Otherwise, will keep the image size as is.

Args:
  image: a tensor of size [height, width, channels].
  masks: (optional) a tensors of size [num_instances, height, width].
  min_dimension: minimum image dimension.
  method: (optional) interpolation method used in resizing. Defaults to
  BILINEAR.

Returns:
  An array containing resized_image, resized_masks, and resized_image_shape.
  Note that the position of the resized_image_shape changes based on whether
  masks are present.
  resized_image: A tensor of size [new_height, new_width, channels].
  resized_masks: If masks is not None, also outputs masks. A 3D tensor of
    shape [num_instances, new_height, new_width]
  resized_image_shape: A 1D tensor of shape [3] containing the shape of the
    resized image.

Raises:
  ValueError: if the image is not a 3D tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02479">2479</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2480</span>                            method=tf.image.ResizeMethod.BILINEAR):</div>
<div class="line"><span class="lineno"> 2481</span>  <span class="stringliteral">&quot;&quot;&quot;Resizes image and masks given the min size maintaining the aspect ratio.</span></div>
<div class="line"><span class="lineno"> 2482</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2483</span><span class="stringliteral">  If one of the image dimensions </span><span class="keywordflow">is</span> smaller than min_dimension, it will scale</div>
<div class="line"><span class="lineno"> 2484</span>  the image such that its smallest dimension <span class="keywordflow">is</span> equal to min_dimension.</div>
<div class="line"><span class="lineno"> 2485</span>  Otherwise, will keep the image size <span class="keyword">as</span> <span class="keywordflow">is</span>.</div>
<div class="line"><span class="lineno"> 2486</span> </div>
<div class="line"><span class="lineno"> 2487</span>  Args:</div>
<div class="line"><span class="lineno"> 2488</span>    image: a tensor of size [height, width, channels].</div>
<div class="line"><span class="lineno"> 2489</span>    masks: (optional) a tensors of size [num_instances, height, width].</div>
<div class="line"><span class="lineno"> 2490</span>    min_dimension: minimum image dimension.</div>
<div class="line"><span class="lineno"> 2491</span>    method: (optional) interpolation method used <span class="keywordflow">in</span> resizing. Defaults to</div>
<div class="line"><span class="lineno"> 2492</span>    BILINEAR.</div>
<div class="line"><span class="lineno"> 2493</span> </div>
<div class="line"><span class="lineno"> 2494</span>  Returns:</div>
<div class="line"><span class="lineno"> 2495</span>    An array containing resized_image, resized_masks, <span class="keywordflow">and</span> resized_image_shape.</div>
<div class="line"><span class="lineno"> 2496</span>    Note that the position of the resized_image_shape changes based on whether</div>
<div class="line"><span class="lineno"> 2497</span>    masks are present.</div>
<div class="line"><span class="lineno"> 2498</span>    resized_image: A tensor of size [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 2499</span>    resized_masks: If masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, also outputs masks. A 3D tensor of</div>
<div class="line"><span class="lineno"> 2500</span>      shape [num_instances, new_height, new_width]</div>
<div class="line"><span class="lineno"> 2501</span>    resized_image_shape: A 1D tensor of shape [3] containing the shape of the</div>
<div class="line"><span class="lineno"> 2502</span>      resized image.</div>
<div class="line"><span class="lineno"> 2503</span> </div>
<div class="line"><span class="lineno"> 2504</span>  Raises:</div>
<div class="line"><span class="lineno"> 2505</span>    ValueError: <span class="keywordflow">if</span> the image <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 3D tensor.</div>
<div class="line"><span class="lineno"> 2506</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2507</span><span class="stringliteral">  </span><span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 2508</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Image should be 3D tensor&#39;</span>)</div>
<div class="line"><span class="lineno"> 2509</span> </div>
<div class="line"><span class="lineno"> 2510</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;ResizeGivenMinDimension&#39;</span>, values=[image, min_dimension]):</div>
<div class="line"><span class="lineno"> 2511</span>    (image_height, image_width, num_channels) = _get_image_info(image)</div>
<div class="line"><span class="lineno"> 2512</span>    min_image_dimension = tf.minimum(image_height, image_width)</div>
<div class="line"><span class="lineno"> 2513</span>    min_target_dimension = tf.maximum(min_image_dimension, min_dimension)</div>
<div class="line"><span class="lineno"> 2514</span>    target_ratio = tf.cast(min_target_dimension, dtype=tf.float32) / tf.cast(</div>
<div class="line"><span class="lineno"> 2515</span>        min_image_dimension, dtype=tf.float32)</div>
<div class="line"><span class="lineno"> 2516</span>    target_height = tf.cast(</div>
<div class="line"><span class="lineno"> 2517</span>        tf.cast(image_height, dtype=tf.float32) * target_ratio, dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2518</span>    target_width = tf.cast(</div>
<div class="line"><span class="lineno"> 2519</span>        tf.cast(image_width, dtype=tf.float32) * target_ratio, dtype=tf.int32)</div>
<div class="line"><span class="lineno"> 2520</span>    image = tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2521</span>        tf.expand_dims(image, axis=0), size=[target_height, target_width],</div>
<div class="line"><span class="lineno"> 2522</span>        method=method,</div>
<div class="line"><span class="lineno"> 2523</span>        align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2524</span>    result = [tf.squeeze(image, axis=0)]</div>
<div class="line"><span class="lineno"> 2525</span> </div>
<div class="line"><span class="lineno"> 2526</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2527</span>      masks = tf.image.resize_nearest_neighbor(</div>
<div class="line"><span class="lineno"> 2528</span>          tf.expand_dims(masks, axis=3),</div>
<div class="line"><span class="lineno"> 2529</span>          size=[target_height, target_width],</div>
<div class="line"><span class="lineno"> 2530</span>          align_corners=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2531</span>      result.append(tf.squeeze(masks, axis=3))</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>    result.append(tf.stack([target_height, target_width, num_channels]))</div>
<div class="line"><span class="lineno"> 2534</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae31da8a2456c9fd96e951ec2564a04ef_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae31da8a2456c9fd96e951ec2564a04ef_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae31da8a2456c9fd96e951ec2564a04ef_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae31da8a2456c9fd96e951ec2564a04ef_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,259,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a6a294fdb039f62a6de9b9be007481357" title=" " alt="" coords="307,5,525,45"/>
<area shape="poly" title=" " alt="" coords="259,23,293,23,293,28,259,28"/>
</map>
</div>

</div>
</div>
<a id="aa16c94ed6a6e3e2ee8e39a4a5d0212ba" name="aa16c94ed6a6e3e2ee8e39a4a5d0212ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa16c94ed6a6e3e2ee8e39a4a5d0212ba">&#9670;&#160;</a></span>resize_to_range()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.resize_to_range </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_dimension</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_dimension</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>method</em> = <code>tf.image.ResizeMethod.BILINEAR</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>align_corners</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pad_to_max_dimension</em> = <code>False</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>per_channel_pad_value</em> = <code>(0,&#160;0,&#160;0)</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Resizes an image so its dimensions are within the provided value.

The output size can be described by two cases:
1. If the image can be rescaled so its minimum dimension is equal to the
   provided value without the other dimension exceeding max_dimension,
   then do so.
2. Otherwise, resize so the largest dimension is equal to max_dimension.

Args:
  image: A 3D tensor of shape [height, width, channels]
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks.
  min_dimension: (optional) (scalar) desired size of the smaller image
                 dimension.
  max_dimension: (optional) (scalar) maximum allowed size
                 of the larger image dimension.
  method: (optional) interpolation method used in resizing. Defaults to
          BILINEAR.
  align_corners: bool. If true, exactly align all 4 corners of the input
                 and output. Defaults to False.
  pad_to_max_dimension: Whether to resize the image and pad it with zeros
    so the resulting image is of the spatial size
    [max_dimension, max_dimension]. If masks are included they are padded
    similarly.
  per_channel_pad_value: A tuple of per-channel scalar value to use for
    padding. By default pads zeros.

Returns:
  Note that the position of the resized_image_shape changes based on whether
  masks are present.
  resized_image: A 3D tensor of shape [new_height, new_width, channels],
    where the image has been resized (with bilinear interpolation) so that
    min(new_height, new_width) == min_dimension or
    max(new_height, new_width) == max_dimension.
  resized_masks: If masks is not None, also outputs masks. A 3D tensor of
    shape [num_instances, new_height, new_width].
  resized_image_shape: A 1D tensor of shape [3] containing shape of the
    resized image.

Raises:
  ValueError: if the image is not a 3D tensor.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02357">2357</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2364</span>                    per_channel_pad_value=(0, 0, 0)):</div>
<div class="line"><span class="lineno"> 2365</span>  <span class="stringliteral">&quot;&quot;&quot;Resizes an image so its dimensions are within the provided value.</span></div>
<div class="line"><span class="lineno"> 2366</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2367</span><span class="stringliteral">  The output size can be described by two cases:</span></div>
<div class="line"><span class="lineno"> 2368</span><span class="stringliteral">  1. If the image can be rescaled so its minimum dimension </span><span class="keywordflow">is</span> equal to the</div>
<div class="line"><span class="lineno"> 2369</span>     provided value without the other dimension exceeding max_dimension,</div>
<div class="line"><span class="lineno"> 2370</span>     then do so.</div>
<div class="line"><span class="lineno"> 2371</span>  2. Otherwise, resize so the largest dimension <span class="keywordflow">is</span> equal to max_dimension.</div>
<div class="line"><span class="lineno"> 2372</span> </div>
<div class="line"><span class="lineno"> 2373</span>  Args:</div>
<div class="line"><span class="lineno"> 2374</span>    image: A 3D tensor of shape [height, width, channels]</div>
<div class="line"><span class="lineno"> 2375</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2376</span>           [num_instances, height, width] containing instance masks.</div>
<div class="line"><span class="lineno"> 2377</span>    min_dimension: (optional) (scalar) desired size of the smaller image</div>
<div class="line"><span class="lineno"> 2378</span>                   dimension.</div>
<div class="line"><span class="lineno"> 2379</span>    max_dimension: (optional) (scalar) maximum allowed size</div>
<div class="line"><span class="lineno"> 2380</span>                   of the larger image dimension.</div>
<div class="line"><span class="lineno"> 2381</span>    method: (optional) interpolation method used <span class="keywordflow">in</span> resizing. Defaults to</div>
<div class="line"><span class="lineno"> 2382</span>            BILINEAR.</div>
<div class="line"><span class="lineno"> 2383</span>    align_corners: bool. If true, exactly align all 4 corners of the input</div>
<div class="line"><span class="lineno"> 2384</span>                   <span class="keywordflow">and</span> output. Defaults to <span class="keyword">False</span>.</div>
<div class="line"><span class="lineno"> 2385</span>    pad_to_max_dimension: Whether to resize the image <span class="keywordflow">and</span> pad it <span class="keyword">with</span> zeros</div>
<div class="line"><span class="lineno"> 2386</span>      so the resulting image <span class="keywordflow">is</span> of the spatial size</div>
<div class="line"><span class="lineno"> 2387</span>      [max_dimension, max_dimension]. If masks are included they are padded</div>
<div class="line"><span class="lineno"> 2388</span>      similarly.</div>
<div class="line"><span class="lineno"> 2389</span>    per_channel_pad_value: A tuple of per-channel scalar value to use <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno"> 2390</span>      padding. By default pads zeros.</div>
<div class="line"><span class="lineno"> 2391</span> </div>
<div class="line"><span class="lineno"> 2392</span>  Returns:</div>
<div class="line"><span class="lineno"> 2393</span>    Note that the position of the resized_image_shape changes based on whether</div>
<div class="line"><span class="lineno"> 2394</span>    masks are present.</div>
<div class="line"><span class="lineno"> 2395</span>    resized_image: A 3D tensor of shape [new_height, new_width, channels],</div>
<div class="line"><span class="lineno"> 2396</span>      where the image has been resized (<span class="keyword">with</span> bilinear interpolation) so that</div>
<div class="line"><span class="lineno"> 2397</span>      min(new_height, new_width) == min_dimension <span class="keywordflow">or</span></div>
<div class="line"><span class="lineno"> 2398</span>      max(new_height, new_width) == max_dimension.</div>
<div class="line"><span class="lineno"> 2399</span>    resized_masks: If masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, also outputs masks. A 3D tensor of</div>
<div class="line"><span class="lineno"> 2400</span>      shape [num_instances, new_height, new_width].</div>
<div class="line"><span class="lineno"> 2401</span>    resized_image_shape: A 1D tensor of shape [3] containing shape of the</div>
<div class="line"><span class="lineno"> 2402</span>      resized image.</div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>  Raises:</div>
<div class="line"><span class="lineno"> 2405</span>    ValueError: <span class="keywordflow">if</span> the image <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 3D tensor.</div>
<div class="line"><span class="lineno"> 2406</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2407</span><span class="stringliteral">  </span><span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 2408</span>    <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Image should be 3D tensor&#39;</span>)</div>
<div class="line"><span class="lineno"> 2409</span> </div>
<div class="line"><span class="lineno"> 2410</span>  <span class="keyword">def </span>_resize_landscape_image(image):</div>
<div class="line"><span class="lineno"> 2411</span>    <span class="comment"># resize a landscape image</span></div>
<div class="line"><span class="lineno"> 2412</span>    <span class="keywordflow">return</span> tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2413</span>        image, tf.stack([min_dimension, max_dimension]), method=method,</div>
<div class="line"><span class="lineno"> 2414</span>        align_corners=align_corners, preserve_aspect_ratio=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2415</span> </div>
<div class="line"><span class="lineno"> 2416</span>  <span class="keyword">def </span>_resize_portrait_image(image):</div>
<div class="line"><span class="lineno"> 2417</span>    <span class="comment"># resize a portrait image</span></div>
<div class="line"><span class="lineno"> 2418</span>    <span class="keywordflow">return</span> tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2419</span>        image, tf.stack([max_dimension, min_dimension]), method=method,</div>
<div class="line"><span class="lineno"> 2420</span>        align_corners=align_corners, preserve_aspect_ratio=<span class="keyword">True</span>)</div>
<div class="line"><span class="lineno"> 2421</span> </div>
<div class="line"><span class="lineno"> 2422</span>  <span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;ResizeToRange&#39;</span>, values=[image, min_dimension]):</div>
<div class="line"><span class="lineno"> 2423</span>    <span class="keywordflow">if</span> image.get_shape().is_fully_defined():</div>
<div class="line"><span class="lineno"> 2424</span>      <span class="keywordflow">if</span> image.get_shape()[0] &lt; image.get_shape()[1]:</div>
<div class="line"><span class="lineno"> 2425</span>        new_image = _resize_landscape_image(image)</div>
<div class="line"><span class="lineno"> 2426</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2427</span>        new_image = _resize_portrait_image(image)</div>
<div class="line"><span class="lineno"> 2428</span>      new_size = tf.constant(new_image.get_shape().as_list())</div>
<div class="line"><span class="lineno"> 2429</span>    <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno"> 2430</span>      new_image = tf.cond(</div>
<div class="line"><span class="lineno"> 2431</span>          tf.less(tf.shape(image)[0], tf.shape(image)[1]),</div>
<div class="line"><span class="lineno"> 2432</span>          <span class="keyword">lambda</span>: _resize_landscape_image(image),</div>
<div class="line"><span class="lineno"> 2433</span>          <span class="keyword">lambda</span>: _resize_portrait_image(image))</div>
<div class="line"><span class="lineno"> 2434</span>      new_size = tf.shape(new_image)</div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span>    <span class="keywordflow">if</span> pad_to_max_dimension:</div>
<div class="line"><span class="lineno"> 2437</span>      channels = tf.unstack(new_image, axis=2)</div>
<div class="line"><span class="lineno"> 2438</span>      <span class="keywordflow">if</span> len(channels) != len(per_channel_pad_value):</div>
<div class="line"><span class="lineno"> 2439</span>        <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Number of channels must be equal to the length of &#39;</span></div>
<div class="line"><span class="lineno"> 2440</span>                         <span class="stringliteral">&#39;per-channel pad value.&#39;</span>)</div>
<div class="line"><span class="lineno"> 2441</span>      new_image = tf.stack(</div>
<div class="line"><span class="lineno"> 2442</span>          [</div>
<div class="line"><span class="lineno"> 2443</span>              tf.pad(</div>
<div class="line"><span class="lineno"> 2444</span>                  channels[i], [[0, max_dimension - new_size[0]],</div>
<div class="line"><span class="lineno"> 2445</span>                                [0, max_dimension - new_size[1]]],</div>
<div class="line"><span class="lineno"> 2446</span>                  constant_values=per_channel_pad_value[i])</div>
<div class="line"><span class="lineno"> 2447</span>              <span class="keywordflow">for</span> i <span class="keywordflow">in</span> range(len(channels))</div>
<div class="line"><span class="lineno"> 2448</span>          ],</div>
<div class="line"><span class="lineno"> 2449</span>          axis=2)</div>
<div class="line"><span class="lineno"> 2450</span>      new_image.set_shape([max_dimension, max_dimension, 3])</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span>    result = [new_image]</div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2454</span>      new_masks = tf.expand_dims(masks, 3)</div>
<div class="line"><span class="lineno"> 2455</span>      new_masks = tf.image.resize_images(</div>
<div class="line"><span class="lineno"> 2456</span>          new_masks,</div>
<div class="line"><span class="lineno"> 2457</span>          new_size[:-1],</div>
<div class="line"><span class="lineno"> 2458</span>          method=tf.image.ResizeMethod.NEAREST_NEIGHBOR,</div>
<div class="line"><span class="lineno"> 2459</span>          align_corners=align_corners)</div>
<div class="line"><span class="lineno"> 2460</span>      <span class="keywordflow">if</span> pad_to_max_dimension:</div>
<div class="line"><span class="lineno"> 2461</span>        new_masks = tf.image.pad_to_bounding_box(</div>
<div class="line"><span class="lineno"> 2462</span>            new_masks, 0, 0, max_dimension, max_dimension)</div>
<div class="line"><span class="lineno"> 2463</span>      new_masks = tf.squeeze(new_masks, 3)</div>
<div class="line"><span class="lineno"> 2464</span>      result.append(new_masks)</div>
<div class="line"><span class="lineno"> 2465</span> </div>
<div class="line"><span class="lineno"> 2466</span>    result.append(new_size)</div>
<div class="line"><span class="lineno"> 2467</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2468</span> </div>
<div class="line"><span class="lineno"> 2469</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a201500daba3cc396f12a14daa7c3e782" name="a201500daba3cc396f12a14daa7c3e782"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a201500daba3cc396f12a14daa7c3e782">&#9670;&#160;</a></span>retain_boxes_above_threshold()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.retain_boxes_above_threshold </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>0.0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Retains boxes whose label weight is above a given threshold.

If the label weight for a box is missing (represented by NaN), the box is
retained. The boxes that don't pass the threshold will not appear in the
returned tensor.

Args:
  boxes: float32 tensor of shape [num_instance, 4] representing boxes
    location in normalized coordinates.
  labels: rank 1 int32 tensor of shape [num_instance] containing the object
    classes.
  label_weights: float32 tensor of shape [num_instance] representing the
    weight for each box.
  label_confidences: float32 tensor of shape [num_instance] representing the
    confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
    [num_instances, height, width] containing instance masks. The masks are of
    the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
    [num_instances, num_keypoints, 2]. The keypoints are in y-x normalized
    coordinates.
  threshold: scalar python float.

Returns:
  retained_boxes: [num_retained_instance, 4]
  retianed_labels: [num_retained_instance]
  retained_label_weights: [num_retained_instance]

  If multiclass_scores, masks, or keypoints are not None, the function also
    returns:

  retained_multiclass_scores: [num_retained_instance, num_classes]
  retained_masks: [num_retained_instance, height, width]
  retained_keypoints: [num_retained_instance, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l00280">280</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  287</span>                                 threshold=0.0):</div>
<div class="line"><span class="lineno">  288</span>  <span class="stringliteral">&quot;&quot;&quot;Retains boxes whose label weight is above a given threshold.</span></div>
<div class="line"><span class="lineno">  289</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  290</span><span class="stringliteral">  If the label weight </span><span class="keywordflow">for</span> a box <span class="keywordflow">is</span> missing (represented by NaN), the box <span class="keywordflow">is</span></div>
<div class="line"><span class="lineno">  291</span>  retained. The boxes that don<span class="stringliteral">&#39;t pass the threshold will not appear in the</span></div>
<div class="line"><span class="lineno">  292</span><span class="stringliteral">  returned tensor.</span></div>
<div class="line"><span class="lineno">  293</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  294</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno">  295</span><span class="stringliteral">    boxes: float32 tensor of shape [num_instance, 4] representing boxes</span></div>
<div class="line"><span class="lineno">  296</span><span class="stringliteral">      location </span><span class="keywordflow">in</span> normalized coordinates.</div>
<div class="line"><span class="lineno">  297</span>    labels: rank 1 int32 tensor of shape [num_instance] containing the object</div>
<div class="line"><span class="lineno">  298</span>      classes.</div>
<div class="line"><span class="lineno">  299</span>    label_weights: float32 tensor of shape [num_instance] representing the</div>
<div class="line"><span class="lineno">  300</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno">  301</span>    label_confidences: float32 tensor of shape [num_instance] representing the</div>
<div class="line"><span class="lineno">  302</span>      confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno">  303</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno">  304</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno">  305</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno">  306</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  307</span>      [num_instances, height, width] containing instance masks. The masks are of</div>
<div class="line"><span class="lineno">  308</span>      the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno">  309</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno">  310</span>      [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x normalized</div>
<div class="line"><span class="lineno">  311</span>      coordinates.</div>
<div class="line"><span class="lineno">  312</span>    threshold: scalar python float.</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>  Returns:</div>
<div class="line"><span class="lineno">  315</span>    retained_boxes: [num_retained_instance, 4]</div>
<div class="line"><span class="lineno">  316</span>    retianed_labels: [num_retained_instance]</div>
<div class="line"><span class="lineno">  317</span>    retained_label_weights: [num_retained_instance]</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>    If multiclass_scores, masks, <span class="keywordflow">or</span> keypoints are <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also</div>
<div class="line"><span class="lineno">  320</span>      returns:</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>    retained_multiclass_scores: [num_retained_instance, num_classes]</div>
<div class="line"><span class="lineno">  323</span>    retained_masks: [num_retained_instance, height, width]</div>
<div class="line"><span class="lineno">  324</span>    retained_keypoints: [num_retained_instance, num_keypoints, 2]</div>
<div class="line"><span class="lineno">  325</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  326</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;RetainBoxesAboveThreshold&#39;</span>,</div>
<div class="line"><span class="lineno">  327</span>                     values=[boxes, labels, label_weights]):</div>
<div class="line"><span class="lineno">  328</span>    indices = tf.where(</div>
<div class="line"><span class="lineno">  329</span>        tf.logical_or(label_weights &gt; threshold, tf.is_nan(label_weights)))</div>
<div class="line"><span class="lineno">  330</span>    indices = tf.squeeze(indices, axis=1)</div>
<div class="line"><span class="lineno">  331</span>    retained_boxes = tf.gather(boxes, indices)</div>
<div class="line"><span class="lineno">  332</span>    retained_labels = tf.gather(labels, indices)</div>
<div class="line"><span class="lineno">  333</span>    retained_label_weights = tf.gather(label_weights, indices)</div>
<div class="line"><span class="lineno">  334</span>    result = [retained_boxes, retained_labels, retained_label_weights]</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  337</span>      retained_label_confidences = tf.gather(label_confidences, indices)</div>
<div class="line"><span class="lineno">  338</span>      result.append(retained_label_confidences)</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  341</span>      retained_multiclass_scores = tf.gather(multiclass_scores, indices)</div>
<div class="line"><span class="lineno">  342</span>      result.append(retained_multiclass_scores)</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  345</span>      retained_masks = tf.gather(masks, indices)</div>
<div class="line"><span class="lineno">  346</span>      result.append(retained_masks)</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  349</span>      retained_keypoints = tf.gather(keypoints, indices)</div>
<div class="line"><span class="lineno">  350</span>      result.append(retained_keypoints)</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>    <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1129985bff113d599809697210e2628" name="aa1129985bff113d599809697210e2628"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1129985bff113d599809697210e2628">&#9670;&#160;</a></span>rgb_to_gray()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.rgb_to_gray </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Converts a 3 channel RGB image to a 1 channel grayscale image.

Args:
  image: Rank 3 float32 tensor containing 1 image -&gt; [height, width, 3]
         with pixel values varying between [0, 1].

Returns:
  image: A single channel grayscale image -&gt; [image, height, 1].
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02737">2737</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2737</span><span class="keyword">def </span>rgb_to_gray(image):</div>
<div class="line"><span class="lineno"> 2738</span>  <span class="stringliteral">&quot;&quot;&quot;Converts a 3 channel RGB image to a 1 channel grayscale image.</span></div>
<div class="line"><span class="lineno"> 2739</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2740</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2741</span><span class="stringliteral">    image: Rank 3 float32 tensor containing 1 image -&gt; [height, width, 3]</span></div>
<div class="line"><span class="lineno"> 2742</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 2743</span> </div>
<div class="line"><span class="lineno"> 2744</span>  Returns:</div>
<div class="line"><span class="lineno"> 2745</span>    image: A single channel grayscale image -&gt; [image, height, 1].</div>
<div class="line"><span class="lineno"> 2746</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2747</span><span class="stringliteral">  </span><span class="keywordflow">return</span> _rgb_to_grayscale(image)</div>
<div class="line"><span class="lineno"> 2748</span> </div>
<div class="line"><span class="lineno"> 2749</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_aa1129985bff113d599809697210e2628_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aa1129985bff113d599809697210e2628_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aa1129985bff113d599809697210e2628_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_aa1129985bff113d599809697210e2628_cgraph">
<area shape="rect" title=" " alt="" coords="5,5,241,45"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a21e6f1c05910c4acb3c33771326514b5" title=" " alt="" coords="289,5,508,45"/>
<area shape="poly" title=" " alt="" coords="241,23,275,23,275,28,241,28"/>
</map>
</div>

</div>
</div>
<a id="a0b0e9e173acdfd6bdc495be778c346e3" name="a0b0e9e173acdfd6bdc495be778c346e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b0e9e173acdfd6bdc495be778c346e3">&#9670;&#160;</a></span>scale_boxes_to_pixel_coordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.scale_boxes_to_pixel_coordinates </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Scales boxes from normalized to pixel coordinates.

Args:
  image: A 3D float32 tensor of shape [height, width, channels].
  boxes: A 2D float32 tensor of shape [num_boxes, 4] containing the bounding
    boxes in normalized coordinates. Each row is of the form
    [ymin, xmin, ymax, xmax].
  keypoints: (optional) rank 3 float32 tensor with shape
    [num_instances, num_keypoints, 2]. The keypoints are in y-x normalized
    coordinates.

Returns:
  image: unchanged input image.
  scaled_boxes: a 2D float32 tensor of shape [num_boxes, 4] containing the
    bounding boxes in pixel coordinates.
  scaled_keypoints: a 3D float32 tensor with shape
    [num_instances, num_keypoints, 2] containing the keypoints in pixel
    coordinates.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02595">2595</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2595</span><span class="keyword">def </span>scale_boxes_to_pixel_coordinates(image, boxes, keypoints=None):</div>
<div class="line"><span class="lineno"> 2596</span>  <span class="stringliteral">&quot;&quot;&quot;Scales boxes from normalized to pixel coordinates.</span></div>
<div class="line"><span class="lineno"> 2597</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2598</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2599</span><span class="stringliteral">    image: A 3D float32 tensor of shape [height, width, channels].</span></div>
<div class="line"><span class="lineno"> 2600</span><span class="stringliteral">    boxes: A 2D float32 tensor of shape [num_boxes, 4] containing the bounding</span></div>
<div class="line"><span class="lineno"> 2601</span><span class="stringliteral">      boxes </span><span class="keywordflow">in</span> normalized coordinates. Each row <span class="keywordflow">is</span> of the form</div>
<div class="line"><span class="lineno"> 2602</span>      [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 2603</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2604</span>      [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x normalized</div>
<div class="line"><span class="lineno"> 2605</span>      coordinates.</div>
<div class="line"><span class="lineno"> 2606</span> </div>
<div class="line"><span class="lineno"> 2607</span>  Returns:</div>
<div class="line"><span class="lineno"> 2608</span>    image: unchanged input image.</div>
<div class="line"><span class="lineno"> 2609</span>    scaled_boxes: a 2D float32 tensor of shape [num_boxes, 4] containing the</div>
<div class="line"><span class="lineno"> 2610</span>      bounding boxes <span class="keywordflow">in</span> pixel coordinates.</div>
<div class="line"><span class="lineno"> 2611</span>    scaled_keypoints: a 3D float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2612</span>      [num_instances, num_keypoints, 2] containing the keypoints <span class="keywordflow">in</span> pixel</div>
<div class="line"><span class="lineno"> 2613</span>      coordinates.</div>
<div class="line"><span class="lineno"> 2614</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2615</span><span class="stringliteral">  boxlist = box_list.BoxList(boxes)</span></div>
<div class="line"><span class="lineno"> 2616</span><span class="stringliteral">  image_height = tf.shape(image)[0]</span></div>
<div class="line"><span class="lineno"> 2617</span><span class="stringliteral">  image_width = tf.shape(image)[1]</span></div>
<div class="line"><span class="lineno"> 2618</span><span class="stringliteral">  scaled_boxes = box_list_ops.scale(boxlist, image_height, image_width).get()</span></div>
<div class="line"><span class="lineno"> 2619</span><span class="stringliteral">  result = [image, scaled_boxes]</span></div>
<div class="line"><span class="lineno"> 2620</span><span class="stringliteral">  </span><span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2621</span>    scaled_keypoints = keypoint_ops.scale(keypoints, image_height, image_width)</div>
<div class="line"><span class="lineno"> 2622</span>    result.append(scaled_keypoints)</div>
<div class="line"><span class="lineno"> 2623</span>  <span class="keywordflow">return</span> tuple(result)</div>
<div class="line"><span class="lineno"> 2624</span> </div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span><span class="comment"># TODO(alirezafathi): Investigate if instead the function should return None if</span></div>
<div class="line"><span class="lineno"> 2627</span><span class="comment"># masks is None.</span></div>
<div class="line"><span class="lineno"> 2628</span><span class="comment"># pylint: disable=g-doc-return-or-yield</span></div>
</div><!-- fragment -->
</div>
</div>
<a id="a91a2c48d4f04433025c2994248222729" name="a91a2c48d4f04433025c2994248222729"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a91a2c48d4f04433025c2994248222729">&#9670;&#160;</a></span>ssd_random_crop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.ssd_random_crop </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>((0.5,&#160;2.0),)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>((0.1,&#160;1.0),)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>(True,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>(0.15,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Random crop preprocessing with default parameters as in SSD paper.

Liu et al., SSD: Single shot multibox detector.
For further information on random crop preprocessing refer to RandomCrop
function above.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: rank 1 float32 tensor containing the weights.
  label_confidences: rank 1 float32 tensor containing the confidences.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If label_weights, multiclass_scores, masks, or keypoints  is not None, the
  function also returns:
  label_weights: rank 1 float32 tensor with shape [num_instances].
  multiclass_scores: rank 2 float32 tensor with shape
                     [num_instances, num_classes]
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02859">2859</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2874</span>                    preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 2875</span>  <span class="stringliteral">&quot;&quot;&quot;Random crop preprocessing with default parameters as in SSD paper.</span></div>
<div class="line"><span class="lineno"> 2876</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2877</span><span class="stringliteral">  Liu et al., SSD: Single shot multibox detector.</span></div>
<div class="line"><span class="lineno"> 2878</span><span class="stringliteral">  For further information on random crop preprocessing refer to RandomCrop</span></div>
<div class="line"><span class="lineno"> 2879</span><span class="stringliteral">  function above.</span></div>
<div class="line"><span class="lineno"> 2880</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2881</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2882</span><span class="stringliteral">    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 2883</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 2884</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 2885</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 2886</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 2887</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 2888</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 2889</span>    label_weights: rank 1 float32 tensor containing the weights.</div>
<div class="line"><span class="lineno"> 2890</span>    label_confidences: rank 1 float32 tensor containing the confidences.</div>
<div class="line"><span class="lineno"> 2891</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 2892</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 2893</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 2894</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2895</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 2896</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 2897</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2898</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 2899</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 2900</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 2901</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 2902</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 2903</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 2904</span>                original image.</div>
<div class="line"><span class="lineno"> 2905</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 2906</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 2907</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 2908</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 2909</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 2910</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 2911</span>                 original image.</div>
<div class="line"><span class="lineno"> 2912</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 2913</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 2914</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 2915</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 2916</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 2917</span> </div>
<div class="line"><span class="lineno"> 2918</span>  Returns:</div>
<div class="line"><span class="lineno"> 2919</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 2920</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 2921</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 2922</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 2923</span> </div>
<div class="line"><span class="lineno"> 2924</span>    If label_weights, multiclass_scores, masks, <span class="keywordflow">or</span> keypoints  <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the</div>
<div class="line"><span class="lineno"> 2925</span>    function also returns:</div>
<div class="line"><span class="lineno"> 2926</span>    label_weights: rank 1 float32 tensor <span class="keyword">with</span> shape [num_instances].</div>
<div class="line"><span class="lineno"> 2927</span>    multiclass_scores: rank 2 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2928</span>                       [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 2929</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 2930</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 2931</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 2932</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 2933</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2934</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2935</span><span class="stringliteral">  </span><span class="keyword">def </span>random_crop_selector(selected_result, index):</div>
<div class="line"><span class="lineno"> 2936</span>    <span class="stringliteral">&quot;&quot;&quot;Applies random_crop_image to selected result.</span></div>
<div class="line"><span class="lineno"> 2937</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2938</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno"> 2939</span><span class="stringliteral">      selected_result: A tuple containing image, boxes, labels, keypoints (</span><span class="keywordflow">if</span></div>
<div class="line"><span class="lineno"> 2940</span>                       <span class="keywordflow">not</span> <span class="keywordtype">None</span>), <span class="keywordflow">and</span> masks (<span class="keywordflow">if</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>).</div>
<div class="line"><span class="lineno"> 2941</span>      index: The index that was randomly selected.</div>
<div class="line"><span class="lineno"> 2942</span> </div>
<div class="line"><span class="lineno"> 2943</span>    Returns: A tuple containing image, boxes, labels, keypoints (<span class="keywordflow">if</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 2944</span>             <span class="keywordflow">and</span> masks (<span class="keywordflow">if</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>).</div>
<div class="line"><span class="lineno"> 2945</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2946</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2947</span><span class="stringliteral">    i = 3</span></div>
<div class="line"><span class="lineno"> 2948</span><span class="stringliteral">    image, boxes, labels = selected_result[:i]</span></div>
<div class="line"><span class="lineno"> 2949</span><span class="stringliteral">    selected_label_weights = </span><span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2950</span>    selected_label_confidences = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2951</span>    selected_multiclass_scores = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2952</span>    selected_masks = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2953</span>    selected_keypoints = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 2954</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2955</span>      selected_label_weights = selected_result[i]</div>
<div class="line"><span class="lineno"> 2956</span>      i += 1</div>
<div class="line"><span class="lineno"> 2957</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2958</span>      selected_label_confidences = selected_result[i]</div>
<div class="line"><span class="lineno"> 2959</span>      i += 1</div>
<div class="line"><span class="lineno"> 2960</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2961</span>      selected_multiclass_scores = selected_result[i]</div>
<div class="line"><span class="lineno"> 2962</span>      i += 1</div>
<div class="line"><span class="lineno"> 2963</span>    <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2964</span>      selected_masks = selected_result[i]</div>
<div class="line"><span class="lineno"> 2965</span>      i += 1</div>
<div class="line"><span class="lineno"> 2966</span>    <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 2967</span>      selected_keypoints = selected_result[i]</div>
<div class="line"><span class="lineno"> 2968</span> </div>
<div class="line"><span class="lineno"> 2969</span>    <span class="keywordflow">return</span> random_crop_image(</div>
<div class="line"><span class="lineno"> 2970</span>        image=image,</div>
<div class="line"><span class="lineno"> 2971</span>        boxes=boxes,</div>
<div class="line"><span class="lineno"> 2972</span>        labels=labels,</div>
<div class="line"><span class="lineno"> 2973</span>        label_weights=selected_label_weights,</div>
<div class="line"><span class="lineno"> 2974</span>        label_confidences=selected_label_confidences,</div>
<div class="line"><span class="lineno"> 2975</span>        multiclass_scores=selected_multiclass_scores,</div>
<div class="line"><span class="lineno"> 2976</span>        masks=selected_masks,</div>
<div class="line"><span class="lineno"> 2977</span>        keypoints=selected_keypoints,</div>
<div class="line"><span class="lineno"> 2978</span>        min_object_covered=min_object_covered[index],</div>
<div class="line"><span class="lineno"> 2979</span>        aspect_ratio_range=aspect_ratio_range[index],</div>
<div class="line"><span class="lineno"> 2980</span>        area_range=area_range[index],</div>
<div class="line"><span class="lineno"> 2981</span>        overlap_thresh=overlap_thresh[index],</div>
<div class="line"><span class="lineno"> 2982</span>        clip_boxes=clip_boxes[index],</div>
<div class="line"><span class="lineno"> 2983</span>        random_coef=random_coef[index],</div>
<div class="line"><span class="lineno"> 2984</span>        seed=seed,</div>
<div class="line"><span class="lineno"> 2985</span>        preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 2986</span> </div>
<div class="line"><span class="lineno"> 2987</span>  result = _apply_with_random_selector_tuples(</div>
<div class="line"><span class="lineno"> 2988</span>      tuple(</div>
<div class="line"><span class="lineno"> 2989</span>          t <span class="keywordflow">for</span> t <span class="keywordflow">in</span> (image, boxes, labels, label_weights, label_confidences,</div>
<div class="line"><span class="lineno"> 2990</span>                      multiclass_scores, masks, keypoints) <span class="keywordflow">if</span> t <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 2991</span>      random_crop_selector,</div>
<div class="line"><span class="lineno"> 2992</span>      num_cases=len(min_object_covered),</div>
<div class="line"><span class="lineno"> 2993</span>      preprocess_vars_cache=preprocess_vars_cache,</div>
<div class="line"><span class="lineno"> 2994</span>      key=preprocessor_cache.PreprocessorCache.SSD_CROP_SELECTOR_ID)</div>
<div class="line"><span class="lineno"> 2995</span>  <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 2996</span> </div>
<div class="line"><span class="lineno"> 2997</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,244,75"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c" title=" " alt="" coords="601,5,836,45"/>
<area shape="poly" title=" " alt="" coords="244,46,588,29,588,34,244,51"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="292,63,553,103"/>
<area shape="poly" title=" " alt="" coords="245,63,279,66,278,72,244,69"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="884,63,1125,103"/>
<area shape="poly" title=" " alt="" coords="820,43,892,57,891,63,819,48"/>
<area shape="poly" title=" " alt="" coords="554,80,870,80,870,85,554,85"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="609,120,828,160"/>
<area shape="poly" title=" " alt="" coords="527,100,602,115,601,120,526,105"/>
<area shape="poly" title=" " alt="" coords="819,117,891,103,892,108,820,123"/>
</map>
</div>
<div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_icgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_icgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_icgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a91a2c48d4f04433025c2994248222729_icgraph">
<area shape="rect" title=" " alt="" coords="297,37,536,77"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae771c28299fc187bd974238ae577fb02" title=" " alt="" coords="8,5,247,45"/>
<area shape="poly" title=" " alt="" coords="283,45,247,41,247,36,284,40"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ac4cb1ebd49aea7a953dff66c0b64cc19" title=" " alt="" coords="5,69,249,109"/>
<area shape="poly" title=" " alt="" coords="284,75,250,79,249,73,283,69"/>
</map>
</div>

</div>
</div>
<a id="ae771c28299fc187bd974238ae577fb02" name="ae771c28299fc187bd974238ae577fb02"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae771c28299fc187bd974238ae577fb02">&#9670;&#160;</a></span>ssd_random_crop_fixed_aspect_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.ssd_random_crop_fixed_aspect_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>((0.1,&#160;1.0),)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>(True,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>(0.15,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Random crop preprocessing with default parameters as in SSD paper.

Liu et al., SSD: Single shot multibox detector.
For further information on random crop preprocessing refer to RandomCrop
function above.

The only difference is that the aspect ratio of the crops are fixed.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: (optional) float32 tensor of shape [num_instances]
    representing the confidences for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio: aspect ratio of the cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If multiclass_scores, masks, or keypoints is not None, the function also
    returns:

  multiclass_scores: rank 2 float32 tensor with shape
                     [num_instances, num_classes]
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l03113">3113</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3129</span>    preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 3130</span>  <span class="stringliteral">&quot;&quot;&quot;Random crop preprocessing with default parameters as in SSD paper.</span></div>
<div class="line"><span class="lineno"> 3131</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3132</span><span class="stringliteral">  Liu et al., SSD: Single shot multibox detector.</span></div>
<div class="line"><span class="lineno"> 3133</span><span class="stringliteral">  For further information on random crop preprocessing refer to RandomCrop</span></div>
<div class="line"><span class="lineno"> 3134</span><span class="stringliteral">  function above.</span></div>
<div class="line"><span class="lineno"> 3135</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3136</span><span class="stringliteral">  The only difference </span><span class="keywordflow">is</span> that the aspect ratio of the crops are fixed.</div>
<div class="line"><span class="lineno"> 3137</span> </div>
<div class="line"><span class="lineno"> 3138</span>  Args:</div>
<div class="line"><span class="lineno"> 3139</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 3140</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 3141</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 3142</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 3143</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 3144</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 3145</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 3146</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 3147</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3148</span>    label_confidences: (optional) float32 tensor of shape [num_instances]</div>
<div class="line"><span class="lineno"> 3149</span>      representing the confidences <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3150</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 3151</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 3152</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 3153</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3154</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 3155</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 3156</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3157</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 3158</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 3159</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 3160</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 3161</span>    aspect_ratio: aspect ratio of the cropped image.</div>
<div class="line"><span class="lineno"> 3162</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 3163</span>                original image.</div>
<div class="line"><span class="lineno"> 3164</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 3165</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 3166</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 3167</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 3168</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 3169</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 3170</span>                 original image.</div>
<div class="line"><span class="lineno"> 3171</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 3172</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 3173</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 3174</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 3175</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 3176</span> </div>
<div class="line"><span class="lineno"> 3177</span>  Returns:</div>
<div class="line"><span class="lineno"> 3178</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 3179</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 3180</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 3181</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 3182</span> </div>
<div class="line"><span class="lineno"> 3183</span>    If multiclass_scores, masks, <span class="keywordflow">or</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also</div>
<div class="line"><span class="lineno"> 3184</span>      returns:</div>
<div class="line"><span class="lineno"> 3185</span> </div>
<div class="line"><span class="lineno"> 3186</span>    multiclass_scores: rank 2 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3187</span>                       [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 3188</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 3189</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 3190</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3191</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 3192</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3193</span><span class="stringliteral">  aspect_ratio_range = ((aspect_ratio, aspect_ratio),) * len(area_range)</span></div>
<div class="line"><span class="lineno"> 3194</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3195</span><span class="stringliteral">  crop_result = ssd_random_crop(</span></div>
<div class="line"><span class="lineno"> 3196</span><span class="stringliteral">      image,</span></div>
<div class="line"><span class="lineno"> 3197</span><span class="stringliteral">      boxes,</span></div>
<div class="line"><span class="lineno"> 3198</span><span class="stringliteral">      labels,</span></div>
<div class="line"><span class="lineno"> 3199</span><span class="stringliteral">      label_weights=label_weights,</span></div>
<div class="line"><span class="lineno"> 3200</span><span class="stringliteral">      label_confidences=label_confidences,</span></div>
<div class="line"><span class="lineno"> 3201</span><span class="stringliteral">      multiclass_scores=multiclass_scores,</span></div>
<div class="line"><span class="lineno"> 3202</span><span class="stringliteral">      masks=masks,</span></div>
<div class="line"><span class="lineno"> 3203</span><span class="stringliteral">      keypoints=keypoints,</span></div>
<div class="line"><span class="lineno"> 3204</span><span class="stringliteral">      min_object_covered=min_object_covered,</span></div>
<div class="line"><span class="lineno"> 3205</span><span class="stringliteral">      aspect_ratio_range=aspect_ratio_range,</span></div>
<div class="line"><span class="lineno"> 3206</span><span class="stringliteral">      area_range=area_range,</span></div>
<div class="line"><span class="lineno"> 3207</span><span class="stringliteral">      overlap_thresh=overlap_thresh,</span></div>
<div class="line"><span class="lineno"> 3208</span><span class="stringliteral">      clip_boxes=clip_boxes,</span></div>
<div class="line"><span class="lineno"> 3209</span><span class="stringliteral">      random_coef=random_coef,</span></div>
<div class="line"><span class="lineno"> 3210</span><span class="stringliteral">      seed=seed,</span></div>
<div class="line"><span class="lineno"> 3211</span><span class="stringliteral">      preprocess_vars_cache=preprocess_vars_cache)</span></div>
<div class="line"><span class="lineno"> 3212</span><span class="stringliteral">  i = 3</span></div>
<div class="line"><span class="lineno"> 3213</span><span class="stringliteral">  new_image, new_boxes, new_labels = crop_result[:i]</span></div>
<div class="line"><span class="lineno"> 3214</span><span class="stringliteral">  new_label_weights = </span><span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3215</span>  new_label_confidences = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3216</span>  new_multiclass_scores = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3217</span>  new_masks = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3218</span>  new_keypoints = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3219</span>  <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3220</span>    new_label_weights = crop_result[i]</div>
<div class="line"><span class="lineno"> 3221</span>    i += 1</div>
<div class="line"><span class="lineno"> 3222</span>  <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3223</span>    new_label_confidences = crop_result[i]</div>
<div class="line"><span class="lineno"> 3224</span>    i += 1</div>
<div class="line"><span class="lineno"> 3225</span>  <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3226</span>    new_multiclass_scores = crop_result[i]</div>
<div class="line"><span class="lineno"> 3227</span>    i += 1</div>
<div class="line"><span class="lineno"> 3228</span>  <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3229</span>    new_masks = crop_result[i]</div>
<div class="line"><span class="lineno"> 3230</span>    i += 1</div>
<div class="line"><span class="lineno"> 3231</span>  <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3232</span>    new_keypoints = crop_result[i]</div>
<div class="line"><span class="lineno"> 3233</span> </div>
<div class="line"><span class="lineno"> 3234</span>  result = random_crop_to_aspect_ratio(</div>
<div class="line"><span class="lineno"> 3235</span>      new_image,</div>
<div class="line"><span class="lineno"> 3236</span>      new_boxes,</div>
<div class="line"><span class="lineno"> 3237</span>      new_labels,</div>
<div class="line"><span class="lineno"> 3238</span>      label_weights=new_label_weights,</div>
<div class="line"><span class="lineno"> 3239</span>      label_confidences=new_label_confidences,</div>
<div class="line"><span class="lineno"> 3240</span>      multiclass_scores=new_multiclass_scores,</div>
<div class="line"><span class="lineno"> 3241</span>      masks=new_masks,</div>
<div class="line"><span class="lineno"> 3242</span>      keypoints=new_keypoints,</div>
<div class="line"><span class="lineno"> 3243</span>      aspect_ratio=aspect_ratio,</div>
<div class="line"><span class="lineno"> 3244</span>      clip_boxes=clip_boxes,</div>
<div class="line"><span class="lineno"> 3245</span>      seed=seed,</div>
<div class="line"><span class="lineno"> 3246</span>      preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 3247</span> </div>
<div class="line"><span class="lineno"> 3248</span>  <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 3249</span> </div>
<div class="line"><span class="lineno"> 3250</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae771c28299fc187bd974238ae577fb02_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae771c28299fc187bd974238ae577fb02_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae771c28299fc187bd974238ae577fb02_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ae771c28299fc187bd974238ae577fb02_cgraph">
<area shape="rect" title=" " alt="" coords="5,62,244,102"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#aed03769aeaaf1e8b96f676996f870e8c" title=" " alt="" coords="292,30,553,70"/>
<area shape="poly" title=" " alt="" coords="244,66,278,63,279,68,245,72"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="303,94,542,134"/>
<area shape="poly" title=" " alt="" coords="245,92,290,97,289,102,244,97"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="1193,90,1435,130"/>
<area shape="poly" title=" " alt="" coords="527,27,601,18,755,6,875,4,995,16,1146,46,1203,62,1256,82,1254,87,1201,67,1145,51,994,21,875,9,755,11,602,23,528,32"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="623,32,841,72"/>
<area shape="poly" title=" " alt="" coords="554,48,609,49,609,54,554,54"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c" title=" " alt="" coords="911,60,1145,100"/>
<area shape="poly" title=" " alt="" coords="542,105,897,85,897,90,542,110"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="601,147,863,187"/>
<area shape="poly" title=" " alt="" coords="540,131,602,142,601,147,539,136"/>
<area shape="poly" title=" " alt="" coords="1146,90,1180,93,1179,99,1145,95"/>
<area shape="poly" title=" " alt="" coords="863,152,1179,120,1180,126,863,157"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="919,175,1137,215"/>
<area shape="poly" title=" " alt="" coords="863,177,905,181,905,186,863,182"/>
<area shape="poly" title=" " alt="" coords="1095,172,1232,131,1234,136,1097,178"/>
</map>
</div>

</div>
</div>
<a id="a6141ebcaa14a24e9903a50821b45b576" name="a6141ebcaa14a24e9903a50821b45b576"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6141ebcaa14a24e9903a50821b45b576">&#9670;&#160;</a></span>ssd_random_crop_pad()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.ssd_random_crop_pad </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>(0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>((0.5,&#160;2.0),)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>((0.1,&#160;1.0),)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>(0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>(True,)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>(0.15,)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_padded_size_ratio</em> = <code>((1.0,&#160;1.0),)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_padded_size_ratio</em> = <code>((2.0,&#160;2.0),)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>pad_color</em> = <code>(None,)&#160;*&#160;6</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Random crop preprocessing with default parameters as in SSD paper.

Liu et al., SSD: Single shot multibox detector.
For further information on random crop preprocessing refer to RandomCrop
function above.

Args:
  image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: float32 tensor of shape [num_instances] representing the
    confidences for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  min_padded_size_ratio: min ratio of padded image height and width to the
                         input image's height and width.
  max_padded_size_ratio: max ratio of padded image height and width to the
                         input image's height and width.
  pad_color: padding color. A rank 1 tensor of [3] with dtype=tf.float32.
             if set as None, it will be set to average color of the randomly
             cropped image.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: Image shape will be [new_height, new_width, channels].
  boxes: boxes which is the same rank as input boxes. Boxes are in normalized
         form.
  new_labels: new labels.
  new_label_weights: new label weights.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02998">2998</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3014</span>                        preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 3015</span>  <span class="stringliteral">&quot;&quot;&quot;Random crop preprocessing with default parameters as in SSD paper.</span></div>
<div class="line"><span class="lineno"> 3016</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3017</span><span class="stringliteral">  Liu et al., SSD: Single shot multibox detector.</span></div>
<div class="line"><span class="lineno"> 3018</span><span class="stringliteral">  For further information on random crop preprocessing refer to RandomCrop</span></div>
<div class="line"><span class="lineno"> 3019</span><span class="stringliteral">  function above.</span></div>
<div class="line"><span class="lineno"> 3020</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3021</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 3022</span><span class="stringliteral">    image: rank 3 float32 tensor containing 1 image -&gt; [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 3023</span><span class="stringliteral">           </span><span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 3024</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 3025</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 3026</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 3027</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 3028</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 3029</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 3030</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3031</span>    label_confidences: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 3032</span>      confidences <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3033</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 3034</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 3035</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 3036</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 3037</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 3038</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 3039</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 3040</span>                original image.</div>
<div class="line"><span class="lineno"> 3041</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 3042</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 3043</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 3044</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 3045</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 3046</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 3047</span>                 original image.</div>
<div class="line"><span class="lineno"> 3048</span>    min_padded_size_ratio: min ratio of padded image height <span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 3049</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 3050</span><span class="stringliteral">    max_padded_size_ratio: max ratio of padded image height </span><span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 3051</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 3052</span><span class="stringliteral">    pad_color: padding color. A rank 1 tensor of [3] </span><span class="keyword">with</span> dtype=tf.float32.</div>
<div class="line"><span class="lineno"> 3053</span>               <span class="keywordflow">if</span> set <span class="keyword">as</span> <span class="keywordtype">None</span>, it will be set to average color of the randomly</div>
<div class="line"><span class="lineno"> 3054</span>               cropped image.</div>
<div class="line"><span class="lineno"> 3055</span>    seed: random seed.</div>
<div class="line"><span class="lineno"> 3056</span>    preprocess_vars_cache: PreprocessorCache object that records previously</div>
<div class="line"><span class="lineno"> 3057</span>                           performed augmentations. Updated <span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 3058</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 3059</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 3060</span> </div>
<div class="line"><span class="lineno"> 3061</span>  Returns:</div>
<div class="line"><span class="lineno"> 3062</span>    image: Image shape will be [new_height, new_width, channels].</div>
<div class="line"><span class="lineno"> 3063</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes. Boxes are <span class="keywordflow">in</span> normalized</div>
<div class="line"><span class="lineno"> 3064</span>           form.</div>
<div class="line"><span class="lineno"> 3065</span>    new_labels: new labels.</div>
<div class="line"><span class="lineno"> 3066</span>    new_label_weights: new label weights.</div>
<div class="line"><span class="lineno"> 3067</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3068</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3069</span><span class="stringliteral">  </span><span class="keyword">def </span>random_crop_pad_selector(image_boxes_labels, index):</div>
<div class="line"><span class="lineno"> 3070</span>    <span class="stringliteral">&quot;&quot;&quot;Random crop preprocessing helper.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3071</span>    i = 3</div>
<div class="line"><span class="lineno"> 3072</span>    image, boxes, labels = image_boxes_labels[:i]</div>
<div class="line"><span class="lineno"> 3073</span>    selected_label_weights = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3074</span>    selected_label_confidences = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3075</span>    selected_multiclass_scores = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3076</span>    <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3077</span>      selected_label_weights = image_boxes_labels[i]</div>
<div class="line"><span class="lineno"> 3078</span>      i += 1</div>
<div class="line"><span class="lineno"> 3079</span>    <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3080</span>      selected_label_confidences = image_boxes_labels[i]</div>
<div class="line"><span class="lineno"> 3081</span>      i += 1</div>
<div class="line"><span class="lineno"> 3082</span>    <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3083</span>      selected_multiclass_scores = image_boxes_labels[i]</div>
<div class="line"><span class="lineno"> 3084</span> </div>
<div class="line"><span class="lineno"> 3085</span>    <span class="keywordflow">return</span> random_crop_pad_image(</div>
<div class="line"><span class="lineno"> 3086</span>        image,</div>
<div class="line"><span class="lineno"> 3087</span>        boxes,</div>
<div class="line"><span class="lineno"> 3088</span>        labels,</div>
<div class="line"><span class="lineno"> 3089</span>        label_weights=selected_label_weights,</div>
<div class="line"><span class="lineno"> 3090</span>        label_confidences=selected_label_confidences,</div>
<div class="line"><span class="lineno"> 3091</span>        multiclass_scores=selected_multiclass_scores,</div>
<div class="line"><span class="lineno"> 3092</span>        min_object_covered=min_object_covered[index],</div>
<div class="line"><span class="lineno"> 3093</span>        aspect_ratio_range=aspect_ratio_range[index],</div>
<div class="line"><span class="lineno"> 3094</span>        area_range=area_range[index],</div>
<div class="line"><span class="lineno"> 3095</span>        overlap_thresh=overlap_thresh[index],</div>
<div class="line"><span class="lineno"> 3096</span>        clip_boxes=clip_boxes[index],</div>
<div class="line"><span class="lineno"> 3097</span>        random_coef=random_coef[index],</div>
<div class="line"><span class="lineno"> 3098</span>        min_padded_size_ratio=min_padded_size_ratio[index],</div>
<div class="line"><span class="lineno"> 3099</span>        max_padded_size_ratio=max_padded_size_ratio[index],</div>
<div class="line"><span class="lineno"> 3100</span>        pad_color=pad_color[index],</div>
<div class="line"><span class="lineno"> 3101</span>        seed=seed,</div>
<div class="line"><span class="lineno"> 3102</span>        preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 3103</span> </div>
<div class="line"><span class="lineno"> 3104</span>  <span class="keywordflow">return</span> _apply_with_random_selector_tuples(</div>
<div class="line"><span class="lineno"> 3105</span>      tuple(t <span class="keywordflow">for</span> t <span class="keywordflow">in</span> (image, boxes, labels, label_weights, label_confidences,</div>
<div class="line"><span class="lineno"> 3106</span>                        multiclass_scores) <span class="keywordflow">if</span> t <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>),</div>
<div class="line"><span class="lineno"> 3107</span>      random_crop_pad_selector,</div>
<div class="line"><span class="lineno"> 3108</span>      num_cases=len(min_object_covered),</div>
<div class="line"><span class="lineno"> 3109</span>      preprocess_vars_cache=preprocess_vars_cache,</div>
<div class="line"><span class="lineno"> 3110</span>      key=preprocessor_cache.PreprocessorCache.SSD_CROP_PAD_SELECTOR_ID)</div>
<div class="line"><span class="lineno"> 3111</span> </div>
<div class="line"><span class="lineno"> 3112</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6141ebcaa14a24e9903a50821b45b576_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6141ebcaa14a24e9903a50821b45b576_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6141ebcaa14a24e9903a50821b45b576_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_a6141ebcaa14a24e9903a50821b45b576_cgraph">
<area shape="rect" title=" " alt="" coords="5,56,244,96"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c" title=" " alt="" coords="305,5,540,45"/>
<area shape="poly" title=" " alt="" coords="242,53,291,45,292,50,243,59"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ad862ff65e576da434816a69fd341b3ff" title=" " alt="" coords="292,88,553,128"/>
<area shape="poly" title=" " alt="" coords="245,86,279,90,278,95,244,91"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="1177,76,1419,116"/>
<area shape="poly" title=" " alt="" coords="540,28,810,44,1130,71,1164,74,1163,80,1129,76,809,50,540,34"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="601,88,863,128"/>
<area shape="poly" title=" " alt="" coords="554,105,587,105,587,111,554,111"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a052201bdd4a37a3579ad79d129b0f4dc" title=" " alt="" coords="601,161,863,201"/>
<area shape="poly" title=" " alt="" coords="508,125,634,156,633,161,507,131"/>
<area shape="poly" title=" " alt="" coords="863,92,911,89,1020,87,1129,89,1163,90,1163,95,1129,95,1020,93,911,95,863,98"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="911,104,1129,144"/>
<area shape="poly" title=" " alt="" coords="863,113,897,115,897,120,863,118"/>
<area shape="poly" title=" " alt="" coords="1129,110,1163,107,1164,112,1130,116"/>
<area shape="poly" title=" " alt="" coords="863,179,992,173,1061,165,1129,153,1185,138,1238,119,1240,124,1187,143,1130,159,1062,170,993,178,863,185"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a3338c3143bc5c5a5f5cbf32be983a2f7" title=" " alt="" coords="911,219,1129,259"/>
<area shape="poly" title=" " alt="" coords="834,199,906,213,905,219,833,204"/>
</map>
</div>

</div>
</div>
<a id="ac4cb1ebd49aea7a953dff66c0b64cc19" name="ac4cb1ebd49aea7a953dff66c0b64cc19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac4cb1ebd49aea7a953dff66c0b64cc19">&#9670;&#160;</a></span>ssd_random_crop_pad_fixed_aspect_ratio()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.ssd_random_crop_pad_fixed_aspect_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>boxes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>labels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_weights</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>label_confidences</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>multiclass_scores</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>masks</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>keypoints</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_object_covered</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio</em> = <code>1.0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>aspect_ratio_range</em> = <code>((0.5,&#160;2.0),)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>area_range</em> = <code>((0.1,&#160;1.0),)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>overlap_thresh</em> = <code>(0.0,&#160;0.1,&#160;0.3,&#160;0.5,&#160;0.7,&#160;0.9,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>clip_boxes</em> = <code>(True,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>random_coef</em> = <code>(0.15,)&#160;*&#160;7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_padded_size_ratio</em> = <code>(1.0,&#160;1.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_padded_size_ratio</em> = <code>(2.0,&#160;2.0)</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>seed</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>preprocess_vars_cache</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Random crop and pad preprocessing with default parameters as in SSD paper.

Liu et al., SSD: Single shot multibox detector.
For further information on random crop preprocessing refer to RandomCrop
function above.

The only difference is that after the initial crop, images are zero-padded
to a fixed aspect ratio instead of being resized to that aspect ratio.

Args:
  image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]
         with pixel values varying between [0, 1].
  boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].
         Boxes are in normalized form meaning their coordinates vary
         between [0, 1].
         Each row is in the form of [ymin, xmin, ymax, xmax].
  labels: rank 1 int32 tensor containing the object classes.
  label_weights: float32 tensor of shape [num_instances] representing the
    weight for each box.
  label_confidences: (optional) float32 tensor of shape [num_instances]
    representing the confidence for each box.
  multiclass_scores: (optional) float32 tensor of shape
    [num_instances, num_classes] representing the score for each box for each
    class.
  masks: (optional) rank 3 float32 tensor with shape
         [num_instances, height, width] containing instance masks. The masks
         are of the same height, width as the input `image`.
  keypoints: (optional) rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]. The keypoints are in y-x
             normalized coordinates.
  min_object_covered: the cropped image must cover at least this fraction of
                      at least one of the input bounding boxes.
  aspect_ratio: the final aspect ratio to pad to.
  aspect_ratio_range: allowed range for aspect ratio of cropped image.
  area_range: allowed range for area ratio between cropped image and the
              original image.
  overlap_thresh: minimum overlap thresh with new cropped
                  image to keep the box.
  clip_boxes: whether to clip the boxes to the cropped image.
  random_coef: a random coefficient that defines the chance of getting the
               original image. If random_coef is 0, we will always get the
               cropped image, and if it is 1.0, we will always get the
               original image.
  min_padded_size_ratio: min ratio of padded image height and width to the
                         input image's height and width.
  max_padded_size_ratio: max ratio of padded image height and width to the
                         input image's height and width.
  seed: random seed.
  preprocess_vars_cache: PreprocessorCache object that records previously
                         performed augmentations. Updated in-place. If this
                         function is called multiple times with the same
                         non-null cache, it will perform deterministically.

Returns:
  image: image which is the same rank as input image.
  boxes: boxes which is the same rank as input boxes.
         Boxes are in normalized form.
  labels: new labels.

  If multiclass_scores, masks, or keypoints is not None, the function also
  returns:

  multiclass_scores: rank 2 with shape [num_instances, num_classes]
  masks: rank 3 float32 tensor with shape [num_instances, height, width]
         containing instance masks.
  keypoints: rank 3 float32 tensor with shape
             [num_instances, num_keypoints, 2]
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l03251">3251</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3270</span>    preprocess_vars_cache=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno"> 3271</span>  <span class="stringliteral">&quot;&quot;&quot;Random crop and pad preprocessing with default parameters as in SSD paper.</span></div>
<div class="line"><span class="lineno"> 3272</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3273</span><span class="stringliteral">  Liu et al., SSD: Single shot multibox detector.</span></div>
<div class="line"><span class="lineno"> 3274</span><span class="stringliteral">  For further information on random crop preprocessing refer to RandomCrop</span></div>
<div class="line"><span class="lineno"> 3275</span><span class="stringliteral">  function above.</span></div>
<div class="line"><span class="lineno"> 3276</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 3277</span><span class="stringliteral">  The only difference </span><span class="keywordflow">is</span> that after the initial crop, images are zero-padded</div>
<div class="line"><span class="lineno"> 3278</span>  to a fixed aspect ratio instead of being resized to that aspect ratio.</div>
<div class="line"><span class="lineno"> 3279</span> </div>
<div class="line"><span class="lineno"> 3280</span>  Args:</div>
<div class="line"><span class="lineno"> 3281</span>    image: rank 3 float32 tensor contains 1 image -&gt; [height, width, channels]</div>
<div class="line"><span class="lineno"> 3282</span>           <span class="keyword">with</span> pixel values varying between [0, 1].</div>
<div class="line"><span class="lineno"> 3283</span>    boxes: rank 2 float32 tensor containing the bounding boxes -&gt; [N, 4].</div>
<div class="line"><span class="lineno"> 3284</span>           Boxes are <span class="keywordflow">in</span> normalized form meaning their coordinates vary</div>
<div class="line"><span class="lineno"> 3285</span>           between [0, 1].</div>
<div class="line"><span class="lineno"> 3286</span>           Each row <span class="keywordflow">is</span> <span class="keywordflow">in</span> the form of [ymin, xmin, ymax, xmax].</div>
<div class="line"><span class="lineno"> 3287</span>    labels: rank 1 int32 tensor containing the object classes.</div>
<div class="line"><span class="lineno"> 3288</span>    label_weights: float32 tensor of shape [num_instances] representing the</div>
<div class="line"><span class="lineno"> 3289</span>      weight <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3290</span>    label_confidences: (optional) float32 tensor of shape [num_instances]</div>
<div class="line"><span class="lineno"> 3291</span>      representing the confidence <span class="keywordflow">for</span> each box.</div>
<div class="line"><span class="lineno"> 3292</span>    multiclass_scores: (optional) float32 tensor of shape</div>
<div class="line"><span class="lineno"> 3293</span>      [num_instances, num_classes] representing the score <span class="keywordflow">for</span> each box <span class="keywordflow">for</span> each</div>
<div class="line"><span class="lineno"> 3294</span>      <span class="keyword">class</span>.</div>
<div class="line"><span class="lineno"> 3295</span>    masks: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3296</span>           [num_instances, height, width] containing instance masks. The masks</div>
<div class="line"><span class="lineno"> 3297</span>           are of the same height, width <span class="keyword">as</span> the input `image`.</div>
<div class="line"><span class="lineno"> 3298</span>    keypoints: (optional) rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3299</span>               [num_instances, num_keypoints, 2]. The keypoints are <span class="keywordflow">in</span> y-x</div>
<div class="line"><span class="lineno"> 3300</span>               normalized coordinates.</div>
<div class="line"><span class="lineno"> 3301</span>    min_object_covered: the cropped image must cover at least this fraction of</div>
<div class="line"><span class="lineno"> 3302</span>                        at least one of the input bounding boxes.</div>
<div class="line"><span class="lineno"> 3303</span>    aspect_ratio: the final aspect ratio to pad to.</div>
<div class="line"><span class="lineno"> 3304</span>    aspect_ratio_range: allowed range <span class="keywordflow">for</span> aspect ratio of cropped image.</div>
<div class="line"><span class="lineno"> 3305</span>    area_range: allowed range <span class="keywordflow">for</span> area ratio between cropped image <span class="keywordflow">and</span> the</div>
<div class="line"><span class="lineno"> 3306</span>                original image.</div>
<div class="line"><span class="lineno"> 3307</span>    overlap_thresh: minimum overlap thresh <span class="keyword">with</span> new cropped</div>
<div class="line"><span class="lineno"> 3308</span>                    image to keep the box.</div>
<div class="line"><span class="lineno"> 3309</span>    clip_boxes: whether to clip the boxes to the cropped image.</div>
<div class="line"><span class="lineno"> 3310</span>    random_coef: a random coefficient that defines the chance of getting the</div>
<div class="line"><span class="lineno"> 3311</span>                 original image. If random_coef <span class="keywordflow">is</span> 0, we will always get the</div>
<div class="line"><span class="lineno"> 3312</span>                 cropped image, <span class="keywordflow">and</span> <span class="keywordflow">if</span> it <span class="keywordflow">is</span> 1.0, we will always get the</div>
<div class="line"><span class="lineno"> 3313</span>                 original image.</div>
<div class="line"><span class="lineno"> 3314</span>    min_padded_size_ratio: min ratio of padded image height <span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 3315</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 3316</span><span class="stringliteral">    max_padded_size_ratio: max ratio of padded image height </span><span class="keywordflow">and</span> width to the</div>
<div class="line"><span class="lineno"> 3317</span>                           input image<span class="stringliteral">&#39;s height and width.</span></div>
<div class="line"><span class="lineno"> 3318</span><span class="stringliteral">    seed: random seed.</span></div>
<div class="line"><span class="lineno"> 3319</span><span class="stringliteral">    preprocess_vars_cache: PreprocessorCache object that records previously</span></div>
<div class="line"><span class="lineno"> 3320</span><span class="stringliteral">                           performed augmentations. Updated </span><span class="keywordflow">in</span>-place. If this</div>
<div class="line"><span class="lineno"> 3321</span>                           function <span class="keywordflow">is</span> called multiple times <span class="keyword">with</span> the same</div>
<div class="line"><span class="lineno"> 3322</span>                           non-null cache, it will perform deterministically.</div>
<div class="line"><span class="lineno"> 3323</span> </div>
<div class="line"><span class="lineno"> 3324</span>  Returns:</div>
<div class="line"><span class="lineno"> 3325</span>    image: image which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input image.</div>
<div class="line"><span class="lineno"> 3326</span>    boxes: boxes which <span class="keywordflow">is</span> the same rank <span class="keyword">as</span> input boxes.</div>
<div class="line"><span class="lineno"> 3327</span>           Boxes are <span class="keywordflow">in</span> normalized form.</div>
<div class="line"><span class="lineno"> 3328</span>    labels: new labels.</div>
<div class="line"><span class="lineno"> 3329</span> </div>
<div class="line"><span class="lineno"> 3330</span>    If multiclass_scores, masks, <span class="keywordflow">or</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>, the function also</div>
<div class="line"><span class="lineno"> 3331</span>    returns:</div>
<div class="line"><span class="lineno"> 3332</span> </div>
<div class="line"><span class="lineno"> 3333</span>    multiclass_scores: rank 2 <span class="keyword">with</span> shape [num_instances, num_classes]</div>
<div class="line"><span class="lineno"> 3334</span>    masks: rank 3 float32 tensor <span class="keyword">with</span> shape [num_instances, height, width]</div>
<div class="line"><span class="lineno"> 3335</span>           containing instance masks.</div>
<div class="line"><span class="lineno"> 3336</span>    keypoints: rank 3 float32 tensor <span class="keyword">with</span> shape</div>
<div class="line"><span class="lineno"> 3337</span>               [num_instances, num_keypoints, 2]</div>
<div class="line"><span class="lineno"> 3338</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 3339</span><span class="stringliteral">  crop_result = ssd_random_crop(</span></div>
<div class="line"><span class="lineno"> 3340</span><span class="stringliteral">      image,</span></div>
<div class="line"><span class="lineno"> 3341</span><span class="stringliteral">      boxes,</span></div>
<div class="line"><span class="lineno"> 3342</span><span class="stringliteral">      labels,</span></div>
<div class="line"><span class="lineno"> 3343</span><span class="stringliteral">      label_weights=label_weights,</span></div>
<div class="line"><span class="lineno"> 3344</span><span class="stringliteral">      label_confidences=label_confidences,</span></div>
<div class="line"><span class="lineno"> 3345</span><span class="stringliteral">      multiclass_scores=multiclass_scores,</span></div>
<div class="line"><span class="lineno"> 3346</span><span class="stringliteral">      masks=masks,</span></div>
<div class="line"><span class="lineno"> 3347</span><span class="stringliteral">      keypoints=keypoints,</span></div>
<div class="line"><span class="lineno"> 3348</span><span class="stringliteral">      min_object_covered=min_object_covered,</span></div>
<div class="line"><span class="lineno"> 3349</span><span class="stringliteral">      aspect_ratio_range=aspect_ratio_range,</span></div>
<div class="line"><span class="lineno"> 3350</span><span class="stringliteral">      area_range=area_range,</span></div>
<div class="line"><span class="lineno"> 3351</span><span class="stringliteral">      overlap_thresh=overlap_thresh,</span></div>
<div class="line"><span class="lineno"> 3352</span><span class="stringliteral">      clip_boxes=clip_boxes,</span></div>
<div class="line"><span class="lineno"> 3353</span><span class="stringliteral">      random_coef=random_coef,</span></div>
<div class="line"><span class="lineno"> 3354</span><span class="stringliteral">      seed=seed,</span></div>
<div class="line"><span class="lineno"> 3355</span><span class="stringliteral">      preprocess_vars_cache=preprocess_vars_cache)</span></div>
<div class="line"><span class="lineno"> 3356</span><span class="stringliteral">  i = 3</span></div>
<div class="line"><span class="lineno"> 3357</span><span class="stringliteral">  new_image, new_boxes, new_labels = crop_result[:i]</span></div>
<div class="line"><span class="lineno"> 3358</span><span class="stringliteral">  new_label_weights = </span><span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3359</span>  new_label_confidences = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3360</span>  new_multiclass_scores = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3361</span>  new_masks = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3362</span>  new_keypoints = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno"> 3363</span>  <span class="keywordflow">if</span> label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3364</span>    new_label_weights = crop_result[i]</div>
<div class="line"><span class="lineno"> 3365</span>    i += 1</div>
<div class="line"><span class="lineno"> 3366</span>  <span class="keywordflow">if</span> label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3367</span>    new_label_confidences = crop_result[i]</div>
<div class="line"><span class="lineno"> 3368</span>    i += 1</div>
<div class="line"><span class="lineno"> 3369</span>  <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3370</span>    new_multiclass_scores = crop_result[i]</div>
<div class="line"><span class="lineno"> 3371</span>    i += 1</div>
<div class="line"><span class="lineno"> 3372</span>  <span class="keywordflow">if</span> masks <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3373</span>    new_masks = crop_result[i]</div>
<div class="line"><span class="lineno"> 3374</span>    i += 1</div>
<div class="line"><span class="lineno"> 3375</span>  <span class="keywordflow">if</span> keypoints <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3376</span>    new_keypoints = crop_result[i]</div>
<div class="line"><span class="lineno"> 3377</span> </div>
<div class="line"><span class="lineno"> 3378</span>  result = random_pad_to_aspect_ratio(</div>
<div class="line"><span class="lineno"> 3379</span>      new_image,</div>
<div class="line"><span class="lineno"> 3380</span>      new_boxes,</div>
<div class="line"><span class="lineno"> 3381</span>      masks=new_masks,</div>
<div class="line"><span class="lineno"> 3382</span>      keypoints=new_keypoints,</div>
<div class="line"><span class="lineno"> 3383</span>      aspect_ratio=aspect_ratio,</div>
<div class="line"><span class="lineno"> 3384</span>      min_padded_size_ratio=min_padded_size_ratio,</div>
<div class="line"><span class="lineno"> 3385</span>      max_padded_size_ratio=max_padded_size_ratio,</div>
<div class="line"><span class="lineno"> 3386</span>      seed=seed,</div>
<div class="line"><span class="lineno"> 3387</span>      preprocess_vars_cache=preprocess_vars_cache)</div>
<div class="line"><span class="lineno"> 3388</span> </div>
<div class="line"><span class="lineno"> 3389</span>  result = list(result)</div>
<div class="line"><span class="lineno"> 3390</span>  i = 3</div>
<div class="line"><span class="lineno"> 3391</span>  result.insert(2, new_labels)</div>
<div class="line"><span class="lineno"> 3392</span>  <span class="keywordflow">if</span> new_label_weights <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3393</span>    result.insert(i, new_label_weights)</div>
<div class="line"><span class="lineno"> 3394</span>    i += 1</div>
<div class="line"><span class="lineno"> 3395</span>  <span class="keywordflow">if</span> new_label_confidences <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3396</span>    result.insert(i, new_label_confidences)</div>
<div class="line"><span class="lineno"> 3397</span>    i += 1</div>
<div class="line"><span class="lineno"> 3398</span>  <span class="keywordflow">if</span> multiclass_scores <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno"> 3399</span>    result.insert(i, new_multiclass_scores)</div>
<div class="line"><span class="lineno"> 3400</span>  result = tuple(result)</div>
<div class="line"><span class="lineno"> 3401</span> </div>
<div class="line"><span class="lineno"> 3402</span>  <span class="keywordflow">return</span> result</div>
<div class="line"><span class="lineno"> 3403</span> </div>
<div class="line"><span class="lineno"> 3404</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor_ac4cb1ebd49aea7a953dff66c0b64cc19_cgraph.png" border="0" usemap="#ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ac4cb1ebd49aea7a953dff66c0b64cc19_cgraph" alt=""/></div>
<map name="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ac4cb1ebd49aea7a953dff66c0b64cc19_cgraph" id="ade/da5/namespacedetection__utils_1_1core_1_1preprocessor_ac4cb1ebd49aea7a953dff66c0b64cc19_cgraph">
<area shape="rect" title=" " alt="" coords="5,35,249,75"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ab0a1f9342a5127f9b80e0ffdfe94fc59" title=" " alt="" coords="893,5,1155,45"/>
<area shape="poly" title=" " alt="" coords="250,48,880,27,880,33,250,53"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a91a2c48d4f04433025c2994248222729" title=" " alt="" coords="297,63,536,103"/>
<area shape="poly" title=" " alt="" coords="250,64,284,67,283,72,249,69"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a8fea0b9f060eea936fac7e5dd5102df7" title=" " alt="" coords="1203,88,1444,128"/>
<area shape="poly" title=" " alt="" coords="1098,43,1237,82,1236,87,1096,48"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#a190734dcb563069386fbf10f1cdb044c" title=" " alt="" coords="597,63,832,103"/>
<area shape="poly" title=" " alt="" coords="536,80,584,80,584,85,536,85"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae53f685c9e071ec37c0829148e5067fe" title=" " alt="" coords="584,127,845,167"/>
<area shape="poly" title=" " alt="" coords="511,100,608,121,607,126,510,105"/>
<area shape="poly" title=" " alt="" coords="832,85,1189,100,1189,105,832,90"/>
<area shape="poly" title=" " alt="" coords="845,136,1189,114,1189,119,846,141"/>
<area shape="rect" href="../../de/da5/namespacedetection__utils_1_1core_1_1preprocessor.html#ae7996143b3e46240e14ccb89e89f3fe3" title=" " alt="" coords="915,171,1133,211"/>
<area shape="poly" title=" " alt="" coords="846,163,901,171,900,176,845,168"/>
<area shape="poly" title=" " alt="" coords="1096,168,1236,129,1237,134,1098,173"/>
</map>
</div>

</div>
</div>
<a id="a42ac33ac786175636312abd4941aa915" name="a42ac33ac786175636312abd4941aa915"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42ac33ac786175636312abd4941aa915">&#9670;&#160;</a></span>subtract_channel_mean()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.preprocessor.subtract_channel_mean </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>image</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>means</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Normalizes an image by subtracting a mean from each channel.

Args:
  image: A 3D tensor of shape [height, width, channels]
  means: float list containing a mean for each channel
Returns:
  normalized_images: a tensor of shape [height, width, channels]
Raises:
  ValueError: if images is not a 4D tensor or if the number of means is not
    equal to the number of channels.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../d4/d9a/preprocessor_8py_source.html#l02692">2692</a> of file <a class="el" href="../../d4/d9a/preprocessor_8py_source.html">preprocessor.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2692</span><span class="keyword">def </span>subtract_channel_mean(image, means=None):</div>
<div class="line"><span class="lineno"> 2693</span>  <span class="stringliteral">&quot;&quot;&quot;Normalizes an image by subtracting a mean from each channel.</span></div>
<div class="line"><span class="lineno"> 2694</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno"> 2695</span><span class="stringliteral">  Args:</span></div>
<div class="line"><span class="lineno"> 2696</span><span class="stringliteral">    image: A 3D tensor of shape [height, width, channels]</span></div>
<div class="line"><span class="lineno"> 2697</span><span class="stringliteral">    means: float list containing a mean </span><span class="keywordflow">for</span> each channel</div>
<div class="line"><span class="lineno"> 2698</span>  Returns:</div>
<div class="line"><span class="lineno"> 2699</span>    normalized_images: a tensor of shape [height, width, channels]</div>
<div class="line"><span class="lineno"> 2700</span>  Raises:</div>
<div class="line"><span class="lineno"> 2701</span>    ValueError: <span class="keywordflow">if</span> images <span class="keywordflow">is</span> <span class="keywordflow">not</span> a 4D tensor <span class="keywordflow">or</span> <span class="keywordflow">if</span> the number of means <span class="keywordflow">is</span> <span class="keywordflow">not</span></div>
<div class="line"><span class="lineno"> 2702</span>      equal to the number of channels.</div>
<div class="line"><span class="lineno"> 2703</span>  <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno"> 2704</span><span class="stringliteral">  </span><span class="keyword">with</span> tf.name_scope(<span class="stringliteral">&#39;SubtractChannelMean&#39;</span>, values=[image, means]):</div>
<div class="line"><span class="lineno"> 2705</span>    <span class="keywordflow">if</span> len(image.get_shape()) != 3:</div>
<div class="line"><span class="lineno"> 2706</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;Input must be of size [height, width, channels]&#39;</span>)</div>
<div class="line"><span class="lineno"> 2707</span>    <span class="keywordflow">if</span> len(means) != image.get_shape()[-1]:</div>
<div class="line"><span class="lineno"> 2708</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;len(means) must match the number of channels&#39;</span>)</div>
<div class="line"><span class="lineno"> 2709</span>    <span class="keywordflow">return</span> image - [[means]]</div>
<div class="line"><span class="lineno"> 2710</span> </div>
<div class="line"><span class="lineno"> 2711</span> </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
