<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RESIIST: detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RESIIST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d97/namespacedetection__utils.html">detection_utils</a></li><li class="navelem"><a class="el" href="../../de/d5d/namespacedetection__utils_1_1core.html">core</a></li><li class="navelem"><a class="el" href="../../df/de8/namespacedetection__utils_1_1core_1_1batch__multiclass__nms__test.html">batch_multiclass_nms_test</a></li><li class="navelem"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html">BatchMulticlassNonMaxSuppressionTest</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="../../dc/d39/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest:</div>
<div class="dyncontent">
<div class="center"><img src="../../db/d18/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test__inherit__graph.png" border="0" usemap="#adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_inherit__map" alt="Inheritance graph"/></div>
<map name="adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_inherit__map" id="adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_inherit__map">
<area shape="rect" title=" " alt="" coords="35,119,274,643"/>
<area shape="rect" title=" " alt="" coords="5,5,136,71"/>
<area shape="poly" title=" " alt="" coords="84,83,93,118,88,119,79,84"/>
<area shape="rect" title=" " alt="" coords="161,5,319,71"/>
<area shape="poly" title=" " alt="" coords="231,84,223,119,218,118,226,83"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest:</div>
<div class="dyncontent">
<div class="center"><img src="../../d7/dc8/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test__coll__graph.png" border="0" usemap="#adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_coll__map" alt="Collaboration graph"/></div>
<map name="adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_coll__map" id="adetection__utils_8core_8batch__multiclass__nms__test_8_batch_multiclass_non_max_suppression_test_coll__map">
<area shape="rect" title=" " alt="" coords="35,119,274,643"/>
<area shape="rect" title=" " alt="" coords="5,5,136,71"/>
<area shape="poly" title=" " alt="" coords="84,83,93,118,88,119,79,84"/>
<area shape="rect" title=" " alt="" coords="161,5,319,71"/>
<area shape="poly" title=" " alt="" coords="231,84,223,119,218,118,226,83"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a9a32759dfb65aec2029058a214060c2d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#a9a32759dfb65aec2029058a214060c2d">test_batch_multiclass_nms_with_batch_size_1</a> (self, use_static_shapes)</td></tr>
<tr class="separator:a9a32759dfb65aec2029058a214060c2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35d5cf565dcbafd6bec56faa813c896d"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#a35d5cf565dcbafd6bec56faa813c896d">test_batch_iou_with_negative_data</a> (self)</td></tr>
<tr class="separator:a35d5cf565dcbafd6bec56faa813c896d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac96471a95b3e8b5a63b8a597e6bf9ecc"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#ac96471a95b3e8b5a63b8a597e6bf9ecc">test_batch_multiclass_nms_with_batch_size_2</a> (self)</td></tr>
<tr class="separator:ac96471a95b3e8b5a63b8a597e6bf9ecc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2342f5b24538a47a5573f748ef4e54cf"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#a2342f5b24538a47a5573f748ef4e54cf">test_batch_multiclass_nms_with_per_batch_clip_window</a> (self)</td></tr>
<tr class="separator:a2342f5b24538a47a5573f748ef4e54cf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8feb116f6e6ad2122161838261eb1ea8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#a8feb116f6e6ad2122161838261eb1ea8">test_batch_multiclass_nms_with_per_image_clip_window</a> (self)</td></tr>
<tr class="separator:a8feb116f6e6ad2122161838261eb1ea8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb7536b0b87961904fccfad1ddb9040c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#abb7536b0b87961904fccfad1ddb9040c">test_batch_multiclass_nms_with_masks</a> (self)</td></tr>
<tr class="separator:abb7536b0b87961904fccfad1ddb9040c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a71764345b4b2ea5aa5e5c1d9c95ff4d8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#a71764345b4b2ea5aa5e5c1d9c95ff4d8">test_batch_multiclass_nms_with_additional_fields</a> (self)</td></tr>
<tr class="separator:a71764345b4b2ea5aa5e5c1d9c95ff4d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accdb81b1a55408510d8be4a56b9ab7f4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#accdb81b1a55408510d8be4a56b9ab7f4">test_batch_multiclass_nms_with_dynamic_batch_size</a> (self)</td></tr>
<tr class="separator:accdb81b1a55408510d8be4a56b9ab7f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2bc5bf09a5ef01493bd1d6e0b59020c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#ac2bc5bf09a5ef01493bd1d6e0b59020c">test_batch_multiclass_nms_with_masks_and_num_valid_boxes</a> (self)</td></tr>
<tr class="separator:ac2bc5bf09a5ef01493bd1d6e0b59020c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aebce9874b20c409041a63b1b5a778fa6"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d6/d76/classdetection__utils_1_1core_1_1batch__multiclass__nms__test_1_1_batch_multiclass_non_max_suppression_test.html#aebce9874b20c409041a63b1b5a778fa6">test_batch_multiclass_nms_with_additional_fields_and_num_valid_boxes</a> (self)</td></tr>
<tr class="separator:aebce9874b20c409041a63b1b5a778fa6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00027">27</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a35d5cf565dcbafd6bec56faa813c896d" name="a35d5cf565dcbafd6bec56faa813c896d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35d5cf565dcbafd6bec56faa813c896d">&#9670;&#160;</a></span>test_batch_iou_with_negative_data()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_iou_with_negative_data </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00079">79</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>  <span class="keyword">def </span>test_batch_iou_with_negative_data(self):</div>
<div class="line"><span class="lineno">   80</span>    boxes = tf.constant([[[0, -0.01, 0.1, 1.1], [0, 0.2, 0.2, 5.0],</div>
<div class="line"><span class="lineno">   81</span>                          [0, -0.01, 0.1, 1.], [-1, -1, -1, -1]]], tf.float32)</div>
<div class="line"><span class="lineno">   82</span>    iou = post_processing.batch_iou(boxes, boxes)</div>
<div class="line"><span class="lineno">   83</span>    expected_iou = [[[0.99999994, 0.0917431, 0.9099099, -1.],</div>
<div class="line"><span class="lineno">   84</span>                     [0.0917431, 1., 0.08154944, -1.],</div>
<div class="line"><span class="lineno">   85</span>                     [0.9099099, 0.08154944, 1., -1.], [-1., -1., -1., -1.]]]</div>
<div class="line"><span class="lineno">   86</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">   87</span>      iou = sess.run(iou)</div>
<div class="line"><span class="lineno">   88</span>      self.assertAllClose(iou, expected_iou)</div>
<div class="line"><span class="lineno">   89</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a71764345b4b2ea5aa5e5c1d9c95ff4d8" name="a71764345b4b2ea5aa5e5c1d9c95ff4d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a71764345b4b2ea5aa5e5c1d9c95ff4d8">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_additional_fields()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_additional_fields </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00340">340</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  340</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_additional_fields(self):</div>
<div class="line"><span class="lineno">  341</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  342</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  343</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  344</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  345</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  346</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  347</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  348</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  349</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  350</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  351</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  352</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  353</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  354</span>    additional_fields = {</div>
<div class="line"><span class="lineno">  355</span>        <span class="stringliteral">&#39;keypoints&#39;</span>: tf.constant(</div>
<div class="line"><span class="lineno">  356</span>            [[[[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  357</span>              [[0, 1], [2, 3]],</div>
<div class="line"><span class="lineno">  358</span>              [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  359</span>              [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  360</span>             [[[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  361</span>              [[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  362</span>              [[10, 11], [12, 13]],</div>
<div class="line"><span class="lineno">  363</span>              [[0, 0], [0, 0]]]],</div>
<div class="line"><span class="lineno">  364</span>            tf.float32)</div>
<div class="line"><span class="lineno">  365</span>    }</div>
<div class="line"><span class="lineno">  366</span>    additional_fields[<span class="stringliteral">&#39;size&#39;</span>] = tf.constant(</div>
<div class="line"><span class="lineno">  367</span>        [[[[6], [8]], [[0], [2]], [[0], [0]], [[0], [0]]],</div>
<div class="line"><span class="lineno">  368</span>         [[[13], [15]], [[8], [10]], [[10], [12]], [[0], [0]]]], tf.float32)</div>
<div class="line"><span class="lineno">  369</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  370</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  371</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>    exp_nms_corners = np.array([[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">  374</span>                                 [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  375</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  376</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  377</span>                                [[0, 999, 2, 1004],</div>
<div class="line"><span class="lineno">  378</span>                                 [0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  379</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  380</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  381</span>    exp_nms_scores = np.array([[.95, .9, 0, 0],</div>
<div class="line"><span class="lineno">  382</span>                               [.85, .5, .3, 0]])</div>
<div class="line"><span class="lineno">  383</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  384</span>                                [1, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  385</span>    exp_nms_additional_fields = {</div>
<div class="line"><span class="lineno">  386</span>        <span class="stringliteral">&#39;keypoints&#39;</span>: np.array([[[[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  387</span>                                [[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  388</span>                                [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  389</span>                                [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  390</span>                               [[[10, 11], [12, 13]],</div>
<div class="line"><span class="lineno">  391</span>                                [[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  392</span>                                [[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  393</span>                                [[0, 0], [0, 0]]]])</div>
<div class="line"><span class="lineno">  394</span>    }</div>
<div class="line"><span class="lineno">  395</span>    exp_nms_additional_fields[<span class="stringliteral">&#39;size&#39;</span>] = np.array([[[[0], [0]], [[6], [8]],</div>
<div class="line"><span class="lineno">  396</span>                                                   [[0], [0]], [[0], [0]]],</div>
<div class="line"><span class="lineno">  397</span>                                                  [[[10], [12]], [[13], [15]],</div>
<div class="line"><span class="lineno">  398</span>                                                   [[8], [10]], [[0], [0]]]])</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  401</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  402</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  403</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  404</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  405</span>        additional_fields=additional_fields)</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">  408</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  409</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(), exp_nms_corners.shape)</div>
<div class="line"><span class="lineno">  410</span>    self.assertAllEqual(nmsed_scores.shape.as_list(), exp_nms_scores.shape)</div>
<div class="line"><span class="lineno">  411</span>    self.assertAllEqual(nmsed_classes.shape.as_list(), exp_nms_classes.shape)</div>
<div class="line"><span class="lineno">  412</span>    self.assertEqual(len(nmsed_additional_fields),</div>
<div class="line"><span class="lineno">  413</span>                     len(exp_nms_additional_fields))</div>
<div class="line"><span class="lineno">  414</span>    <span class="keywordflow">for</span> key <span class="keywordflow">in</span> exp_nms_additional_fields:</div>
<div class="line"><span class="lineno">  415</span>      self.assertAllEqual(nmsed_additional_fields[key].shape.as_list(),</div>
<div class="line"><span class="lineno">  416</span>                          exp_nms_additional_fields[key].shape)</div>
<div class="line"><span class="lineno">  417</span>    self.assertEqual(num_detections.shape.as_list(), [2])</div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  420</span>      (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_additional_fields,</div>
<div class="line"><span class="lineno">  421</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  422</span>                                   nmsed_additional_fields, num_detections])</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  425</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  426</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  427</span>      <span class="keywordflow">for</span> key <span class="keywordflow">in</span> exp_nms_additional_fields:</div>
<div class="line"><span class="lineno">  428</span>        self.assertAllClose(nmsed_additional_fields[key],</div>
<div class="line"><span class="lineno">  429</span>                            exp_nms_additional_fields[key])</div>
<div class="line"><span class="lineno">  430</span>      self.assertAllClose(num_detections, [2, 3])</div>
<div class="line"><span class="lineno">  431</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="aebce9874b20c409041a63b1b5a778fa6" name="aebce9874b20c409041a63b1b5a778fa6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aebce9874b20c409041a63b1b5a778fa6">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_additional_fields_and_num_valid_boxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_additional_fields_and_num_valid_boxes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00578">578</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  579</span>      self):</div>
<div class="line"><span class="lineno">  580</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  581</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  582</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  583</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  584</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  585</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  586</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  587</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  588</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  589</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  590</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  591</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  592</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  593</span>    additional_fields = {</div>
<div class="line"><span class="lineno">  594</span>        <span class="stringliteral">&#39;keypoints&#39;</span>: tf.constant(</div>
<div class="line"><span class="lineno">  595</span>            [[[[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  596</span>              [[0, 1], [2, 3]],</div>
<div class="line"><span class="lineno">  597</span>              [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  598</span>              [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  599</span>             [[[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  600</span>              [[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  601</span>              [[10, 11], [12, 13]],</div>
<div class="line"><span class="lineno">  602</span>              [[0, 0], [0, 0]]]],</div>
<div class="line"><span class="lineno">  603</span>            tf.float32)</div>
<div class="line"><span class="lineno">  604</span>    }</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>    additional_fields[<span class="stringliteral">&#39;size&#39;</span>] = tf.constant(</div>
<div class="line"><span class="lineno">  607</span>        [[[[7], [9]], [[1], [3]], [[0], [0]], [[0], [0]]],</div>
<div class="line"><span class="lineno">  608</span>         [[[14], [16]], [[9], [11]], [[11], [13]], [[0], [0]]]], tf.float32)</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    num_valid_boxes = tf.constant([1, 1], tf.int32)</div>
<div class="line"><span class="lineno">  611</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  612</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  613</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>    exp_nms_corners = [[[0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  616</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  617</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  618</span>                        [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  619</span>                       [[0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  620</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  621</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  622</span>                        [0, 0, 0, 0]]]</div>
<div class="line"><span class="lineno">  623</span>    exp_nms_scores = [[.9, 0, 0, 0],</div>
<div class="line"><span class="lineno">  624</span>                      [.5, 0, 0, 0]]</div>
<div class="line"><span class="lineno">  625</span>    exp_nms_classes = [[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  626</span>                       [0, 0, 0, 0]]</div>
<div class="line"><span class="lineno">  627</span>    exp_nms_additional_fields = {</div>
<div class="line"><span class="lineno">  628</span>        <span class="stringliteral">&#39;keypoints&#39;</span>: np.array([[[[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  629</span>                                [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  630</span>                                [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  631</span>                                [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  632</span>                               [[[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  633</span>                                [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  634</span>                                [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  635</span>                                [[0, 0], [0, 0]]]])</div>
<div class="line"><span class="lineno">  636</span>    }</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    exp_nms_additional_fields[<span class="stringliteral">&#39;size&#39;</span>] = np.array([[[[7], [9]], [[0], [0]],</div>
<div class="line"><span class="lineno">  639</span>                                                   [[0], [0]], [[0], [0]]],</div>
<div class="line"><span class="lineno">  640</span>                                                  [[[14], [16]], [[0], [0]],</div>
<div class="line"><span class="lineno">  641</span>                                                   [[0], [0]], [[0], [0]]]])</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  644</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  645</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  646</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  647</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  648</span>        num_valid_boxes=num_valid_boxes,</div>
<div class="line"><span class="lineno">  649</span>        additional_fields=additional_fields)</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  654</span>      (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_additional_fields,</div>
<div class="line"><span class="lineno">  655</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  656</span>                                   nmsed_additional_fields, num_detections])</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  659</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  660</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  661</span>      <span class="keywordflow">for</span> key <span class="keywordflow">in</span> exp_nms_additional_fields:</div>
<div class="line"><span class="lineno">  662</span>        self.assertAllClose(nmsed_additional_fields[key],</div>
<div class="line"><span class="lineno">  663</span>                            exp_nms_additional_fields[key])</div>
<div class="line"><span class="lineno">  664</span>      self.assertAllClose(num_detections, [1, 1])</div>
<div class="line"><span class="lineno">  665</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a32759dfb65aec2029058a214060c2d" name="a9a32759dfb65aec2029058a214060c2d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a32759dfb65aec2029058a214060c2d">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_batch_size_1()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_batch_size_1 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>use_static_shapes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00031">31</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_batch_size_1(self, use_static_shapes):</div>
<div class="line"><span class="lineno">   32</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">   33</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">   34</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">   35</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]],</div>
<div class="line"><span class="lineno">   36</span>                          [[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">   37</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">   38</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">   39</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">   40</span>                        tf.float32)</div>
<div class="line"><span class="lineno">   41</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">   42</span>                           [.6, 0.01], [.95, 0],</div>
<div class="line"><span class="lineno">   43</span>                           [.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">   44</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">   45</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">   46</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">   47</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span>    exp_nms_corners = [[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">   50</span>                        [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">   51</span>                        [0, 999, 2, 1004],</div>
<div class="line"><span class="lineno">   52</span>                        [0, 100, 1, 101]]]</div>
<div class="line"><span class="lineno">   53</span>    exp_nms_scores = [[.95, .9, .85, .3]]</div>
<div class="line"><span class="lineno">   54</span>    exp_nms_classes = [[0, 0, 1, 0]]</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">   57</span>     nmsed_additional_fields,</div>
<div class="line"><span class="lineno">   58</span>     num_detections) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">   59</span>         boxes,</div>
<div class="line"><span class="lineno">   60</span>         scores,</div>
<div class="line"><span class="lineno">   61</span>         score_thresh,</div>
<div class="line"><span class="lineno">   62</span>         iou_thresh,</div>
<div class="line"><span class="lineno">   63</span>         max_size_per_class=max_output_size,</div>
<div class="line"><span class="lineno">   64</span>         max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">   65</span>         use_static_shapes=use_static_shapes)</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">   68</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">   71</span>      (nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">   72</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">   73</span>                                   num_detections])</div>
<div class="line"><span class="lineno">   74</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">   75</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">   76</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">   77</span>      self.assertEqual(num_detections, [4])</div>
<div class="line"><span class="lineno">   78</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac96471a95b3e8b5a63b8a597e6bf9ecc" name="ac96471a95b3e8b5a63b8a597e6bf9ecc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac96471a95b3e8b5a63b8a597e6bf9ecc">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_batch_size_2()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_batch_size_2 </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00090">90</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_batch_size_2(self):</div>
<div class="line"><span class="lineno">   91</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">   92</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">   93</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">   94</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">   95</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">   96</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">   97</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">   98</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">   99</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  100</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  101</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  102</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  103</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  104</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  105</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  106</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>    exp_nms_corners = np.array([[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">  109</span>                                 [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  110</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  111</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  112</span>                                [[0, 999, 2, 1004],</div>
<div class="line"><span class="lineno">  113</span>                                 [0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  114</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  115</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  116</span>    exp_nms_scores = np.array([[.95, .9, 0, 0],</div>
<div class="line"><span class="lineno">  117</span>                               [.85, .5, .3, 0]])</div>
<div class="line"><span class="lineno">  118</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  119</span>                                [1, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  122</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  123</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  124</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  125</span>        max_size_per_class=max_output_size, max_total_size=max_output_size)</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">  128</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  129</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  130</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(),</div>
<div class="line"><span class="lineno">  131</span>                        exp_nms_corners.shape)</div>
<div class="line"><span class="lineno">  132</span>    self.assertAllEqual(nmsed_scores.shape.as_list(),</div>
<div class="line"><span class="lineno">  133</span>                        exp_nms_scores.shape)</div>
<div class="line"><span class="lineno">  134</span>    self.assertAllEqual(nmsed_classes.shape.as_list(),</div>
<div class="line"><span class="lineno">  135</span>                        exp_nms_classes.shape)</div>
<div class="line"><span class="lineno">  136</span>    self.assertEqual(num_detections.shape.as_list(), [2])</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  139</span>      (nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  140</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  141</span>                                   num_detections])</div>
<div class="line"><span class="lineno">  142</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  143</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  144</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  145</span>      self.assertAllClose(num_detections, [2, 3])</div>
<div class="line"><span class="lineno">  146</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="accdb81b1a55408510d8be4a56b9ab7f4" name="accdb81b1a55408510d8be4a56b9ab7f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#accdb81b1a55408510d8be4a56b9ab7f4">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_dynamic_batch_size()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_dynamic_batch_size </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00432">432</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  432</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_dynamic_batch_size(self):</div>
<div class="line"><span class="lineno">  433</span>    boxes_placeholder = tf.placeholder(tf.float32, shape=(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, 2, 4))</div>
<div class="line"><span class="lineno">  434</span>    scores_placeholder = tf.placeholder(tf.float32, shape=(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, 2))</div>
<div class="line"><span class="lineno">  435</span>    masks_placeholder = tf.placeholder(tf.float32, shape=(<span class="keywordtype">None</span>, <span class="keywordtype">None</span>, 2, 2, 2))</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>    boxes = np.array([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  438</span>                       [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  439</span>                       [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  440</span>                       [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  441</span>                      [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  442</span>                       [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  443</span>                       [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  444</span>                       [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]])</div>
<div class="line"><span class="lineno">  445</span>    scores = np.array([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  446</span>                        [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  447</span>                       [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  448</span>                        [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  449</span>    masks = np.array([[[[[0, 1], [2, 3]], [[1, 2], [3, 4]]],</div>
<div class="line"><span class="lineno">  450</span>                       [[[2, 3], [4, 5]], [[3, 4], [5, 6]]],</div>
<div class="line"><span class="lineno">  451</span>                       [[[4, 5], [6, 7]], [[5, 6], [7, 8]]],</div>
<div class="line"><span class="lineno">  452</span>                       [[[6, 7], [8, 9]], [[7, 8], [9, 10]]]],</div>
<div class="line"><span class="lineno">  453</span>                      [[[[8, 9], [10, 11]], [[9, 10], [11, 12]]],</div>
<div class="line"><span class="lineno">  454</span>                       [[[10, 11], [12, 13]], [[11, 12], [13, 14]]],</div>
<div class="line"><span class="lineno">  455</span>                       [[[12, 13], [14, 15]], [[13, 14], [15, 16]]],</div>
<div class="line"><span class="lineno">  456</span>                       [[[14, 15], [16, 17]], [[15, 16], [17, 18]]]]])</div>
<div class="line"><span class="lineno">  457</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  458</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  459</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>    exp_nms_corners = np.array([[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">  462</span>                                 [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  463</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  464</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  465</span>                                [[0, 999, 2, 1004],</div>
<div class="line"><span class="lineno">  466</span>                                 [0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  467</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  468</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  469</span>    exp_nms_scores = np.array([[.95, .9, 0, 0],</div>
<div class="line"><span class="lineno">  470</span>                               [.85, .5, .3, 0]])</div>
<div class="line"><span class="lineno">  471</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  472</span>                                [1, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  473</span>    exp_nms_masks = np.array([[[[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  474</span>                               [[0, 1], [2, 3]],</div>
<div class="line"><span class="lineno">  475</span>                               [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  476</span>                               [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  477</span>                              [[[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  478</span>                               [[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  479</span>                               [[10, 11], [12, 13]],</div>
<div class="line"><span class="lineno">  480</span>                               [[0, 0], [0, 0]]]])</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  483</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  484</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  485</span>        boxes_placeholder, scores_placeholder, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  486</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  487</span>        masks=masks_placeholder)</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  490</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  491</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(), [<span class="keywordtype">None</span>, 4, 4])</div>
<div class="line"><span class="lineno">  492</span>    self.assertAllEqual(nmsed_scores.shape.as_list(), [<span class="keywordtype">None</span>, 4])</div>
<div class="line"><span class="lineno">  493</span>    self.assertAllEqual(nmsed_classes.shape.as_list(), [<span class="keywordtype">None</span>, 4])</div>
<div class="line"><span class="lineno">  494</span>    self.assertAllEqual(nmsed_masks.shape.as_list(), [<span class="keywordtype">None</span>, 4, 2, 2])</div>
<div class="line"><span class="lineno">  495</span>    self.assertEqual(num_detections.shape.as_list(), [<span class="keywordtype">None</span>])</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  498</span>      (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  499</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  500</span>                                   nmsed_masks, num_detections],</div>
<div class="line"><span class="lineno">  501</span>                                  feed_dict={boxes_placeholder: boxes,</div>
<div class="line"><span class="lineno">  502</span>                                             scores_placeholder: scores,</div>
<div class="line"><span class="lineno">  503</span>                                             masks_placeholder: masks})</div>
<div class="line"><span class="lineno">  504</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  505</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  506</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  507</span>      self.assertAllClose(num_detections, [2, 3])</div>
<div class="line"><span class="lineno">  508</span>      self.assertAllClose(nmsed_masks, exp_nms_masks)</div>
<div class="line"><span class="lineno">  509</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="abb7536b0b87961904fccfad1ddb9040c" name="abb7536b0b87961904fccfad1ddb9040c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb7536b0b87961904fccfad1ddb9040c">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_masks()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_masks </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00266">266</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  266</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_masks(self):</div>
<div class="line"><span class="lineno">  267</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  268</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  269</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  270</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  271</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  272</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  273</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  274</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  275</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  276</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  277</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  278</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  279</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  280</span>    masks = tf.constant([[[[[0, 1], [2, 3]], [[1, 2], [3, 4]]],</div>
<div class="line"><span class="lineno">  281</span>                          [[[2, 3], [4, 5]], [[3, 4], [5, 6]]],</div>
<div class="line"><span class="lineno">  282</span>                          [[[4, 5], [6, 7]], [[5, 6], [7, 8]]],</div>
<div class="line"><span class="lineno">  283</span>                          [[[6, 7], [8, 9]], [[7, 8], [9, 10]]]],</div>
<div class="line"><span class="lineno">  284</span>                         [[[[8, 9], [10, 11]], [[9, 10], [11, 12]]],</div>
<div class="line"><span class="lineno">  285</span>                          [[[10, 11], [12, 13]], [[11, 12], [13, 14]]],</div>
<div class="line"><span class="lineno">  286</span>                          [[[12, 13], [14, 15]], [[13, 14], [15, 16]]],</div>
<div class="line"><span class="lineno">  287</span>                          [[[14, 15], [16, 17]], [[15, 16], [17, 18]]]]],</div>
<div class="line"><span class="lineno">  288</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  289</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  290</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  291</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    exp_nms_corners = np.array([[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">  294</span>                                 [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  295</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  296</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  297</span>                                [[0, 999, 2, 1004],</div>
<div class="line"><span class="lineno">  298</span>                                 [0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  299</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  300</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  301</span>    exp_nms_scores = np.array([[.95, .9, 0, 0],</div>
<div class="line"><span class="lineno">  302</span>                               [.85, .5, .3, 0]])</div>
<div class="line"><span class="lineno">  303</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  304</span>                                [1, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  305</span>    exp_nms_masks = np.array([[[[6, 7], [8, 9]],</div>
<div class="line"><span class="lineno">  306</span>                               [[0, 1], [2, 3]],</div>
<div class="line"><span class="lineno">  307</span>                               [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  308</span>                               [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  309</span>                              [[[13, 14], [15, 16]],</div>
<div class="line"><span class="lineno">  310</span>                               [[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  311</span>                               [[10, 11], [12, 13]],</div>
<div class="line"><span class="lineno">  312</span>                               [[0, 0], [0, 0]]]])</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  315</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  316</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  317</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  318</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  319</span>        masks=masks)</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  322</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  323</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(), exp_nms_corners.shape)</div>
<div class="line"><span class="lineno">  324</span>    self.assertAllEqual(nmsed_scores.shape.as_list(), exp_nms_scores.shape)</div>
<div class="line"><span class="lineno">  325</span>    self.assertAllEqual(nmsed_classes.shape.as_list(), exp_nms_classes.shape)</div>
<div class="line"><span class="lineno">  326</span>    self.assertAllEqual(nmsed_masks.shape.as_list(), exp_nms_masks.shape)</div>
<div class="line"><span class="lineno">  327</span>    self.assertEqual(num_detections.shape.as_list(), [2])</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  330</span>      (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  331</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  332</span>                                   nmsed_masks, num_detections])</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  335</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  336</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  337</span>      self.assertAllClose(num_detections, [2, 3])</div>
<div class="line"><span class="lineno">  338</span>      self.assertAllClose(nmsed_masks, exp_nms_masks)</div>
<div class="line"><span class="lineno">  339</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2bc5bf09a5ef01493bd1d6e0b59020c" name="ac2bc5bf09a5ef01493bd1d6e0b59020c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2bc5bf09a5ef01493bd1d6e0b59020c">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_masks_and_num_valid_boxes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_masks_and_num_valid_boxes </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00510">510</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  510</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_masks_and_num_valid_boxes(self):</div>
<div class="line"><span class="lineno">  511</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  512</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  513</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  514</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  515</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  516</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  517</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  518</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  519</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  520</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  521</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  522</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  523</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  524</span>    masks = tf.constant([[[[[0, 1], [2, 3]], [[1, 2], [3, 4]]],</div>
<div class="line"><span class="lineno">  525</span>                          [[[2, 3], [4, 5]], [[3, 4], [5, 6]]],</div>
<div class="line"><span class="lineno">  526</span>                          [[[4, 5], [6, 7]], [[5, 6], [7, 8]]],</div>
<div class="line"><span class="lineno">  527</span>                          [[[6, 7], [8, 9]], [[7, 8], [9, 10]]]],</div>
<div class="line"><span class="lineno">  528</span>                         [[[[8, 9], [10, 11]], [[9, 10], [11, 12]]],</div>
<div class="line"><span class="lineno">  529</span>                          [[[10, 11], [12, 13]], [[11, 12], [13, 14]]],</div>
<div class="line"><span class="lineno">  530</span>                          [[[12, 13], [14, 15]], [[13, 14], [15, 16]]],</div>
<div class="line"><span class="lineno">  531</span>                          [[[14, 15], [16, 17]], [[15, 16], [17, 18]]]]],</div>
<div class="line"><span class="lineno">  532</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  533</span>    num_valid_boxes = tf.constant([1, 1], tf.int32)</div>
<div class="line"><span class="lineno">  534</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  535</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  536</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    exp_nms_corners = [[[0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  539</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  540</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  541</span>                        [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  542</span>                       [[0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  543</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  544</span>                        [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  545</span>                        [0, 0, 0, 0]]]</div>
<div class="line"><span class="lineno">  546</span>    exp_nms_scores = [[.9, 0, 0, 0],</div>
<div class="line"><span class="lineno">  547</span>                      [.5, 0, 0, 0]]</div>
<div class="line"><span class="lineno">  548</span>    exp_nms_classes = [[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  549</span>                       [0, 0, 0, 0]]</div>
<div class="line"><span class="lineno">  550</span>    exp_nms_masks = [[[[0, 1], [2, 3]],</div>
<div class="line"><span class="lineno">  551</span>                      [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  552</span>                      [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  553</span>                      [[0, 0], [0, 0]]],</div>
<div class="line"><span class="lineno">  554</span>                     [[[8, 9], [10, 11]],</div>
<div class="line"><span class="lineno">  555</span>                      [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  556</span>                      [[0, 0], [0, 0]],</div>
<div class="line"><span class="lineno">  557</span>                      [[0, 0], [0, 0]]]]</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  560</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  561</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  562</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  563</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  564</span>        num_valid_boxes=num_valid_boxes, masks=masks)</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  569</span>      (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  570</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  571</span>                                   nmsed_masks, num_detections])</div>
<div class="line"><span class="lineno">  572</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  573</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  574</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  575</span>      self.assertAllClose(num_detections, [1, 1])</div>
<div class="line"><span class="lineno">  576</span>      self.assertAllClose(nmsed_masks, exp_nms_masks)</div>
<div class="line"><span class="lineno">  577</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a2342f5b24538a47a5573f748ef4e54cf" name="a2342f5b24538a47a5573f748ef4e54cf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2342f5b24538a47a5573f748ef4e54cf">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_per_batch_clip_window()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_per_batch_clip_window </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00147">147</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  147</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_per_batch_clip_window(self):</div>
<div class="line"><span class="lineno">  148</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  149</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  150</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  151</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  152</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  153</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  154</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  155</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  156</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  157</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  158</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  159</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  160</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  161</span>    clip_window = tf.constant([0., 0., 200., 200.])</div>
<div class="line"><span class="lineno">  162</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  163</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  164</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>    exp_nms_corners = np.array([[[0, 10, 1, 11],</div>
<div class="line"><span class="lineno">  167</span>                                 [0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  168</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  169</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  170</span>                                [[0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  171</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  172</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  173</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  174</span>    exp_nms_scores = np.array([[.95, .9, 0, 0],</div>
<div class="line"><span class="lineno">  175</span>                               [.5, .3, 0, 0]])</div>
<div class="line"><span class="lineno">  176</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  177</span>                                [0, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  180</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  181</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  182</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  183</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  184</span>        clip_window=clip_window)</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">  187</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  188</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  189</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(),</div>
<div class="line"><span class="lineno">  190</span>                        exp_nms_corners.shape)</div>
<div class="line"><span class="lineno">  191</span>    self.assertAllEqual(nmsed_scores.shape.as_list(),</div>
<div class="line"><span class="lineno">  192</span>                        exp_nms_scores.shape)</div>
<div class="line"><span class="lineno">  193</span>    self.assertAllEqual(nmsed_classes.shape.as_list(),</div>
<div class="line"><span class="lineno">  194</span>                        exp_nms_classes.shape)</div>
<div class="line"><span class="lineno">  195</span>    self.assertEqual(num_detections.shape.as_list(), [2])</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  198</span>      (nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  199</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  200</span>                                   num_detections])</div>
<div class="line"><span class="lineno">  201</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  202</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  203</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  204</span>      self.assertAllClose(num_detections, [2, 2])</div>
<div class="line"><span class="lineno">  205</span> </div>
</div><!-- fragment -->
</div>
</div>
<a id="a8feb116f6e6ad2122161838261eb1ea8" name="a8feb116f6e6ad2122161838261eb1ea8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8feb116f6e6ad2122161838261eb1ea8">&#9670;&#160;</a></span>test_batch_multiclass_nms_with_per_image_clip_window()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.batch_multiclass_nms_test.BatchMulticlassNonMaxSuppressionTest.test_batch_multiclass_nms_with_per_image_clip_window </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html#l00206">206</a> of file <a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  206</span>  <span class="keyword">def </span>test_batch_multiclass_nms_with_per_image_clip_window(self):</div>
<div class="line"><span class="lineno">  207</span>    boxes = tf.constant([[[[0, 0, 1, 1], [0, 0, 4, 5]],</div>
<div class="line"><span class="lineno">  208</span>                          [[0, 0.1, 1, 1.1], [0, 0.1, 2, 1.1]],</div>
<div class="line"><span class="lineno">  209</span>                          [[0, -0.1, 1, 0.9], [0, -0.1, 1, 0.9]],</div>
<div class="line"><span class="lineno">  210</span>                          [[0, 10, 1, 11], [0, 10, 1, 11]]],</div>
<div class="line"><span class="lineno">  211</span>                         [[[0, 10.1, 1, 11.1], [0, 10.1, 1, 11.1]],</div>
<div class="line"><span class="lineno">  212</span>                          [[0, 100, 1, 101], [0, 100, 1, 101]],</div>
<div class="line"><span class="lineno">  213</span>                          [[0, 1000, 1, 1002], [0, 999, 2, 1004]],</div>
<div class="line"><span class="lineno">  214</span>                          [[0, 1000, 1, 1002.1], [0, 999, 2, 1002.7]]]],</div>
<div class="line"><span class="lineno">  215</span>                        tf.float32)</div>
<div class="line"><span class="lineno">  216</span>    scores = tf.constant([[[.9, 0.01], [.75, 0.05],</div>
<div class="line"><span class="lineno">  217</span>                           [.6, 0.01], [.95, 0]],</div>
<div class="line"><span class="lineno">  218</span>                          [[.5, 0.01], [.3, 0.01],</div>
<div class="line"><span class="lineno">  219</span>                           [.01, .85], [.01, .5]]])</div>
<div class="line"><span class="lineno">  220</span>    clip_window = tf.constant([[0., 0., 5., 5.],</div>
<div class="line"><span class="lineno">  221</span>                               [0., 0., 200., 200.]])</div>
<div class="line"><span class="lineno">  222</span>    score_thresh = 0.1</div>
<div class="line"><span class="lineno">  223</span>    iou_thresh = .5</div>
<div class="line"><span class="lineno">  224</span>    max_output_size = 4</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    exp_nms_corners = np.array([[[0, 0, 1, 1],</div>
<div class="line"><span class="lineno">  227</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  228</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  229</span>                                 [0, 0, 0, 0]],</div>
<div class="line"><span class="lineno">  230</span>                                [[0, 10.1, 1, 11.1],</div>
<div class="line"><span class="lineno">  231</span>                                 [0, 100, 1, 101],</div>
<div class="line"><span class="lineno">  232</span>                                 [0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  233</span>                                 [0, 0, 0, 0]]])</div>
<div class="line"><span class="lineno">  234</span>    exp_nms_scores = np.array([[.9, 0., 0., 0.],</div>
<div class="line"><span class="lineno">  235</span>                               [.5, .3, 0, 0]])</div>
<div class="line"><span class="lineno">  236</span>    exp_nms_classes = np.array([[0, 0, 0, 0],</div>
<div class="line"><span class="lineno">  237</span>                                [0, 0, 0, 0]])</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    (nmsed_boxes, nmsed_scores, nmsed_classes, nmsed_masks,</div>
<div class="line"><span class="lineno">  240</span>     nmsed_additional_fields, num_detections</div>
<div class="line"><span class="lineno">  241</span>    ) = post_processing.batch_multiclass_non_max_suppression(</div>
<div class="line"><span class="lineno">  242</span>        boxes, scores, score_thresh, iou_thresh,</div>
<div class="line"><span class="lineno">  243</span>        max_size_per_class=max_output_size, max_total_size=max_output_size,</div>
<div class="line"><span class="lineno">  244</span>        clip_window=clip_window)</div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    self.assertIsNone(nmsed_masks)</div>
<div class="line"><span class="lineno">  247</span>    self.assertIsNone(nmsed_additional_fields)</div>
<div class="line"><span class="lineno">  248</span>    <span class="comment"># Check static shapes</span></div>
<div class="line"><span class="lineno">  249</span>    self.assertAllEqual(nmsed_boxes.shape.as_list(),</div>
<div class="line"><span class="lineno">  250</span>                        exp_nms_corners.shape)</div>
<div class="line"><span class="lineno">  251</span>    self.assertAllEqual(nmsed_scores.shape.as_list(),</div>
<div class="line"><span class="lineno">  252</span>                        exp_nms_scores.shape)</div>
<div class="line"><span class="lineno">  253</span>    self.assertAllEqual(nmsed_classes.shape.as_list(),</div>
<div class="line"><span class="lineno">  254</span>                        exp_nms_classes.shape)</div>
<div class="line"><span class="lineno">  255</span>    self.assertEqual(num_detections.shape.as_list(), [2])</div>
<div class="line"><span class="lineno">  256</span> </div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">with</span> self.test_session() <span class="keyword">as</span> sess:</div>
<div class="line"><span class="lineno">  258</span>      (nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  259</span>       num_detections) = sess.run([nmsed_boxes, nmsed_scores, nmsed_classes,</div>
<div class="line"><span class="lineno">  260</span>                                   num_detections])</div>
<div class="line"><span class="lineno">  261</span>      self.assertAllClose(nmsed_boxes, exp_nms_corners)</div>
<div class="line"><span class="lineno">  262</span>      self.assertAllClose(nmsed_scores, exp_nms_scores)</div>
<div class="line"><span class="lineno">  263</span>      self.assertAllClose(nmsed_classes, exp_nms_classes)</div>
<div class="line"><span class="lineno">  264</span>      self.assertAllClose(num_detections, [1, 2])</div>
<div class="line"><span class="lineno">  265</span> </div>
</div><!-- fragment -->
</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/resources/processing/video/detections/detection_utils/core/<a class="el" href="../../d1/d6b/batch__multiclass__nms__test_8py_source.html">batch_multiclass_nms_test.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
