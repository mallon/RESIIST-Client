<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RESIIST: detection_utils.core.losses.HardExampleMiner Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">RESIIST
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="../../d8/d97/namespacedetection__utils.html">detection_utils</a></li><li class="navelem"><a class="el" href="../../de/d5d/namespacedetection__utils_1_1core.html">core</a></li><li class="navelem"><a class="el" href="../../d5/d10/namespacedetection__utils_1_1core_1_1losses.html">losses</a></li><li class="navelem"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html">HardExampleMiner</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="../../d5/d8c/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">detection_utils.core.losses.HardExampleMiner Class Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Inheritance diagram for detection_utils.core.losses.HardExampleMiner:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/dde/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner__inherit__graph.png" border="0" usemap="#adetection__utils_8core_8losses_8_hard_example_miner_inherit__map" alt="Inheritance graph"/></div>
<map name="adetection__utils_8core_8losses_8_hard_example_miner_inherit__map" id="adetection__utils_8core_8losses_8_hard_example_miner_inherit__map">
<area shape="rect" title=" " alt="" coords="5,119,195,463"/>
<area shape="rect" title=" " alt="" coords="75,5,125,71"/>
<area shape="poly" title=" " alt="" coords="103,85,103,118,97,118,97,85"/>
</map>
</div>
<div class="dynheader">
Collaboration diagram for detection_utils.core.losses.HardExampleMiner:</div>
<div class="dyncontent">
<div class="center"><img src="../../da/d93/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner__coll__graph.png" border="0" usemap="#adetection__utils_8core_8losses_8_hard_example_miner_coll__map" alt="Collaboration graph"/></div>
<map name="adetection__utils_8core_8losses_8_hard_example_miner_coll__map" id="adetection__utils_8core_8losses_8_hard_example_miner_coll__map">
<area shape="rect" title=" " alt="" coords="5,119,195,463"/>
<area shape="rect" title=" " alt="" coords="75,5,125,71"/>
<area shape="poly" title=" " alt="" coords="103,85,103,118,97,118,97,85"/>
</map>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a4714a733ae4075fe0201c4ae524c893b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a4714a733ae4075fe0201c4ae524c893b">__init__</a> (self, num_hard_examples=64, iou_threshold=0.7, loss_type='both', cls_loss_weight=0.05, loc_loss_weight=0.06, max_negatives_per_positive=None, min_negatives_per_image=0)</td></tr>
<tr class="separator:a4714a733ae4075fe0201c4ae524c893b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f13fd5f8f6e0f1fbe3297cad7cebd0f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a7f13fd5f8f6e0f1fbe3297cad7cebd0f">__call__</a> (self, location_losses, cls_losses, decoded_boxlist_list, match_list=None)</td></tr>
<tr class="separator:a7f13fd5f8f6e0f1fbe3297cad7cebd0f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5102f1118d6088014302904479ff3f81"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a5102f1118d6088014302904479ff3f81">summarize</a> (self)</td></tr>
<tr class="separator:a5102f1118d6088014302904479ff3f81"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:ad1541128616ed73e7e7d669330909b48"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#ad1541128616ed73e7e7d669330909b48">_subsample_selection_to_desired_neg_pos_ratio</a> (self, indices, match, max_negatives_per_positive, min_negatives_per_image=0)</td></tr>
<tr class="separator:ad1541128616ed73e7e7d669330909b48"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a9050aefac710d08563f24a578253c5ea"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a9050aefac710d08563f24a578253c5ea">_num_hard_examples</a></td></tr>
<tr class="separator:a9050aefac710d08563f24a578253c5ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf91868a8598f087df796a515012f05b"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#acf91868a8598f087df796a515012f05b">_iou_threshold</a></td></tr>
<tr class="separator:acf91868a8598f087df796a515012f05b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e62eb86f10ebdf80850f4490719f292"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a6e62eb86f10ebdf80850f4490719f292">_loss_type</a></td></tr>
<tr class="separator:a6e62eb86f10ebdf80850f4490719f292"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aada46a2de44d7810ebc15e830599004a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#aada46a2de44d7810ebc15e830599004a">_cls_loss_weight</a></td></tr>
<tr class="separator:aada46a2de44d7810ebc15e830599004a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53dea51ec308ccfdb6517195b24e3a57"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a53dea51ec308ccfdb6517195b24e3a57">_loc_loss_weight</a></td></tr>
<tr class="separator:a53dea51ec308ccfdb6517195b24e3a57"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c4ee1d3c14876d6ac0f3cb444a2c0eb"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a0c4ee1d3c14876d6ac0f3cb444a2c0eb">_max_negatives_per_positive</a></td></tr>
<tr class="separator:a0c4ee1d3c14876d6ac0f3cb444a2c0eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad7dc2027cdc13b61de9ba1daab9779af"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#ad7dc2027cdc13b61de9ba1daab9779af">_min_negatives_per_image</a></td></tr>
<tr class="separator:ad7dc2027cdc13b61de9ba1daab9779af"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad9f01903634e61d36c7ebfefed1edc4e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#ad9f01903634e61d36c7ebfefed1edc4e">_num_positives_list</a></td></tr>
<tr class="separator:ad9f01903634e61d36c7ebfefed1edc4e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04a79ab082067e7db546cdbe01f734f8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a04a79ab082067e7db546cdbe01f734f8">_num_negatives_list</a></td></tr>
<tr class="separator:a04a79ab082067e7db546cdbe01f734f8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">Hard example mining for regions in a list of images.

Implements hard example mining to select a subset of regions to be
back-propagated. For each image, selects the regions with highest losses,
subject to the condition that a newly selected region cannot have
an IOU &gt; iou_threshold with any of the previously selected regions.
This can be achieved by re-using a greedy non-maximum suppression algorithm.
A constraint on the number of negatives mined per positive region can also be
enforced.

Reference papers: "Training Region-based Object Detectors with Online
Hard Example Mining" (CVPR 2016) by Srivastava et al., and
"SSD: Single Shot MultiBox Detector" (ECCV 2016) by Liu et al.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00469">469</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a4714a733ae4075fe0201c4ae524c893b" name="a4714a733ae4075fe0201c4ae524c893b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4714a733ae4075fe0201c4ae524c893b">&#9670;&#160;</a></span>__init__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner.__init__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>num_hard_examples</em> = <code>64</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>iou_threshold</em> = <code>0.7</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>loss_type</em> = <code>'both'</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls_loss_weight</em> = <code>0.05</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>loc_loss_weight</em> = <code>0.06</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_negatives_per_positive</em> = <code>None</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_negatives_per_image</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Constructor.

The hard example mining implemented by this class can replicate the behavior
in the two aforementioned papers (Srivastava et al., and Liu et al).
To replicate the A2 paper (Srivastava et al), num_hard_examples is set
to a fixed parameter (64 by default) and iou_threshold is set to .7 for
running non-max-suppression the predicted boxes prior to hard mining.
In order to replicate the SSD paper (Liu et al), num_hard_examples should
be set to None, max_negatives_per_positive should be 3 and iou_threshold
should be 1.0 (in order to effectively turn off NMS).

Args:
  num_hard_examples: maximum number of hard examples to be
    selected per image (prior to enforcing max negative to positive ratio
    constraint).  If set to None, all examples obtained after NMS are
    considered.
  iou_threshold: minimum intersection over union for an example
    to be discarded during NMS.
  loss_type: use only classification losses ('cls', default),
    localization losses ('loc') or both losses ('both').
    In the last case, cls_loss_weight and loc_loss_weight are used to
    compute weighted sum of the two losses.
  cls_loss_weight: weight for classification loss.
  loc_loss_weight: weight for location loss.
  max_negatives_per_positive: maximum number of negatives to retain for
    each positive anchor. By default, num_negatives_per_positive is None,
    which means that we do not enforce a prespecified negative:positive
    ratio.  Note also that num_negatives_per_positives can be a float
    (and will be converted to be a float even if it is passed in otherwise).
  min_negatives_per_image: minimum number of negative anchors to sample for
    a given image. Setting this to a positive number allows sampling
    negatives in an image without any positive anchors and thus not biased
    towards at least one detection per image.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00485">485</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  492</span>               min_negatives_per_image=0):</div>
<div class="line"><span class="lineno">  493</span>    <span class="stringliteral">&quot;&quot;&quot;Constructor.</span></div>
<div class="line"><span class="lineno">  494</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  495</span><span class="stringliteral">    The hard example mining implemented by this </span><span class="keyword">class </span>can replicate the behavior</div>
<div class="line"><span class="lineno">  496</span>    <span class="keywordflow">in</span> the two aforementioned papers (Srivastava et al., <span class="keywordflow">and</span> Liu et al).</div>
<div class="line"><span class="lineno">  497</span>    To replicate the A2 paper (Srivastava et al), num_hard_examples <span class="keywordflow">is</span> set</div>
<div class="line"><span class="lineno">  498</span>    to a fixed parameter (64 by default) <span class="keywordflow">and</span> iou_threshold <span class="keywordflow">is</span> set to .7 <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno">  499</span>    running non-max-suppression the predicted boxes prior to hard mining.</div>
<div class="line"><span class="lineno">  500</span>    In order to replicate the SSD paper (Liu et al), num_hard_examples should</div>
<div class="line"><span class="lineno">  501</span>    be set to <span class="keywordtype">None</span>, max_negatives_per_positive should be 3 <span class="keywordflow">and</span> iou_threshold</div>
<div class="line"><span class="lineno">  502</span>    should be 1.0 (<span class="keywordflow">in</span> order to effectively turn off NMS).</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    Args:</div>
<div class="line"><span class="lineno">  505</span>      num_hard_examples: maximum number of hard examples to be</div>
<div class="line"><span class="lineno">  506</span>        selected per image (prior to enforcing max negative to positive ratio</div>
<div class="line"><span class="lineno">  507</span>        constraint).  If set to <span class="keywordtype">None</span>, all examples obtained after NMS are</div>
<div class="line"><span class="lineno">  508</span>        considered.</div>
<div class="line"><span class="lineno">  509</span>      iou_threshold: minimum intersection over union <span class="keywordflow">for</span> an example</div>
<div class="line"><span class="lineno">  510</span>        to be discarded during NMS.</div>
<div class="line"><span class="lineno">  511</span>      loss_type: use only classification losses (<span class="stringliteral">&#39;cls&#39;</span>, default),</div>
<div class="line"><span class="lineno">  512</span>        localization losses (<span class="stringliteral">&#39;loc&#39;</span>) <span class="keywordflow">or</span> both losses (<span class="stringliteral">&#39;both&#39;</span>).</div>
<div class="line"><span class="lineno">  513</span>        In the last case, cls_loss_weight <span class="keywordflow">and</span> loc_loss_weight are used to</div>
<div class="line"><span class="lineno">  514</span>        compute weighted sum of the two losses.</div>
<div class="line"><span class="lineno">  515</span>      cls_loss_weight: weight <span class="keywordflow">for</span> classification loss.</div>
<div class="line"><span class="lineno">  516</span>      loc_loss_weight: weight <span class="keywordflow">for</span> location loss.</div>
<div class="line"><span class="lineno">  517</span>      max_negatives_per_positive: maximum number of negatives to retain <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno">  518</span>        each positive anchor. By default, num_negatives_per_positive <span class="keywordflow">is</span> <span class="keywordtype">None</span>,</div>
<div class="line"><span class="lineno">  519</span>        which means that we do <span class="keywordflow">not</span> enforce a prespecified negative:positive</div>
<div class="line"><span class="lineno">  520</span>        ratio.  Note also that num_negatives_per_positives can be a float</div>
<div class="line"><span class="lineno">  521</span>        (<span class="keywordflow">and</span> will be converted to be a float even <span class="keywordflow">if</span> it <span class="keywordflow">is</span> passed <span class="keywordflow">in</span> otherwise).</div>
<div class="line"><span class="lineno">  522</span>      min_negatives_per_image: minimum number of negative anchors to sample <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno">  523</span>        a given image. Setting this to a positive number allows sampling</div>
<div class="line"><span class="lineno">  524</span>        negatives <span class="keywordflow">in</span> an image without any positive anchors <span class="keywordflow">and</span> thus <span class="keywordflow">not</span> biased</div>
<div class="line"><span class="lineno">  525</span>        towards at least one detection per image.</div>
<div class="line"><span class="lineno">  526</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  527</span><span class="stringliteral">    self._num_hard_examples = num_hard_examples</span></div>
<div class="line"><span class="lineno">  528</span><span class="stringliteral">    self._iou_threshold = iou_threshold</span></div>
<div class="line"><span class="lineno">  529</span><span class="stringliteral">    self._loss_type = loss_type</span></div>
<div class="line"><span class="lineno">  530</span><span class="stringliteral">    self._cls_loss_weight = cls_loss_weight</span></div>
<div class="line"><span class="lineno">  531</span><span class="stringliteral">    self._loc_loss_weight = loc_loss_weight</span></div>
<div class="line"><span class="lineno">  532</span><span class="stringliteral">    self._max_negatives_per_positive = max_negatives_per_positive</span></div>
<div class="line"><span class="lineno">  533</span><span class="stringliteral">    self._min_negatives_per_image = min_negatives_per_image</span></div>
<div class="line"><span class="lineno">  534</span><span class="stringliteral">    </span><span class="keywordflow">if</span> self._max_negatives_per_positive <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  535</span>      self._max_negatives_per_positive = float(self._max_negatives_per_positive)</div>
<div class="line"><span class="lineno">  536</span>    self._num_positives_list = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  537</span>    self._num_negatives_list = <span class="keywordtype">None</span></div>
<div class="line"><span class="lineno">  538</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a7f13fd5f8f6e0f1fbe3297cad7cebd0f" name="a7f13fd5f8f6e0f1fbe3297cad7cebd0f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f13fd5f8f6e0f1fbe3297cad7cebd0f">&#9670;&#160;</a></span>__call__()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner.__call__ </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>location_losses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>cls_losses</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>decoded_boxlist_list</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match_list</em> = <code>None</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Computes localization and classification losses after hard mining.

Args:
  location_losses: a float tensor of shape [num_images, num_anchors]
    representing anchorwise localization losses.
  cls_losses: a float tensor of shape [num_images, num_anchors]
    representing anchorwise classification losses.
  decoded_boxlist_list: a list of decoded BoxList representing location
    predictions for each image.
  match_list: an optional list of matcher.Match objects encoding the match
    between anchors and groundtruth boxes for each image of the batch,
    with rows of the Match objects corresponding to groundtruth boxes
    and columns corresponding to anchors.  Match objects in match_list are
    used to reference which anchors are positive, negative or ignored.  If
    self._max_negatives_per_positive exists, these are then used to enforce
    a prespecified negative to positive ratio.

Returns:
  mined_location_loss: a float scalar with sum of localization losses from
    selected hard examples.
  mined_cls_loss: a float scalar with sum of classification losses from
    selected hard examples.
Raises:
  ValueError: if location_losses, cls_losses and decoded_boxlist_list do
    not have compatible shapes (i.e., they must correspond to the same
    number of images).
  ValueError: if match_list is specified but its length does not match
    len(decoded_boxlist_list).
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00539">539</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  543</span>               match_list=<span class="keywordtype">None</span>):</div>
<div class="line"><span class="lineno">  544</span>    <span class="stringliteral">&quot;&quot;&quot;Computes localization and classification losses after hard mining.</span></div>
<div class="line"><span class="lineno">  545</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  546</span><span class="stringliteral">    Args:</span></div>
<div class="line"><span class="lineno">  547</span><span class="stringliteral">      location_losses: a float tensor of shape [num_images, num_anchors]</span></div>
<div class="line"><span class="lineno">  548</span><span class="stringliteral">        representing anchorwise localization losses.</span></div>
<div class="line"><span class="lineno">  549</span><span class="stringliteral">      cls_losses: a float tensor of shape [num_images, num_anchors]</span></div>
<div class="line"><span class="lineno">  550</span><span class="stringliteral">        representing anchorwise classification losses.</span></div>
<div class="line"><span class="lineno">  551</span><span class="stringliteral">      decoded_boxlist_list: a list of decoded BoxList representing location</span></div>
<div class="line"><span class="lineno">  552</span><span class="stringliteral">        predictions </span><span class="keywordflow">for</span> each image.</div>
<div class="line"><span class="lineno">  553</span>      match_list: an optional list of matcher.Match objects encoding the match</div>
<div class="line"><span class="lineno">  554</span>        between anchors <span class="keywordflow">and</span> groundtruth boxes <span class="keywordflow">for</span> each image of the batch,</div>
<div class="line"><span class="lineno">  555</span>        <span class="keyword">with</span> rows of the Match objects corresponding to groundtruth boxes</div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">and</span> columns corresponding to anchors.  Match objects <span class="keywordflow">in</span> match_list are</div>
<div class="line"><span class="lineno">  557</span>        used to reference which anchors are positive, negative <span class="keywordflow">or</span> ignored.  If</div>
<div class="line"><span class="lineno">  558</span>        self._max_negatives_per_positive exists, these are then used to enforce</div>
<div class="line"><span class="lineno">  559</span>        a prespecified negative to positive ratio.</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    Returns:</div>
<div class="line"><span class="lineno">  562</span>      mined_location_loss: a float scalar <span class="keyword">with</span> sum of localization losses <span class="keyword">from</span></div>
<div class="line"><span class="lineno">  563</span>        selected hard examples.</div>
<div class="line"><span class="lineno">  564</span>      mined_cls_loss: a float scalar <span class="keyword">with</span> sum of classification losses <span class="keyword">from</span></div>
<div class="line"><span class="lineno">  565</span>        selected hard examples.</div>
<div class="line"><span class="lineno">  566</span>    Raises:</div>
<div class="line"><span class="lineno">  567</span>      ValueError: <span class="keywordflow">if</span> location_losses, cls_losses <span class="keywordflow">and</span> decoded_boxlist_list do</div>
<div class="line"><span class="lineno">  568</span>        <span class="keywordflow">not</span> have compatible shapes (i.e., they must correspond to the same</div>
<div class="line"><span class="lineno">  569</span>        number of images).</div>
<div class="line"><span class="lineno">  570</span>      ValueError: <span class="keywordflow">if</span> match_list <span class="keywordflow">is</span> specified but its length does <span class="keywordflow">not</span> match</div>
<div class="line"><span class="lineno">  571</span>        len(decoded_boxlist_list).</div>
<div class="line"><span class="lineno">  572</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  573</span><span class="stringliteral">    mined_location_losses = []</span></div>
<div class="line"><span class="lineno">  574</span><span class="stringliteral">    mined_cls_losses = []</span></div>
<div class="line"><span class="lineno">  575</span><span class="stringliteral">    location_losses = tf.unstack(location_losses)</span></div>
<div class="line"><span class="lineno">  576</span><span class="stringliteral">    cls_losses = tf.unstack(cls_losses)</span></div>
<div class="line"><span class="lineno">  577</span><span class="stringliteral">    num_images = len(decoded_boxlist_list)</span></div>
<div class="line"><span class="lineno">  578</span><span class="stringliteral">    </span><span class="keywordflow">if</span> <span class="keywordflow">not</span> match_list:</div>
<div class="line"><span class="lineno">  579</span>      match_list = num_images * [<span class="keywordtype">None</span>]</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> len(location_losses) == len(decoded_boxlist_list) == len(cls_losses):</div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;location_losses, cls_losses and decoded_boxlist_list &#39;</span></div>
<div class="line"><span class="lineno">  582</span>                       <span class="stringliteral">&#39;do not have compatible shapes.&#39;</span>)</div>
<div class="line"><span class="lineno">  583</span>    <span class="keywordflow">if</span> <span class="keywordflow">not</span> isinstance(match_list, list):</div>
<div class="line"><span class="lineno">  584</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;match_list must be a list.&#39;</span>)</div>
<div class="line"><span class="lineno">  585</span>    <span class="keywordflow">if</span> len(match_list) != len(decoded_boxlist_list):</div>
<div class="line"><span class="lineno">  586</span>      <span class="keywordflow">raise</span> ValueError(<span class="stringliteral">&#39;match_list must either be None or have &#39;</span></div>
<div class="line"><span class="lineno">  587</span>                       <span class="stringliteral">&#39;length=len(decoded_boxlist_list).&#39;</span>)</div>
<div class="line"><span class="lineno">  588</span>    num_positives_list = []</div>
<div class="line"><span class="lineno">  589</span>    num_negatives_list = []</div>
<div class="line"><span class="lineno">  590</span>    <span class="keywordflow">for</span> ind, detection_boxlist <span class="keywordflow">in</span> enumerate(decoded_boxlist_list):</div>
<div class="line"><span class="lineno">  591</span>      box_locations = detection_boxlist.get()</div>
<div class="line"><span class="lineno">  592</span>      match = match_list[ind]</div>
<div class="line"><span class="lineno">  593</span>      image_losses = cls_losses[ind]</div>
<div class="line"><span class="lineno">  594</span>      <span class="keywordflow">if</span> self._loss_type == <span class="stringliteral">&#39;loc&#39;</span>:</div>
<div class="line"><span class="lineno">  595</span>        image_losses = location_losses[ind]</div>
<div class="line"><span class="lineno">  596</span>      <span class="keywordflow">elif</span> self._loss_type == <span class="stringliteral">&#39;both&#39;</span>:</div>
<div class="line"><span class="lineno">  597</span>        image_losses *= self._cls_loss_weight</div>
<div class="line"><span class="lineno">  598</span>        image_losses += location_losses[ind] * self._loc_loss_weight</div>
<div class="line"><span class="lineno">  599</span>      <span class="keywordflow">if</span> self._num_hard_examples <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span>:</div>
<div class="line"><span class="lineno">  600</span>        num_hard_examples = self._num_hard_examples</div>
<div class="line"><span class="lineno">  601</span>      <span class="keywordflow">else</span>:</div>
<div class="line"><span class="lineno">  602</span>        num_hard_examples = detection_boxlist.num_boxes()</div>
<div class="line"><span class="lineno">  603</span>      selected_indices = tf.image.non_max_suppression(</div>
<div class="line"><span class="lineno">  604</span>          box_locations, image_losses, num_hard_examples, self._iou_threshold)</div>
<div class="line"><span class="lineno">  605</span>      <span class="keywordflow">if</span> self._max_negatives_per_positive <span class="keywordflow">is</span> <span class="keywordflow">not</span> <span class="keywordtype">None</span> <span class="keywordflow">and</span> match:</div>
<div class="line"><span class="lineno">  606</span>        (selected_indices, num_positives,</div>
<div class="line"><span class="lineno">  607</span>         num_negatives) = self._subsample_selection_to_desired_neg_pos_ratio(</div>
<div class="line"><span class="lineno">  608</span>             selected_indices, match, self._max_negatives_per_positive,</div>
<div class="line"><span class="lineno">  609</span>             self._min_negatives_per_image)</div>
<div class="line"><span class="lineno">  610</span>        num_positives_list.append(num_positives)</div>
<div class="line"><span class="lineno">  611</span>        num_negatives_list.append(num_negatives)</div>
<div class="line"><span class="lineno">  612</span>      mined_location_losses.append(</div>
<div class="line"><span class="lineno">  613</span>          tf.reduce_sum(tf.gather(location_losses[ind], selected_indices)))</div>
<div class="line"><span class="lineno">  614</span>      mined_cls_losses.append(</div>
<div class="line"><span class="lineno">  615</span>          tf.reduce_sum(tf.gather(cls_losses[ind], selected_indices)))</div>
<div class="line"><span class="lineno">  616</span>    location_loss = tf.reduce_sum(tf.stack(mined_location_losses))</div>
<div class="line"><span class="lineno">  617</span>    cls_loss = tf.reduce_sum(tf.stack(mined_cls_losses))</div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">if</span> match <span class="keywordflow">and</span> self._max_negatives_per_positive:</div>
<div class="line"><span class="lineno">  619</span>      self._num_positives_list = num_positives_list</div>
<div class="line"><span class="lineno">  620</span>      self._num_negatives_list = num_negatives_list</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">return</span> (location_loss, cls_loss)</div>
<div class="line"><span class="lineno">  622</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the call graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_a7f13fd5f8f6e0f1fbe3297cad7cebd0f_cgraph.png" border="0" usemap="#ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_a7f13fd5f8f6e0f1fbe3297cad7cebd0f_cgraph" alt=""/></div>
<map name="ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_a7f13fd5f8f6e0f1fbe3297cad7cebd0f_cgraph" id="ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_a7f13fd5f8f6e0f1fbe3297cad7cebd0f_cgraph">
<area shape="rect" title=" " alt="" coords="5,13,189,53"/>
<area shape="rect" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#ad1541128616ed73e7e7d669330909b48" title=" " alt="" coords="237,5,473,60"/>
<area shape="poly" title=" " alt="" coords="189,30,224,30,224,35,189,35"/>
</map>
</div>

</div>
</div>
<a id="ad1541128616ed73e7e7d669330909b48" name="ad1541128616ed73e7e7d669330909b48"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1541128616ed73e7e7d669330909b48">&#9670;&#160;</a></span>_subsample_selection_to_desired_neg_pos_ratio()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._subsample_selection_to_desired_neg_pos_ratio </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>indices</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>match</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>max_negatives_per_positive</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>min_negatives_per_image</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<pre class="fragment">Subsample a collection of selected indices to a desired neg:pos ratio.

This function takes a subset of M indices (indexing into a large anchor
collection of N anchors where M&lt;N) which are labeled as positive/negative
via a Match object (matched indices are positive, unmatched indices
are negative).  It returns a subset of the provided indices retaining all
positives as well as up to the first K negatives, where:
  K=floor(num_negative_per_positive * num_positives).

For example, if indices=[2, 4, 5, 7, 9, 10] (indexing into 12 anchors),
with positives=[2, 5] and negatives=[4, 7, 9, 10] and
num_negatives_per_positive=1, then the returned subset of indices
is [2, 4, 5, 7].

Args:
  indices: An integer tensor of shape [M] representing a collection
    of selected anchor indices
  match: A matcher.Match object encoding the match between anchors and
    groundtruth boxes for a given image, with rows of the Match objects
    corresponding to groundtruth boxes and columns corresponding to anchors.
  max_negatives_per_positive: (float) maximum number of negatives for
    each positive anchor.
  min_negatives_per_image: minimum number of negative anchors for a given
    image. Allow sampling negatives in image without any positive anchors.

Returns:
  selected_indices: An integer tensor of shape [M'] representing a
    collection of selected anchor indices with M' &lt;= M.
  num_positives: An integer tensor representing the number of positive
    examples in selected set of indices.
  num_negatives: An integer tensor representing the number of negative
    examples in selected set of indices.
</pre> 
<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00633">633</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  637</span>                                                    min_negatives_per_image=0):</div>
<div class="line"><span class="lineno">  638</span>    <span class="stringliteral">&quot;&quot;&quot;Subsample a collection of selected indices to a desired neg:pos ratio.</span></div>
<div class="line"><span class="lineno">  639</span><span class="stringliteral"></span> </div>
<div class="line"><span class="lineno">  640</span><span class="stringliteral">    This function takes a subset of M indices (indexing into a large anchor</span></div>
<div class="line"><span class="lineno">  641</span><span class="stringliteral">    collection of N anchors where M&lt;N) which are labeled </span><span class="keyword">as</span> positive/negative</div>
<div class="line"><span class="lineno">  642</span>    via a Match object (matched indices are positive, unmatched indices</div>
<div class="line"><span class="lineno">  643</span>    are negative).  It returns a subset of the provided indices retaining all</div>
<div class="line"><span class="lineno">  644</span>    positives <span class="keyword">as</span> well <span class="keyword">as</span> up to the first K negatives, where:</div>
<div class="line"><span class="lineno">  645</span>      K=floor(num_negative_per_positive * num_positives).</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>    For example, <span class="keywordflow">if</span> indices=[2, 4, 5, 7, 9, 10] (indexing into 12 anchors),</div>
<div class="line"><span class="lineno">  648</span>    <span class="keyword">with</span> positives=[2, 5] <span class="keywordflow">and</span> negatives=[4, 7, 9, 10] <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  649</span>    num_negatives_per_positive=1, then the returned subset of indices</div>
<div class="line"><span class="lineno">  650</span>    <span class="keywordflow">is</span> [2, 4, 5, 7].</div>
<div class="line"><span class="lineno">  651</span> </div>
<div class="line"><span class="lineno">  652</span>    Args:</div>
<div class="line"><span class="lineno">  653</span>      indices: An integer tensor of shape [M] representing a collection</div>
<div class="line"><span class="lineno">  654</span>        of selected anchor indices</div>
<div class="line"><span class="lineno">  655</span>      match: A matcher.Match object encoding the match between anchors <span class="keywordflow">and</span></div>
<div class="line"><span class="lineno">  656</span>        groundtruth boxes <span class="keywordflow">for</span> a given image, <span class="keyword">with</span> rows of the Match objects</div>
<div class="line"><span class="lineno">  657</span>        corresponding to groundtruth boxes <span class="keywordflow">and</span> columns corresponding to anchors.</div>
<div class="line"><span class="lineno">  658</span>      max_negatives_per_positive: (float) maximum number of negatives <span class="keywordflow">for</span></div>
<div class="line"><span class="lineno">  659</span>        each positive anchor.</div>
<div class="line"><span class="lineno">  660</span>      min_negatives_per_image: minimum number of negative anchors <span class="keywordflow">for</span> a given</div>
<div class="line"><span class="lineno">  661</span>        image. Allow sampling negatives <span class="keywordflow">in</span> image without any positive anchors.</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    Returns:</div>
<div class="line"><span class="lineno">  664</span>      selected_indices: An integer tensor of shape [M<span class="stringliteral">&#39;] representing a</span></div>
<div class="line"><span class="lineno">  665</span><span class="stringliteral">        collection of selected anchor indices </span><span class="keyword">with</span> M<span class="stringliteral">&#39; &lt;= M.</span></div>
<div class="line"><span class="lineno">  666</span><span class="stringliteral">      num_positives: An integer tensor representing the number of positive</span></div>
<div class="line"><span class="lineno">  667</span><span class="stringliteral">        examples </span><span class="keywordflow">in</span> selected set of indices.</div>
<div class="line"><span class="lineno">  668</span>      num_negatives: An integer tensor representing the number of negative</div>
<div class="line"><span class="lineno">  669</span>        examples <span class="keywordflow">in</span> selected set of indices.</div>
<div class="line"><span class="lineno">  670</span>    <span class="stringliteral">&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  671</span><span class="stringliteral">    positives_indicator = tf.gather(match.matched_column_indicator(), indices)</span></div>
<div class="line"><span class="lineno">  672</span><span class="stringliteral">    negatives_indicator = tf.gather(match.unmatched_column_indicator(), indices)</span></div>
<div class="line"><span class="lineno">  673</span><span class="stringliteral">    num_positives = tf.reduce_sum(tf.cast(positives_indicator, dtype=tf.int32))</span></div>
<div class="line"><span class="lineno">  674</span><span class="stringliteral">    max_negatives = tf.maximum(</span></div>
<div class="line"><span class="lineno">  675</span><span class="stringliteral">        min_negatives_per_image,</span></div>
<div class="line"><span class="lineno">  676</span><span class="stringliteral">        tf.cast(max_negatives_per_positive *</span></div>
<div class="line"><span class="lineno">  677</span><span class="stringliteral">                tf.cast(num_positives, dtype=tf.float32), dtype=tf.int32))</span></div>
<div class="line"><span class="lineno">  678</span><span class="stringliteral">    topk_negatives_indicator = tf.less_equal(</span></div>
<div class="line"><span class="lineno">  679</span><span class="stringliteral">        tf.cumsum(tf.cast(negatives_indicator, dtype=tf.int32)), max_negatives)</span></div>
<div class="line"><span class="lineno">  680</span><span class="stringliteral">    subsampled_selection_indices = tf.where(</span></div>
<div class="line"><span class="lineno">  681</span><span class="stringliteral">        tf.logical_or(positives_indicator, topk_negatives_indicator))</span></div>
<div class="line"><span class="lineno">  682</span><span class="stringliteral">    num_negatives = tf.size(subsampled_selection_indices) - num_positives</span></div>
<div class="line"><span class="lineno">  683</span><span class="stringliteral">    </span><span class="keywordflow">return</span> (tf.reshape(tf.gather(indices, subsampled_selection_indices), [-1]),</div>
<div class="line"><span class="lineno">  684</span>            num_positives, num_negatives)</div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span> </div>
</div><!-- fragment --><div class="dynheader">
Here is the caller graph for this function:</div>
<div class="dyncontent">
<div class="center"><img src="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_ad1541128616ed73e7e7d669330909b48_icgraph.png" border="0" usemap="#ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_ad1541128616ed73e7e7d669330909b48_icgraph" alt=""/></div>
<map name="ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_ad1541128616ed73e7e7d669330909b48_icgraph" id="ad5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner_ad1541128616ed73e7e7d669330909b48_icgraph">
<area shape="rect" title=" " alt="" coords="237,5,473,60"/>
<area shape="rect" href="../../d5/dd7/classdetection__utils_1_1core_1_1losses_1_1_hard_example_miner.html#a7f13fd5f8f6e0f1fbe3297cad7cebd0f" title=" " alt="" coords="5,13,189,53"/>
<area shape="poly" title=" " alt="" coords="224,35,189,35,189,30,224,30"/>
</map>
</div>

</div>
</div>
<a id="a5102f1118d6088014302904479ff3f81" name="a5102f1118d6088014302904479ff3f81"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5102f1118d6088014302904479ff3f81">&#9670;&#160;</a></span>summarize()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner.summarize </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>self</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">Summarize the number of positives and negatives after mining.</pre> 
<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00623">623</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  623</span>  <span class="keyword">def </span>summarize(self):</div>
<div class="line"><span class="lineno">  624</span>    <span class="stringliteral">&quot;&quot;&quot;Summarize the number of positives and negatives after mining.&quot;&quot;&quot;</span></div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">if</span> self._num_positives_list <span class="keywordflow">and</span> self._num_negatives_list:</div>
<div class="line"><span class="lineno">  626</span>      avg_num_positives = tf.reduce_mean(</div>
<div class="line"><span class="lineno">  627</span>          tf.cast(self._num_positives_list, dtype=tf.float32))</div>
<div class="line"><span class="lineno">  628</span>      avg_num_negatives = tf.reduce_mean(</div>
<div class="line"><span class="lineno">  629</span>          tf.cast(self._num_negatives_list, dtype=tf.float32))</div>
<div class="line"><span class="lineno">  630</span>      tf.summary.scalar(<span class="stringliteral">&#39;HardExampleMiner/NumPositives&#39;</span>, avg_num_positives)</div>
<div class="line"><span class="lineno">  631</span>      tf.summary.scalar(<span class="stringliteral">&#39;HardExampleMiner/NumNegatives&#39;</span>, avg_num_negatives)</div>
<div class="line"><span class="lineno">  632</span> </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="aada46a2de44d7810ebc15e830599004a" name="aada46a2de44d7810ebc15e830599004a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aada46a2de44d7810ebc15e830599004a">&#9670;&#160;</a></span>_cls_loss_weight</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._cls_loss_weight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00530">530</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="acf91868a8598f087df796a515012f05b" name="acf91868a8598f087df796a515012f05b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf91868a8598f087df796a515012f05b">&#9670;&#160;</a></span>_iou_threshold</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._iou_threshold</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00528">528</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="a53dea51ec308ccfdb6517195b24e3a57" name="a53dea51ec308ccfdb6517195b24e3a57"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53dea51ec308ccfdb6517195b24e3a57">&#9670;&#160;</a></span>_loc_loss_weight</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._loc_loss_weight</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00531">531</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="a6e62eb86f10ebdf80850f4490719f292" name="a6e62eb86f10ebdf80850f4490719f292"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e62eb86f10ebdf80850f4490719f292">&#9670;&#160;</a></span>_loss_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._loss_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00529">529</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="a0c4ee1d3c14876d6ac0f3cb444a2c0eb" name="a0c4ee1d3c14876d6ac0f3cb444a2c0eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c4ee1d3c14876d6ac0f3cb444a2c0eb">&#9670;&#160;</a></span>_max_negatives_per_positive</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._max_negatives_per_positive</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00532">532</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="ad7dc2027cdc13b61de9ba1daab9779af" name="ad7dc2027cdc13b61de9ba1daab9779af"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad7dc2027cdc13b61de9ba1daab9779af">&#9670;&#160;</a></span>_min_negatives_per_image</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._min_negatives_per_image</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00533">533</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="a9050aefac710d08563f24a578253c5ea" name="a9050aefac710d08563f24a578253c5ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9050aefac710d08563f24a578253c5ea">&#9670;&#160;</a></span>_num_hard_examples</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._num_hard_examples</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00527">527</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="a04a79ab082067e7db546cdbe01f734f8" name="a04a79ab082067e7db546cdbe01f734f8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04a79ab082067e7db546cdbe01f734f8">&#9670;&#160;</a></span>_num_negatives_list</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._num_negatives_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00537">537</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<a id="ad9f01903634e61d36c7ebfefed1edc4e" name="ad9f01903634e61d36c7ebfefed1edc4e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad9f01903634e61d36c7ebfefed1edc4e">&#9670;&#160;</a></span>_num_positives_list</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">detection_utils.core.losses.HardExampleMiner._num_positives_list</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/db7/losses_8py_source.html#l00536">536</a> of file <a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>src/main/resources/processing/video/detections/detection_utils/core/<a class="el" href="../../dc/db7/losses_8py_source.html">losses.py</a></li>
</ul>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7
</small></address>
</body>
</html>
