\doxysection{detection\+\_\+utils.\+utils.\+metrics Namespace Reference}
\hypertarget{namespacedetection__utils_1_1utils_1_1metrics}{}\label{namespacedetection__utils_1_1utils_1_1metrics}\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{namespacedetection__utils_1_1utils_1_1metrics_aa5958d51e1d62d49fa7cf782d046b674}{compute\+\_\+precision\+\_\+recall}} (scores, labels, num\+\_\+gt)
\item 
\mbox{\hyperlink{namespacedetection__utils_1_1utils_1_1metrics_a0f0aef1fb969045b86737668191fde81}{compute\+\_\+average\+\_\+precision}} (precision, recall)
\item 
\mbox{\hyperlink{namespacedetection__utils_1_1utils_1_1metrics_a7c2abf31157d3c5d95e47a1b8f2d3af3}{compute\+\_\+cor\+\_\+loc}} (num\+\_\+gt\+\_\+imgs\+\_\+per\+\_\+class, num\+\_\+images\+\_\+correctly\+\_\+detected\+\_\+per\+\_\+class)
\item 
\mbox{\hyperlink{namespacedetection__utils_1_1utils_1_1metrics_aea6346c967800d2ec215d698fbf39082}{compute\+\_\+median\+\_\+rank\+\_\+at\+\_\+k}} (tp\+\_\+fp\+\_\+list, k)
\item 
\mbox{\hyperlink{namespacedetection__utils_1_1utils_1_1metrics_a27dea25701e731a64eb95c6244ca5bc0}{compute\+\_\+recall\+\_\+at\+\_\+k}} (tp\+\_\+fp\+\_\+list, num\+\_\+gt, k)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Functions for computing metrics like precision, recall, CorLoc and etc.\end{DoxyVerb}
 

\doxysubsection{Function Documentation}
\Hypertarget{namespacedetection__utils_1_1utils_1_1metrics_a0f0aef1fb969045b86737668191fde81}\label{namespacedetection__utils_1_1utils_1_1metrics_a0f0aef1fb969045b86737668191fde81} 
\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}!compute\_average\_precision@{compute\_average\_precision}}
\index{compute\_average\_precision@{compute\_average\_precision}!detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection{\texorpdfstring{compute\_average\_precision()}{compute\_average\_precision()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+metrics.\+compute\+\_\+average\+\_\+precision (\begin{DoxyParamCaption}\item[{}]{precision,  }\item[{}]{recall }\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute Average Precision according to the definition in VOCdevkit.

Precision is modified to ensure that it does not decrease as recall
decrease.

Args:
  precision: A float [N, 1] numpy array of precisions
  recall: A float [N, 1] numpy array of recalls

Raises:
  ValueError: if the input is not of the correct format

Returns:
  average_precison: The area under the precision recall curve. NaN if
    precision and recall are None.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{metrics_8py_source_l00072}{72}} of file \mbox{\hyperlink{metrics_8py_source}{metrics.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00072\ \textcolor{keyword}{def\ }compute\_average\_precision(precision,\ recall):}
\DoxyCodeLine{00073\ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ Average\ Precision\ according\ to\ the\ definition\ in\ VOCdevkit.}}
\DoxyCodeLine{00074\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00075\ \textcolor{stringliteral}{\ \ Precision\ }\textcolor{keywordflow}{is}\ modified\ to\ ensure\ that\ it\ does\ \textcolor{keywordflow}{not}\ decrease\ \textcolor{keyword}{as}\ recall}
\DoxyCodeLine{00076\ \ \ decrease.}
\DoxyCodeLine{00077\ }
\DoxyCodeLine{00078\ \ \ Args:}
\DoxyCodeLine{00079\ \ \ \ \ precision:\ A\ float\ [N,\ 1]\ numpy\ array\ of\ precisions}
\DoxyCodeLine{00080\ \ \ \ \ recall:\ A\ float\ [N,\ 1]\ numpy\ array\ of\ recalls}
\DoxyCodeLine{00081\ }
\DoxyCodeLine{00082\ \ \ Raises:}
\DoxyCodeLine{00083\ \ \ \ \ ValueError:\ \textcolor{keywordflow}{if}\ the\ input\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ of\ the\ correct\ format}
\DoxyCodeLine{00084\ }
\DoxyCodeLine{00085\ \ \ Returns:}
\DoxyCodeLine{00086\ \ \ \ \ average\_precison:\ The\ area\ under\ the\ precision\ recall\ curve.\ NaN\ \textcolor{keywordflow}{if}}
\DoxyCodeLine{00087\ \ \ \ \ \ \ precision\ \textcolor{keywordflow}{and}\ recall\ are\ \textcolor{keywordtype}{None}.}
\DoxyCodeLine{00088\ }
\DoxyCodeLine{00089\ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00090\ \textcolor{stringliteral}{\ \ }\textcolor{keywordflow}{if}\ precision\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00091\ \ \ \ \ \textcolor{keywordflow}{if}\ recall\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00092\ \ \ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}If\ precision\ is\ None,\ recall\ must\ also\ be\ None"{}})}
\DoxyCodeLine{00093\ \ \ \ \ \textcolor{keywordflow}{return}\ np.NAN}
\DoxyCodeLine{00094\ }
\DoxyCodeLine{00095\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(precision,\ np.ndarray)\ \textcolor{keywordflow}{or}\ \textcolor{keywordflow}{not}\ isinstance(}
\DoxyCodeLine{00096\ \ \ \ \ \ \ recall,\ np.ndarray):}
\DoxyCodeLine{00097\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}precision\ and\ recall\ must\ be\ numpy\ array"{}})}
\DoxyCodeLine{00098\ \ \ \textcolor{keywordflow}{if}\ precision.dtype\ !=\ np.float\ \textcolor{keywordflow}{or}\ recall.dtype\ !=\ np.float:}
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}input\ must\ be\ float\ numpy\ array."{}})}
\DoxyCodeLine{00100\ \ \ \textcolor{keywordflow}{if}\ len(precision)\ !=\ len(recall):}
\DoxyCodeLine{00101\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}precision\ and\ recall\ must\ be\ of\ the\ same\ size."{}})}
\DoxyCodeLine{00102\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ precision.size:}
\DoxyCodeLine{00103\ \ \ \ \ \textcolor{keywordflow}{return}\ 0.0}
\DoxyCodeLine{00104\ \ \ \textcolor{keywordflow}{if}\ np.amin(precision)\ <\ 0\ \textcolor{keywordflow}{or}\ np.amax(precision)\ >\ 1:}
\DoxyCodeLine{00105\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}Precision\ must\ be\ in\ the\ range\ of\ [0,\ 1]."{}})}
\DoxyCodeLine{00106\ \ \ \textcolor{keywordflow}{if}\ np.amin(recall)\ <\ 0\ \textcolor{keywordflow}{or}\ np.amax(recall)\ >\ 1:}
\DoxyCodeLine{00107\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}recall\ must\ be\ in\ the\ range\ of\ [0,\ 1]."{}})}
\DoxyCodeLine{00108\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ all(recall[i]\ <=\ recall[i\ +\ 1]\ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(recall)\ -\/\ 1)):}
\DoxyCodeLine{00109\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}recall\ must\ be\ a\ non-\/decreasing\ array"{}})}
\DoxyCodeLine{00110\ }
\DoxyCodeLine{00111\ \ \ recall\ =\ np.concatenate([[0],\ recall,\ [1]])}
\DoxyCodeLine{00112\ \ \ precision\ =\ np.concatenate([[0],\ precision,\ [0]])}
\DoxyCodeLine{00113\ }
\DoxyCodeLine{00114\ \ \ \textcolor{comment}{\#\ Preprocess\ precision\ to\ be\ a\ non-\/decreasing\ array}}
\DoxyCodeLine{00115\ \ \ \textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(precision)\ -\/\ 2,\ -\/1,\ -\/1):}
\DoxyCodeLine{00116\ \ \ \ \ precision[i]\ =\ np.maximum(precision[i],\ precision[i\ +\ 1])}
\DoxyCodeLine{00117\ }
\DoxyCodeLine{00118\ \ \ indices\ =\ np.where(recall[1:]\ !=\ recall[:-\/1])[0]\ +\ 1}
\DoxyCodeLine{00119\ \ \ average\_precision\ =\ np.sum(}
\DoxyCodeLine{00120\ \ \ \ \ \ \ (recall[indices]\ -\/\ recall[indices\ -\/\ 1])\ *\ precision[indices])}
\DoxyCodeLine{00121\ \ \ \textcolor{keywordflow}{return}\ average\_precision}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00123\ }

\end{DoxyCode}
\Hypertarget{namespacedetection__utils_1_1utils_1_1metrics_a7c2abf31157d3c5d95e47a1b8f2d3af3}\label{namespacedetection__utils_1_1utils_1_1metrics_a7c2abf31157d3c5d95e47a1b8f2d3af3} 
\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}!compute\_cor\_loc@{compute\_cor\_loc}}
\index{compute\_cor\_loc@{compute\_cor\_loc}!detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection{\texorpdfstring{compute\_cor\_loc()}{compute\_cor\_loc()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+metrics.\+compute\+\_\+cor\+\_\+loc (\begin{DoxyParamCaption}\item[{}]{num\+\_\+gt\+\_\+imgs\+\_\+per\+\_\+class,  }\item[{}]{num\+\_\+images\+\_\+correctly\+\_\+detected\+\_\+per\+\_\+class }\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute CorLoc according to the definition in the following paper.

https://www.robots.ox.ac.uk/~vgg/rg/papers/deselaers-eccv10.pdf

Returns nans if there are no ground truth images for a class.

Args:
  num_gt_imgs_per_class: 1D array, representing number of images containing
      at least one object instance of a particular class
  num_images_correctly_detected_per_class: 1D array, representing number of
      images that are correctly detected at least one object instance of a
      particular class

Returns:
  corloc_per_class: A float numpy array represents the corloc score of each
    class
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{metrics_8py_source_l00124}{124}} of file \mbox{\hyperlink{metrics_8py_source}{metrics.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00125\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_images\_correctly\_detected\_per\_class):}
\DoxyCodeLine{00126\ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ CorLoc\ according\ to\ the\ definition\ in\ the\ following\ paper.}}
\DoxyCodeLine{00127\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00128\ \textcolor{stringliteral}{\ \ https://www.robots.ox.ac.uk/\string~vgg/rg/papers/deselaers-\/eccv10.pdf}}
\DoxyCodeLine{00129\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00130\ \textcolor{stringliteral}{\ \ Returns\ nans\ }\textcolor{keywordflow}{if}\ there\ are\ no\ ground\ truth\ images\ \textcolor{keywordflow}{for}\ a\ \textcolor{keyword}{class}.}
\DoxyCodeLine{00131\ }
\DoxyCodeLine{00132\ \ \ Args:}
\DoxyCodeLine{00133\ \ \ \ \ num\_gt\_imgs\_per\_class:\ 1D\ array,\ representing\ number\ of\ images\ containing}
\DoxyCodeLine{00134\ \ \ \ \ \ \ \ \ at\ least\ one\ object\ instance\ of\ a\ particular\ \textcolor{keyword}{class}}
\DoxyCodeLine{00135\ \ \ \ \ num\_images\_correctly\_detected\_per\_class:\ 1D\ array,\ representing\ number\ of}
\DoxyCodeLine{00136\ \ \ \ \ \ \ \ \ images\ that\ are\ correctly\ detected\ at\ least\ one\ object\ instance\ of\ a}
\DoxyCodeLine{00137\ \ \ \ \ \ \ \ \ particular\ \textcolor{keyword}{class}}
\DoxyCodeLine{00138\ }
\DoxyCodeLine{00139\ \ \ Returns:}
\DoxyCodeLine{00140\ \ \ \ \ corloc\_per\_class:\ A\ float\ numpy\ array\ represents\ the\ corloc\ score\ of\ each}
\DoxyCodeLine{00141\ \ \ \ \ \ \ \textcolor{keyword}{class}}
\DoxyCodeLine{00142\ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00143\ \textcolor{stringliteral}{\ \ }\textcolor{keywordflow}{return}\ np.where(}
\DoxyCodeLine{00144\ \ \ \ \ \ \ num\_gt\_imgs\_per\_class\ ==\ 0,\ np.nan,}
\DoxyCodeLine{00145\ \ \ \ \ \ \ num\_images\_correctly\_detected\_per\_class\ /\ num\_gt\_imgs\_per\_class)}
\DoxyCodeLine{00146\ }
\DoxyCodeLine{00147\ }

\end{DoxyCode}
\Hypertarget{namespacedetection__utils_1_1utils_1_1metrics_aea6346c967800d2ec215d698fbf39082}\label{namespacedetection__utils_1_1utils_1_1metrics_aea6346c967800d2ec215d698fbf39082} 
\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}!compute\_median\_rank\_at\_k@{compute\_median\_rank\_at\_k}}
\index{compute\_median\_rank\_at\_k@{compute\_median\_rank\_at\_k}!detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection{\texorpdfstring{compute\_median\_rank\_at\_k()}{compute\_median\_rank\_at\_k()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+metrics.\+compute\+\_\+median\+\_\+rank\+\_\+at\+\_\+k (\begin{DoxyParamCaption}\item[{}]{tp\+\_\+fp\+\_\+list,  }\item[{}]{k }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes MedianRank@k, where k is the top-scoring labels.

Args:
  tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all
      detection on a single image, where the detections are sorted by score in
      descending order. Further, each numpy array element can have boolean or
      float values. True positive elements have either value >0.0 or True;
      any other value is considered false positive.
  k: number of top-scoring proposals to take.

Returns:
  median_rank: median rank of all true positive proposals among top k by
    score.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{metrics_8py_source_l00148}{148}} of file \mbox{\hyperlink{metrics_8py_source}{metrics.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00148\ \textcolor{keyword}{def\ }compute\_median\_rank\_at\_k(tp\_fp\_list,\ k):}
\DoxyCodeLine{00149\ \ \ \textcolor{stringliteral}{"{}"{}"{}Computes\ MedianRank@k,\ where\ k\ is\ the\ top-\/scoring\ labels.}}
\DoxyCodeLine{00150\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00151\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00152\ \textcolor{stringliteral}{\ \ \ \ tp\_fp\_list:\ a\ list\ of\ numpy\ arrays;\ each\ numpy\ array\ corresponds\ to\ the\ all}}
\DoxyCodeLine{00153\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ detection\ on\ a\ single\ image,\ where\ the\ detections\ are\ sorted\ by\ score\ }\textcolor{keywordflow}{in}}
\DoxyCodeLine{00154\ \ \ \ \ \ \ \ \ descending\ order.\ Further,\ each\ numpy\ array\ element\ can\ have\ boolean\ \textcolor{keywordflow}{or}}
\DoxyCodeLine{00155\ \ \ \ \ \ \ \ \ float\ values.\ \textcolor{keyword}{True}\ positive\ elements\ have\ either\ value\ >0.0\ \textcolor{keywordflow}{or}\ \textcolor{keyword}{True};}
\DoxyCodeLine{00156\ \ \ \ \ \ \ \ \ any\ other\ value\ \textcolor{keywordflow}{is}\ considered\ false\ positive.}
\DoxyCodeLine{00157\ \ \ \ \ k:\ number\ of\ top-\/scoring\ proposals\ to\ take.}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ Returns:}
\DoxyCodeLine{00160\ \ \ \ \ median\_rank:\ median\ rank\ of\ all\ true\ positive\ proposals\ among\ top\ k\ by}
\DoxyCodeLine{00161\ \ \ \ \ \ \ score.}
\DoxyCodeLine{00162\ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00163\ \textcolor{stringliteral}{\ \ ranks\ =\ []}}
\DoxyCodeLine{00164\ \textcolor{stringliteral}{\ \ }\textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(tp\_fp\_list)):}
\DoxyCodeLine{00165\ \ \ \ \ ranks.append(}
\DoxyCodeLine{00166\ \ \ \ \ \ \ \ \ np.where(tp\_fp\_list[i][0:min(k,\ tp\_fp\_list[i].shape[0])]\ >\ 0)[0])}
\DoxyCodeLine{00167\ \ \ concatenated\_ranks\ =\ np.concatenate(ranks)}
\DoxyCodeLine{00168\ \ \ \textcolor{keywordflow}{return}\ np.median(concatenated\_ranks)}
\DoxyCodeLine{00169\ }
\DoxyCodeLine{00170\ }

\end{DoxyCode}
\Hypertarget{namespacedetection__utils_1_1utils_1_1metrics_aa5958d51e1d62d49fa7cf782d046b674}\label{namespacedetection__utils_1_1utils_1_1metrics_aa5958d51e1d62d49fa7cf782d046b674} 
\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}!compute\_precision\_recall@{compute\_precision\_recall}}
\index{compute\_precision\_recall@{compute\_precision\_recall}!detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection{\texorpdfstring{compute\_precision\_recall()}{compute\_precision\_recall()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+metrics.\+compute\+\_\+precision\+\_\+recall (\begin{DoxyParamCaption}\item[{}]{scores,  }\item[{}]{labels,  }\item[{}]{num\+\_\+gt }\end{DoxyParamCaption})}

\begin{DoxyVerb}Compute precision and recall.

Args:
  scores: A float numpy array representing detection score
  labels: A float numpy array representing weighted true/false positive labels
  num_gt: Number of ground truth instances

Raises:
  ValueError: if the input is not of the correct format

Returns:
  precision: Fraction of positive instances over detected ones. This value is
    None if no ground truth labels are present.
  recall: Fraction of detected positive instance over all positive instances.
    This value is None if no ground truth labels are present.\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{metrics_8py_source_l00024}{24}} of file \mbox{\hyperlink{metrics_8py_source}{metrics.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00024\ \textcolor{keyword}{def\ }compute\_precision\_recall(scores,\ labels,\ num\_gt):}
\DoxyCodeLine{00025\ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ precision\ and\ recall.}}
\DoxyCodeLine{00026\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00027\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00028\ \textcolor{stringliteral}{\ \ \ \ scores:\ A\ float\ numpy\ array\ representing\ detection\ score}}
\DoxyCodeLine{00029\ \textcolor{stringliteral}{\ \ \ \ labels:\ A\ float\ numpy\ array\ representing\ weighted\ true/false\ positive\ labels}}
\DoxyCodeLine{00030\ \textcolor{stringliteral}{\ \ \ \ num\_gt:\ Number\ of\ ground\ truth\ instances}}
\DoxyCodeLine{00031\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00032\ \textcolor{stringliteral}{\ \ Raises:}}
\DoxyCodeLine{00033\ \textcolor{stringliteral}{\ \ \ \ ValueError:\ }\textcolor{keywordflow}{if}\ the\ input\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ of\ the\ correct\ format}
\DoxyCodeLine{00034\ }
\DoxyCodeLine{00035\ \ \ Returns:}
\DoxyCodeLine{00036\ \ \ \ \ precision:\ Fraction\ of\ positive\ instances\ over\ detected\ ones.\ This\ value\ \textcolor{keywordflow}{is}}
\DoxyCodeLine{00037\ \ \ \ \ \ \ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{if}\ no\ ground\ truth\ labels\ are\ present.}
\DoxyCodeLine{00038\ \ \ \ \ recall:\ Fraction\ of\ detected\ positive\ instance\ over\ all\ positive\ instances.}
\DoxyCodeLine{00039\ \ \ \ \ \ \ This\ value\ \textcolor{keywordflow}{is}\ \textcolor{keywordtype}{None}\ \textcolor{keywordflow}{if}\ no\ ground\ truth\ labels\ are\ present.}
\DoxyCodeLine{00040\ }
\DoxyCodeLine{00041\ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00042\ \textcolor{stringliteral}{\ \ }\textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(labels,\ np.ndarray)\ \textcolor{keywordflow}{or}\ len(labels.shape)\ !=\ 1:}
\DoxyCodeLine{00043\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}labels\ must\ be\ single\ dimension\ numpy\ array"{}})}
\DoxyCodeLine{00044\ }
\DoxyCodeLine{00045\ \ \ \textcolor{keywordflow}{if}\ labels.dtype\ !=\ np.float\ \textcolor{keywordflow}{and}\ labels.dtype\ !=\ np.bool:}
\DoxyCodeLine{00046\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}labels\ type\ must\ be\ either\ bool\ or\ float"{}})}
\DoxyCodeLine{00047\ }
\DoxyCodeLine{00048\ \ \ \textcolor{keywordflow}{if}\ \textcolor{keywordflow}{not}\ isinstance(scores,\ np.ndarray)\ \textcolor{keywordflow}{or}\ len(scores.shape)\ !=\ 1:}
\DoxyCodeLine{00049\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}scores\ must\ be\ single\ dimension\ numpy\ array"{}})}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00051\ \ \ \textcolor{keywordflow}{if}\ num\_gt\ <\ np.sum(labels):}
\DoxyCodeLine{00052\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}Number\ of\ true\ positives\ must\ be\ smaller\ than\ num\_gt."{}})}
\DoxyCodeLine{00053\ }
\DoxyCodeLine{00054\ \ \ \textcolor{keywordflow}{if}\ len(scores)\ !=\ len(labels):}
\DoxyCodeLine{00055\ \ \ \ \ \textcolor{keywordflow}{raise}\ ValueError(\textcolor{stringliteral}{"{}scores\ and\ labels\ must\ be\ of\ the\ same\ size."{}})}
\DoxyCodeLine{00056\ }
\DoxyCodeLine{00057\ \ \ \textcolor{keywordflow}{if}\ num\_gt\ ==\ 0:}
\DoxyCodeLine{00058\ \ \ \ \ \textcolor{keywordflow}{return}\ \textcolor{keywordtype}{None},\ \textcolor{keywordtype}{None}}
\DoxyCodeLine{00059\ }
\DoxyCodeLine{00060\ \ \ sorted\_indices\ =\ np.argsort(scores)}
\DoxyCodeLine{00061\ \ \ sorted\_indices\ =\ sorted\_indices[::-\/1]}
\DoxyCodeLine{00062\ \ \ true\_positive\_labels\ =\ labels[sorted\_indices]}
\DoxyCodeLine{00063\ \ \ false\_positive\_labels\ =\ (true\_positive\_labels\ <=\ 0).astype(float)}
\DoxyCodeLine{00064\ \ \ cum\_true\_positives\ =\ np.cumsum(true\_positive\_labels)}
\DoxyCodeLine{00065\ \ \ cum\_false\_positives\ =\ np.cumsum(false\_positive\_labels)}
\DoxyCodeLine{00066\ \ \ precision\ =\ cum\_true\_positives.astype(float)\ /\ (}
\DoxyCodeLine{00067\ \ \ \ \ \ \ cum\_true\_positives\ +\ cum\_false\_positives)}
\DoxyCodeLine{00068\ \ \ recall\ =\ cum\_true\_positives.astype(float)\ /\ num\_gt}
\DoxyCodeLine{00069\ \ \ \textcolor{keywordflow}{return}\ precision,\ recall}
\DoxyCodeLine{00070\ }
\DoxyCodeLine{00071\ }

\end{DoxyCode}
\Hypertarget{namespacedetection__utils_1_1utils_1_1metrics_a27dea25701e731a64eb95c6244ca5bc0}\label{namespacedetection__utils_1_1utils_1_1metrics_a27dea25701e731a64eb95c6244ca5bc0} 
\index{detection\_utils.utils.metrics@{detection\_utils.utils.metrics}!compute\_recall\_at\_k@{compute\_recall\_at\_k}}
\index{compute\_recall\_at\_k@{compute\_recall\_at\_k}!detection\_utils.utils.metrics@{detection\_utils.utils.metrics}}
\doxysubsubsection{\texorpdfstring{compute\_recall\_at\_k()}{compute\_recall\_at\_k()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+metrics.\+compute\+\_\+recall\+\_\+at\+\_\+k (\begin{DoxyParamCaption}\item[{}]{tp\+\_\+fp\+\_\+list,  }\item[{}]{num\+\_\+gt,  }\item[{}]{k }\end{DoxyParamCaption})}

\begin{DoxyVerb}Computes Recall@k, MedianRank@k, where k is the top-scoring labels.

Args:
  tp_fp_list: a list of numpy arrays; each numpy array corresponds to the all
      detection on a single image, where the detections are sorted by score in
      descending order. Further, each numpy array element can have boolean or
      float values. True positive elements have either value >0.0 or True;
      any other value is considered false positive.
  num_gt: number of groundtruth anotations.
  k: number of top-scoring proposals to take.

Returns:
  recall: recall evaluated on the top k by score detections.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{metrics_8py_source_l00171}{171}} of file \mbox{\hyperlink{metrics_8py_source}{metrics.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00171\ \textcolor{keyword}{def\ }compute\_recall\_at\_k(tp\_fp\_list,\ num\_gt,\ k):}
\DoxyCodeLine{00172\ \ \ \textcolor{stringliteral}{"{}"{}"{}Computes\ Recall@k,\ MedianRank@k,\ where\ k\ is\ the\ top-\/scoring\ labels.}}
\DoxyCodeLine{00173\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00174\ \textcolor{stringliteral}{\ \ Args:}}
\DoxyCodeLine{00175\ \textcolor{stringliteral}{\ \ \ \ tp\_fp\_list:\ a\ list\ of\ numpy\ arrays;\ each\ numpy\ array\ corresponds\ to\ the\ all}}
\DoxyCodeLine{00176\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ detection\ on\ a\ single\ image,\ where\ the\ detections\ are\ sorted\ by\ score\ }\textcolor{keywordflow}{in}}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ descending\ order.\ Further,\ each\ numpy\ array\ element\ can\ have\ boolean\ \textcolor{keywordflow}{or}}
\DoxyCodeLine{00178\ \ \ \ \ \ \ \ \ float\ values.\ \textcolor{keyword}{True}\ positive\ elements\ have\ either\ value\ >0.0\ \textcolor{keywordflow}{or}\ \textcolor{keyword}{True};}
\DoxyCodeLine{00179\ \ \ \ \ \ \ \ \ any\ other\ value\ \textcolor{keywordflow}{is}\ considered\ false\ positive.}
\DoxyCodeLine{00180\ \ \ \ \ num\_gt:\ number\ of\ groundtruth\ anotations.}
\DoxyCodeLine{00181\ \ \ \ \ k:\ number\ of\ top-\/scoring\ proposals\ to\ take.}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ Returns:}
\DoxyCodeLine{00184\ \ \ \ \ recall:\ recall\ evaluated\ on\ the\ top\ k\ by\ score\ detections.}
\DoxyCodeLine{00185\ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00186\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00187\ \textcolor{stringliteral}{\ \ tp\_fp\_eval\ =\ []}}
\DoxyCodeLine{00188\ \textcolor{stringliteral}{\ \ }\textcolor{keywordflow}{for}\ i\ \textcolor{keywordflow}{in}\ range(len(tp\_fp\_list)):}
\DoxyCodeLine{00189\ \ \ \ \ tp\_fp\_eval.append(tp\_fp\_list[i][0:min(k,\ tp\_fp\_list[i].shape[0])])}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ tp\_fp\_eval\ =\ np.concatenate(tp\_fp\_eval)}
\DoxyCodeLine{00192\ }
\DoxyCodeLine{00193\ \ \ \textcolor{keywordflow}{return}\ np.sum(tp\_fp\_eval)\ /\ num\_gt}

\end{DoxyCode}
