\doxysection{detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test Class Reference}
\hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test}{}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test}\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}


Inheritance diagram for detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{da/d34/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[height=550pt]{d7/d87/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a90d6ae486f353e011c623636631e8f28}{test\+\_\+perfectly\+\_\+aligned\+\_\+cell\+\_\+center\+\_\+and\+\_\+feature\+\_\+pixels}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_ad59249f7b2a775719e31b2c4d212c595}{test\+\_\+interpolation\+\_\+with\+\_\+4\+\_\+points\+\_\+per\+\_\+bin}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a5083314812c3e16bae61dc6c414bc777}{test\+\_\+1x1\+\_\+crop\+\_\+on\+\_\+2x2\+\_\+features}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a04818fdf741d1078701a87974eac95d5}{test\+\_\+3x3\+\_\+crops\+\_\+on\+\_\+2x2\+\_\+features}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_afe60f83e84406885744eeb3f223fd3a5}{test\+\_\+2x2\+\_\+crops\+\_\+on\+\_\+3x3\+\_\+features}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_aaee5dba72de13fcd4cd4e40840249d5c}{test\+\_\+2x2\+\_\+crop\+\_\+on\+\_\+4x4\+\_\+features}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a1019e597c1e424323e09d35c5a4c0000}{test\+\_\+extrapolate\+\_\+3x3\+\_\+crop\+\_\+on\+\_\+2x2\+\_\+features}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a796171dd864f3d7037ec1fd88beb484e}{test\+\_\+extrapolate\+\_\+with\+\_\+non\+\_\+zero\+\_\+value}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_addc76f7ec56d59581a60c7ffe86ed1e7}{test\+\_\+multilevel\+\_\+roi\+\_\+align}} (self)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a581e8ef6a005750f72e7906193a6d55b}{test\+\_\+large\+\_\+input}} (self)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classdetection__utils_1_1utils_1_1test__case_1_1_test_case}{detection\+\_\+utils.\+utils.\+test\+\_\+case.\+Test\+Case}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1test__case_1_1_test_case_a9c2a9604a235b1e61445e36ad3227e05}{execute\+\_\+tpu}} (self, graph\+\_\+fn, inputs)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1test__case_1_1_test_case_a045a0f66c0daf695c7f0326933d7cd36}{execute\+\_\+cpu}} (self, graph\+\_\+fn, inputs)
\item 
\mbox{\hyperlink{classdetection__utils_1_1utils_1_1test__case_1_1_test_case_aa63733ab104c7557d917a98bef6ac8d9}{execute}} (self, graph\+\_\+fn, inputs)
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}


Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00162}{162}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.



\doxysubsection{Member Function Documentation}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a5083314812c3e16bae61dc6c414bc777}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a5083314812c3e16bae61dc6c414bc777} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_1x1\_crop\_on\_2x2\_features@{test\_1x1\_crop\_on\_2x2\_features}}
\index{test\_1x1\_crop\_on\_2x2\_features@{test\_1x1\_crop\_on\_2x2\_features}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_1x1\_crop\_on\_2x2\_features()}{test\_1x1\_crop\_on\_2x2\_features()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+1x1\+\_\+crop\+\_\+on\+\_\+2x2\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00203}{203}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00203\ \ \ \textcolor{keyword}{def\ }test\_1x1\_crop\_on\_2x2\_features(self):}
\DoxyCodeLine{00204\ }
\DoxyCodeLine{00205\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00206\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00207\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00208\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00209\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[1,\ 1])}
\DoxyCodeLine{00210\ }
\DoxyCodeLine{00211\ \ \ \ \ image\ =\ np.array([[[[1],\ [2]],}
\DoxyCodeLine{00212\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[3],\ [4]]]],\ dtype=np.float32)}
\DoxyCodeLine{00213\ \ \ \ \ boxes\ =\ np.array([[[0,\ 0,\ 1,\ 1]]],\ dtype=np.float32)}
\DoxyCodeLine{00214\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00215\ \ \ \ \ expected\_output\ =\ [[[[[2.5]]]]]}
\DoxyCodeLine{00216\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00217\ \ \ \ \ self.assertAllClose(crop\_output,\ expected\_output)}
\DoxyCodeLine{00218\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a5083314812c3e16bae61dc6c414bc777_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_aaee5dba72de13fcd4cd4e40840249d5c}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_aaee5dba72de13fcd4cd4e40840249d5c} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_2x2\_crop\_on\_4x4\_features@{test\_2x2\_crop\_on\_4x4\_features}}
\index{test\_2x2\_crop\_on\_4x4\_features@{test\_2x2\_crop\_on\_4x4\_features}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_2x2\_crop\_on\_4x4\_features()}{test\_2x2\_crop\_on\_4x4\_features()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+2x2\+\_\+crop\+\_\+on\+\_\+4x4\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00260}{260}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00260\ \ \ \textcolor{keyword}{def\ }test\_2x2\_crop\_on\_4x4\_features(self):}
\DoxyCodeLine{00261\ }
\DoxyCodeLine{00262\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00263\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00264\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00265\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00266\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[2,\ 2])}
\DoxyCodeLine{00267\ }
\DoxyCodeLine{00268\ \ \ \ \ image\ =\ np.array([[[[0],\ [1],\ [2],\ [3]],}
\DoxyCodeLine{00269\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[4],\ [5],\ [6],\ [7]],}
\DoxyCodeLine{00270\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[8],\ [9],\ [10],\ [11]],}
\DoxyCodeLine{00271\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[12],\ [13],\ [14],\ [15]]]],}
\DoxyCodeLine{00272\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32)}
\DoxyCodeLine{00273\ \ \ \ \ boxes\ =\ np.array([[[0,\ 0,\ 2./3,\ 2./3],}
\DoxyCodeLine{00274\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 2./3,\ 1.0]]],}
\DoxyCodeLine{00275\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32)}
\DoxyCodeLine{00276\ \ \ \ \ box\_levels\ =\ np.array([[0,\ 0]],\ dtype=np.int32)}
\DoxyCodeLine{00277\ }
\DoxyCodeLine{00278\ \ \ \ \ expected\_output\ =\ np.array([[[[[2.5],\ [3.5]],}
\DoxyCodeLine{00279\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[6.5],\ [7.5]]],}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[[2.75],\ [4.25]],}
\DoxyCodeLine{00281\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[6.75],\ [8.25]]]]])}
\DoxyCodeLine{00282\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00283\ \ \ \ \ self.assertAllClose(expected\_output,\ crop\_output)}
\DoxyCodeLine{00284\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_aaee5dba72de13fcd4cd4e40840249d5c_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_afe60f83e84406885744eeb3f223fd3a5}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_afe60f83e84406885744eeb3f223fd3a5} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_2x2\_crops\_on\_3x3\_features@{test\_2x2\_crops\_on\_3x3\_features}}
\index{test\_2x2\_crops\_on\_3x3\_features@{test\_2x2\_crops\_on\_3x3\_features}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_2x2\_crops\_on\_3x3\_features()}{test\_2x2\_crops\_on\_3x3\_features()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+2x2\+\_\+crops\+\_\+on\+\_\+3x3\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00237}{237}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00237\ \ \ \textcolor{keyword}{def\ }test\_2x2\_crops\_on\_3x3\_features(self):}
\DoxyCodeLine{00238\ }
\DoxyCodeLine{00239\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00240\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00241\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00242\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00243\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[2,\ 2])}
\DoxyCodeLine{00244\ }
\DoxyCodeLine{00245\ \ \ \ \ image\ =\ np.array([[[[1],\ [2],\ [3]],}
\DoxyCodeLine{00246\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[4],\ [5],\ [6]],}
\DoxyCodeLine{00247\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[7],\ [8],\ [9]]]],}
\DoxyCodeLine{00248\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32)}
\DoxyCodeLine{00249\ \ \ \ \ boxes\ =\ np.array([[[0,\ 0,\ 1,\ 1],}
\DoxyCodeLine{00250\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ .5,\ .5]]],}
\DoxyCodeLine{00251\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32)}
\DoxyCodeLine{00252\ \ \ \ \ box\_levels\ =\ np.array([[0,\ 0]],\ dtype=np.int32)}
\DoxyCodeLine{00253\ \ \ \ \ expected\_output\ =\ [[[[[3],\ [4]],}
\DoxyCodeLine{00254\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[6],\ [7]]],}
\DoxyCodeLine{00255\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[[2.],\ [2.5]],}
\DoxyCodeLine{00256\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[3.5],\ [4.]]]]]}
\DoxyCodeLine{00257\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00258\ \ \ \ \ self.assertAllClose(crop\_output,\ expected\_output)}
\DoxyCodeLine{00259\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_afe60f83e84406885744eeb3f223fd3a5_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a04818fdf741d1078701a87974eac95d5}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a04818fdf741d1078701a87974eac95d5} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_3x3\_crops\_on\_2x2\_features@{test\_3x3\_crops\_on\_2x2\_features}}
\index{test\_3x3\_crops\_on\_2x2\_features@{test\_3x3\_crops\_on\_2x2\_features}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_3x3\_crops\_on\_2x2\_features()}{test\_3x3\_crops\_on\_2x2\_features()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+3x3\+\_\+crops\+\_\+on\+\_\+2x2\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00219}{219}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00219\ \ \ \textcolor{keyword}{def\ }test\_3x3\_crops\_on\_2x2\_features(self):}
\DoxyCodeLine{00220\ }
\DoxyCodeLine{00221\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00222\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00223\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00224\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00225\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[3,\ 3])}
\DoxyCodeLine{00226\ }
\DoxyCodeLine{00227\ \ \ \ \ image\ =\ np.array([[[[1],\ [2]],}
\DoxyCodeLine{00228\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[3],\ [4]]]],\ dtype=np.float32)}
\DoxyCodeLine{00229\ \ \ \ \ boxes\ =\ np.array([[[0,\ 0,\ 1,\ 1]]],\ dtype=np.float32)}
\DoxyCodeLine{00230\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00231\ \ \ \ \ expected\_output\ =\ [[[[[9./6],\ [11./6],\ [13./6]],}
\DoxyCodeLine{00232\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[13./6],\ [15./6],\ [17./6]],}
\DoxyCodeLine{00233\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[17./6],\ [19./6],\ [21./6]]]]]}
\DoxyCodeLine{00234\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00235\ \ \ \ \ self.assertAllClose(crop\_output,\ expected\_output)}
\DoxyCodeLine{00236\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a04818fdf741d1078701a87974eac95d5_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a1019e597c1e424323e09d35c5a4c0000}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a1019e597c1e424323e09d35c5a4c0000} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_extrapolate\_3x3\_crop\_on\_2x2\_features@{test\_extrapolate\_3x3\_crop\_on\_2x2\_features}}
\index{test\_extrapolate\_3x3\_crop\_on\_2x2\_features@{test\_extrapolate\_3x3\_crop\_on\_2x2\_features}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_extrapolate\_3x3\_crop\_on\_2x2\_features()}{test\_extrapolate\_3x3\_crop\_on\_2x2\_features()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+extrapolate\+\_\+3x3\+\_\+crop\+\_\+on\+\_\+2x2\+\_\+features (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00285}{285}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00285\ \ \ \textcolor{keyword}{def\ }test\_extrapolate\_3x3\_crop\_on\_2x2\_features(self):}
\DoxyCodeLine{00286\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00287\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00288\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00290\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[3,\ 3])}
\DoxyCodeLine{00291\ \ \ \ \ image\ =\ np.array([[[[1],\ [2]],}
\DoxyCodeLine{00292\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[3],\ [4]]]],\ dtype=np.float32)}
\DoxyCodeLine{00293\ \ \ \ \ boxes\ =\ np.array([[[-\/1,\ -\/1,\ 2,\ 2]]],\ dtype=np.float32)}
\DoxyCodeLine{00294\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00295\ }
\DoxyCodeLine{00296\ \ \ \ \ expected\_output\ =\ np.array([[[[[0.25],\ [0.75],\ [0.5]],}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[1.0],\ [2.5],\ [1.5]],}
\DoxyCodeLine{00298\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[0.75],\ [1.75],\ [1]]]]])}
\DoxyCodeLine{00299\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00300\ \ \ \ \ self.assertAllClose(expected\_output,\ crop\_output)}
\DoxyCodeLine{00301\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a1019e597c1e424323e09d35c5a4c0000_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a796171dd864f3d7037ec1fd88beb484e}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a796171dd864f3d7037ec1fd88beb484e} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_extrapolate\_with\_non\_zero\_value@{test\_extrapolate\_with\_non\_zero\_value}}
\index{test\_extrapolate\_with\_non\_zero\_value@{test\_extrapolate\_with\_non\_zero\_value}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_extrapolate\_with\_non\_zero\_value()}{test\_extrapolate\_with\_non\_zero\_value()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+extrapolate\+\_\+with\+\_\+non\+\_\+zero\+\_\+value (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00302}{302}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00302\ \ \ \textcolor{keyword}{def\ }test\_extrapolate\_with\_non\_zero\_value(self):}
\DoxyCodeLine{00303\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00304\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00305\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00306\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[3,\ 3],}
\DoxyCodeLine{00308\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ extrapolation\_value=2.0)}
\DoxyCodeLine{00309\ \ \ \ \ image\ =\ np.array([[[[4],\ [4]],}
\DoxyCodeLine{00310\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[4],\ [4]]]],\ dtype=np.float32)}
\DoxyCodeLine{00311\ \ \ \ \ boxes\ =\ np.array([[[-\/1,\ -\/1,\ 2,\ 2]]],\ dtype=np.float32)}
\DoxyCodeLine{00312\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00313\ }
\DoxyCodeLine{00314\ \ \ \ \ expected\_output\ =\ np.array([[[[[2.5],\ [3.0],\ [2.5]],}
\DoxyCodeLine{00315\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[3.0],\ [4.0],\ [3.0]],}
\DoxyCodeLine{00316\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[2.5],\ [3.0],\ [2.5]]]]])}
\DoxyCodeLine{00317\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00318\ \ \ \ \ self.assertAllClose(expected\_output,\ crop\_output)}
\DoxyCodeLine{00319\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a796171dd864f3d7037ec1fd88beb484e_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_ad59249f7b2a775719e31b2c4d212c595}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_ad59249f7b2a775719e31b2c4d212c595} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_interpolation\_with\_4\_points\_per\_bin@{test\_interpolation\_with\_4\_points\_per\_bin}}
\index{test\_interpolation\_with\_4\_points\_per\_bin@{test\_interpolation\_with\_4\_points\_per\_bin}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_interpolation\_with\_4\_points\_per\_bin()}{test\_interpolation\_with\_4\_points\_per\_bin()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+interpolation\+\_\+with\+\_\+4\+\_\+points\+\_\+per\+\_\+bin (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00181}{181}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00181\ \ \ \textcolor{keyword}{def\ }test\_interpolation\_with\_4\_points\_per\_bin(self):}
\DoxyCodeLine{00182\ }
\DoxyCodeLine{00183\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00184\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00185\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00186\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00187\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[1,\ 1],}
\DoxyCodeLine{00188\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_samples\_per\_cell\_y=2,}
\DoxyCodeLine{00189\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_samples\_per\_cell\_x=2)}
\DoxyCodeLine{00190\ }
\DoxyCodeLine{00191\ \ \ \ \ image\ =\ np.array([[[[1],\ [2],\ [3],\ [4]],}
\DoxyCodeLine{00192\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[5],\ [6],\ [7],\ [8]],}
\DoxyCodeLine{00193\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[9],\ [10],\ [11],\ [12]],}
\DoxyCodeLine{00194\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[13],\ [14],\ [15],\ [16]]]],}
\DoxyCodeLine{00195\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32)}
\DoxyCodeLine{00196\ \ \ \ \ boxes\ =\ np.array([[[1./3,\ 1./3,\ 2./3,\ 2./3]]],\ dtype=np.float32)}
\DoxyCodeLine{00197\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00198\ }
\DoxyCodeLine{00199\ \ \ \ \ expected\_output\ =\ [[[[[(7.25\ +\ 7.75\ +\ 9.25\ +\ 9.75)\ /\ 4]]]]]}
\DoxyCodeLine{00200\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00201\ \ \ \ \ self.assertAllClose(expected\_output,\ crop\_output)}
\DoxyCodeLine{00202\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_ad59249f7b2a775719e31b2c4d212c595_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a581e8ef6a005750f72e7906193a6d55b}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a581e8ef6a005750f72e7906193a6d55b} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_large\_input@{test\_large\_input}}
\index{test\_large\_input@{test\_large\_input}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_large\_input()}{test\_large\_input()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+large\+\_\+input (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00362}{362}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00362\ \ \ \textcolor{keyword}{def\ }test\_large\_input(self):}
\DoxyCodeLine{00363\ \ \ \ \ \textcolor{keywordflow}{if}\ test\_case.FLAGS.tpu\_test:}
\DoxyCodeLine{00364\ \ \ \ \ \ \ input\_size\ =\ 1408}
\DoxyCodeLine{00365\ \ \ \ \ \ \ min\_level\ =\ 2}
\DoxyCodeLine{00366\ \ \ \ \ \ \ max\_level\ =\ 6}
\DoxyCodeLine{00367\ \ \ \ \ \ \ batch\_size\ =\ 2}
\DoxyCodeLine{00368\ \ \ \ \ \ \ num\_boxes\ =\ 512}
\DoxyCodeLine{00369\ \ \ \ \ \ \ num\_filters\ =\ 256}
\DoxyCodeLine{00370\ \ \ \ \ \ \ output\_size\ =\ [7,\ 7]}
\DoxyCodeLine{00371\ \ \ \ \ \ \ \textcolor{keyword}{with}\ self.test\_session()\ \textcolor{keyword}{as}\ sess:}
\DoxyCodeLine{00372\ \ \ \ \ \ \ \ \ features\ =\ []}
\DoxyCodeLine{00373\ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{for}\ level\ \textcolor{keywordflow}{in}\ range(min\_level,\ max\_level\ +\ 1):}
\DoxyCodeLine{00374\ \ \ \ \ \ \ \ \ \ \ feat\_size\ =\ int(input\_size\ /\ 2**level)}
\DoxyCodeLine{00375\ \ \ \ \ \ \ \ \ \ \ features.append(tf.constant(}
\DoxyCodeLine{00376\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.reshape(}
\DoxyCodeLine{00377\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ np.arange(}
\DoxyCodeLine{00378\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ batch\_size\ *\ feat\_size\ *\ feat\_size\ *\ num\_filters,}
\DoxyCodeLine{00379\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32),}
\DoxyCodeLine{00380\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [batch\_size,\ feat\_size,\ feat\_size,\ num\_filters]),}
\DoxyCodeLine{00381\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=tf.bfloat16))}
\DoxyCodeLine{00382\ \ \ \ \ \ \ \ \ boxes\ =\ np.array([}
\DoxyCodeLine{00383\ \ \ \ \ \ \ \ \ \ \ \ \ [[0,\ 0,\ 256,\ 256]]*num\_boxes,}
\DoxyCodeLine{00384\ \ \ \ \ \ \ \ \ ],\ dtype=np.float32)\ /\ input\_size}
\DoxyCodeLine{00385\ \ \ \ \ \ \ \ \ boxes\ =\ np.tile(boxes,\ [batch\_size,\ 1,\ 1])}
\DoxyCodeLine{00386\ \ \ \ \ \ \ \ \ tf\_boxes\ =\ tf.constant(boxes)}
\DoxyCodeLine{00387\ \ \ \ \ \ \ \ \ tf\_levels\ =\ tf.random\_uniform([batch\_size,\ num\_boxes],\ maxval=5,}
\DoxyCodeLine{00388\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=tf.int32)}
\DoxyCodeLine{00389\ \ \ \ \ \ \ \ \ \textcolor{keyword}{def\ }crop\_and\_resize\_fn():}
\DoxyCodeLine{00390\ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align(}
\DoxyCodeLine{00391\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ features,\ tf\_boxes,\ tf\_levels,\ output\_size)}
\DoxyCodeLine{00392\ }
\DoxyCodeLine{00393\ \ \ \ \ \ \ \ \ tpu\_crop\_and\_resize\_fn\ =\ tf.contrib.tpu.rewrite(crop\_and\_resize\_fn)}
\DoxyCodeLine{00394\ \ \ \ \ \ \ \ \ sess.run(tf.contrib.tpu.initialize\_system())}
\DoxyCodeLine{00395\ \ \ \ \ \ \ \ \ sess.run(tf.global\_variables\_initializer())}
\DoxyCodeLine{00396\ \ \ \ \ \ \ \ \ roi\_features\ =\ sess.run(tpu\_crop\_and\_resize\_fn)}
\DoxyCodeLine{00397\ \ \ \ \ \ \ \ \ self.assertEqual(roi\_features[0].shape,}
\DoxyCodeLine{00398\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (batch\_size,\ num\_boxes,\ output\_size[0],\ output\_size[1],}
\DoxyCodeLine{00399\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ num\_filters))}
\DoxyCodeLine{00400\ \ \ \ \ \ \ \ \ sess.run(tf.contrib.tpu.shutdown\_system())}
\DoxyCodeLine{00401\ }
\DoxyCodeLine{00402\ }

\end{DoxyCode}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_addc76f7ec56d59581a60c7ffe86ed1e7}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_addc76f7ec56d59581a60c7ffe86ed1e7} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_multilevel\_roi\_align@{test\_multilevel\_roi\_align}}
\index{test\_multilevel\_roi\_align@{test\_multilevel\_roi\_align}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_multilevel\_roi\_align()}{test\_multilevel\_roi\_align()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+multilevel\+\_\+roi\+\_\+align (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00320}{320}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00320\ \ \ \textcolor{keyword}{def\ }test\_multilevel\_roi\_align(self):}
\DoxyCodeLine{00321\ \ \ \ \ image\_size\ =\ 640}
\DoxyCodeLine{00322\ \ \ \ \ fpn\_min\_level\ =\ 2}
\DoxyCodeLine{00323\ \ \ \ \ fpn\_max\_level\ =\ 5}
\DoxyCodeLine{00324\ \ \ \ \ batch\_size\ =\ 1}
\DoxyCodeLine{00325\ \ \ \ \ output\_size\ =\ [2,\ 2]}
\DoxyCodeLine{00326\ \ \ \ \ num\_filters\ =\ 1}
\DoxyCodeLine{00327\ \ \ \ \ features\ =\ []}
\DoxyCodeLine{00328\ \ \ \ \ \textcolor{keywordflow}{for}\ level\ \textcolor{keywordflow}{in}\ range(fpn\_min\_level,\ fpn\_max\_level\ +\ 1):}
\DoxyCodeLine{00329\ \ \ \ \ \ \ feat\_size\ =\ int(image\_size\ /\ 2**level)}
\DoxyCodeLine{00330\ \ \ \ \ \ \ features.append(}
\DoxyCodeLine{00331\ \ \ \ \ \ \ \ \ \ \ float(level)\ *}
\DoxyCodeLine{00332\ \ \ \ \ \ \ \ \ \ \ np.ones([batch\_size,\ feat\_size,\ feat\_size,\ num\_filters],}
\DoxyCodeLine{00333\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ dtype=np.float32))}
\DoxyCodeLine{00334\ \ \ \ \ boxes\ =\ np.array(}
\DoxyCodeLine{00335\ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{00336\ \ \ \ \ \ \ \ \ \ \ \ \ [}
\DoxyCodeLine{00337\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 111,\ 111],\ \ \textcolor{comment}{\#\ Level\ 2.}}
\DoxyCodeLine{00338\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 113,\ 113],\ \ \textcolor{comment}{\#\ Level\ 3.}}
\DoxyCodeLine{00339\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 223,\ 223],\ \ \textcolor{comment}{\#\ Level\ 3.}}
\DoxyCodeLine{00340\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 225,\ 225],\ \ \textcolor{comment}{\#\ Level\ 4.}}
\DoxyCodeLine{00341\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [0,\ 0,\ 449,\ 449]\ \ \ \textcolor{comment}{\#\ Level\ 5.}}
\DoxyCodeLine{00342\ \ \ \ \ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{00343\ \ \ \ \ \ \ \ \ ],}
\DoxyCodeLine{00344\ \ \ \ \ \ \ \ \ dtype=np.float32)\ /\ image\_size}
\DoxyCodeLine{00345\ \ \ \ \ levels\ =\ np.array([[0,\ 1,\ 1,\ 2,\ 3]],\ dtype=np.int32)}
\DoxyCodeLine{00346\ }
\DoxyCodeLine{00347\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(feature1,\ feature2,\ feature3,\ feature4,\ boxes,\ levels):}
\DoxyCodeLine{00348\ \ \ \ \ \ \ roi\_features\ =\ spatial\_ops.multilevel\_roi\_align(}
\DoxyCodeLine{00349\ \ \ \ \ \ \ \ \ \ \ [feature1,\ feature2,\ feature3,\ feature4],}
\DoxyCodeLine{00350\ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00351\ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00352\ \ \ \ \ \ \ \ \ \ \ output\_size)}
\DoxyCodeLine{00353\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ roi\_features}
\DoxyCodeLine{00354\ }
\DoxyCodeLine{00355\ \ \ \ \ roi\_features\ =\ self.execute(graph\_fn,\ features\ +\ [boxes,\ levels])}
\DoxyCodeLine{00356\ \ \ \ \ self.assertAllClose(roi\_features[0][0],\ 2\ *\ np.ones((2,\ 2,\ 1)))}
\DoxyCodeLine{00357\ \ \ \ \ self.assertAllClose(roi\_features[0][1],\ 3\ *\ np.ones((2,\ 2,\ 1)))}
\DoxyCodeLine{00358\ \ \ \ \ self.assertAllClose(roi\_features[0][2],\ 3\ *\ np.ones((2,\ 2,\ 1)))}
\DoxyCodeLine{00359\ \ \ \ \ self.assertAllClose(roi\_features[0][3],\ 4\ *\ np.ones((2,\ 2,\ 1)))}
\DoxyCodeLine{00360\ \ \ \ \ self.assertAllClose(roi\_features[0][4],\ 5\ *\ np.ones((2,\ 2,\ 1)))}
\DoxyCodeLine{00361\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_addc76f7ec56d59581a60c7ffe86ed1e7_cgraph}
\end{center}
\end{figure}
\Hypertarget{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a90d6ae486f353e011c623636631e8f28}\label{classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a90d6ae486f353e011c623636631e8f28} 
\index{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}!test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels@{test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels}}
\index{test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels@{test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels}!detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest@{detection\_utils.utils.spatial\_transform\_ops\_test.MultiLevelRoIAlignTest}}
\doxysubsubsection{\texorpdfstring{test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels()}{test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+utils.\+spatial\+\_\+transform\+\_\+ops\+\_\+test.\+Multi\+Level\+Ro\+IAlign\+Test.\+test\+\_\+perfectly\+\_\+aligned\+\_\+cell\+\_\+center\+\_\+and\+\_\+feature\+\_\+pixels (\begin{DoxyParamCaption}\item[{}]{self }\end{DoxyParamCaption})}



Definition at line \mbox{\hyperlink{spatial__transform__ops__test_8py_source_l00164}{164}} of file \mbox{\hyperlink{spatial__transform__ops__test_8py_source}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00164\ \ \ \textcolor{keyword}{def\ }test\_perfectly\_aligned\_cell\_center\_and\_feature\_pixels(self):}
\DoxyCodeLine{00165\ }
\DoxyCodeLine{00166\ \ \ \ \ \textcolor{keyword}{def\ }graph\_fn(image,\ boxes,\ levels):}
\DoxyCodeLine{00167\ \ \ \ \ \ \ \textcolor{keywordflow}{return}\ spatial\_ops.multilevel\_roi\_align([image],}
\DoxyCodeLine{00168\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ boxes,}
\DoxyCodeLine{00169\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ levels,}
\DoxyCodeLine{00170\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ output\_size=[2,\ 2])}
\DoxyCodeLine{00171\ }
\DoxyCodeLine{00172\ \ \ \ \ image\ =\ np.arange(25).reshape(1,\ 5,\ 5,\ 1).astype(np.float32)}
\DoxyCodeLine{00173\ \ \ \ \ boxes\ =\ np.array([[[0,\ 0,\ 1.0,\ 1.0]]],\ dtype=np.float32)}
\DoxyCodeLine{00174\ \ \ \ \ box\_levels\ =\ np.array([[0]],\ dtype=np.int32)}
\DoxyCodeLine{00175\ }
\DoxyCodeLine{00176\ \ \ \ \ expected\_output\ =\ [[[[[6],\ [8]],}
\DoxyCodeLine{00177\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ [[16],\ [18]]]]]}
\DoxyCodeLine{00178\ \ \ \ \ crop\_output\ =\ self.execute(graph\_fn,\ [image,\ boxes,\ box\_levels])}
\DoxyCodeLine{00179\ \ \ \ \ self.assertAllClose(crop\_output,\ expected\_output)}
\DoxyCodeLine{00180\ }

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{d2/d05/classdetection__utils_1_1utils_1_1spatial__transform__ops__test_1_1_multi_level_ro_i_align_test_a90d6ae486f353e011c623636631e8f28_cgraph}
\end{center}
\end{figure}


The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/main/resources/processing/video/detections/detection\+\_\+utils/utils/\mbox{\hyperlink{spatial__transform__ops__test_8py}{spatial\+\_\+transform\+\_\+ops\+\_\+test.\+py}}\end{DoxyCompactItemize}
