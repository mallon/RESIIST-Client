\doxysection{detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss Class Reference}
\hypertarget{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss}{}\label{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss}\index{detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}}


Inheritance diagram for detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{d9/d9c/classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss__inherit__graph}
\end{center}
\end{figure}


Collaboration diagram for detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=322pt]{d1/db3/classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss__coll__graph}
\end{center}
\end{figure}
\doxysubsubsection*{Public Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_acc5e74c93eb3c34dd4370bc1c6a7b23f}{\+\_\+\+\_\+init\+\_\+\+\_\+}} (self, gamma=2.\+0, alpha=0.\+25)
\end{DoxyCompactItemize}
\doxysubsection*{Public Member Functions inherited from \mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss}{detection\+\_\+utils.\+core.\+losses.\+Loss}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss_a8555bca99fcc03e1fd78e25e3b2e8843}{\+\_\+\+\_\+call\+\_\+\+\_\+}} (self, prediction\+\_\+tensor, target\+\_\+tensor, ignore\+\_\+nan\+\_\+targets=False, losses\+\_\+mask=None, scope=None, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}params)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Member Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_abd4817631560e14e14c853c01c069732}{\+\_\+compute\+\_\+loss}} (self, prediction\+\_\+tensor, target\+\_\+tensor, weights, class\+\_\+indices=None)
\end{DoxyCompactItemize}
\doxysubsection*{Protected Member Functions inherited from \mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss}{detection\+\_\+utils.\+core.\+losses.\+Loss}}}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss_aadcefe6d066fd31b3b5a2542d3fef144}{\+\_\+get\+\_\+loss\+\_\+multiplier\+\_\+for\+\_\+tensor}} (self, tensor, losses\+\_\+mask)
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss_ae772289a8be37a802e11150c81e7ece7}{\+\_\+compute\+\_\+loss}} (self, prediction\+\_\+tensor, target\+\_\+tensor, \texorpdfstring{$\ast$}{*}\texorpdfstring{$\ast$}{*}params)
\end{DoxyCompactItemize}
\doxysubsubsection*{Protected Attributes}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_ae7a2f9c1c0913c37e806e7ad3487d0a4}{\+\_\+alpha}}
\item 
\mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_a8fabfd8883d2be73deb91513ac7ab456}{\+\_\+gamma}}
\end{DoxyCompactItemize}


\doxysubsection{Detailed Description}
\begin{DoxyVerb}Sigmoid focal cross entropy loss.

Focal loss down-weights well classified examples and focusses on the hard
examples. See https://arxiv.org/pdf/1708.02002.pdf for the loss definition.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{losses_8py_source_l00251}{251}} of file \mbox{\hyperlink{losses_8py_source}{losses.\+py}}.



\doxysubsection{Constructor \& Destructor Documentation}
\Hypertarget{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_acc5e74c93eb3c34dd4370bc1c6a7b23f}\label{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_acc5e74c93eb3c34dd4370bc1c6a7b23f} 
\index{detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}!\_\_init\_\_@{\_\_init\_\_}}
\index{\_\_init\_\_@{\_\_init\_\_}!detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}}
\doxysubsubsection{\texorpdfstring{\_\_init\_\_()}{\_\_init\_\_()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss.\+\_\+\+\_\+init\+\_\+\+\_\+ (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{gamma = {\ttfamily 2.0},  }\item[{}]{alpha = {\ttfamily 0.25} }\end{DoxyParamCaption})}

\begin{DoxyVerb}Constructor.

Args:
  gamma: exponent of the modulating factor (1 - p_t) ^ gamma.
  alpha: optional alpha weighting factor to balance positives vs negatives.
\end{DoxyVerb}
 

Definition at line \mbox{\hyperlink{losses_8py_source_l00258}{258}} of file \mbox{\hyperlink{losses_8py_source}{losses.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00258\ \ \ \textcolor{keyword}{def\ }\_\_init\_\_(self,\ gamma=2.0,\ alpha=0.25):}
\DoxyCodeLine{00259\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Constructor.}}
\DoxyCodeLine{00260\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00261\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{00262\ \textcolor{stringliteral}{\ \ \ \ \ \ gamma:\ exponent\ of\ the\ modulating\ factor\ (1\ -\/\ p\_t)\ \string^\ gamma.}}
\DoxyCodeLine{00263\ \textcolor{stringliteral}{\ \ \ \ \ \ alpha:\ optional\ alpha\ weighting\ factor\ to\ balance\ positives\ vs\ negatives.}}
\DoxyCodeLine{00264\ \textcolor{stringliteral}{\ \ \ \ "{}"{}"{}}}
\DoxyCodeLine{00265\ \textcolor{stringliteral}{\ \ \ \ super(SigmoidFocalClassificationLoss,\ self).\_\_init\_\_()}}
\DoxyCodeLine{00266\ \textcolor{stringliteral}{\ \ \ \ self.\_alpha\ =\ alpha}}
\DoxyCodeLine{00267\ \textcolor{stringliteral}{\ \ \ \ self.\_gamma\ =\ gamma}}
\DoxyCodeLine{00268\ \textcolor{stringliteral}{}}

\end{DoxyCode}
Here is the call graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{de/d81/classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_acc5e74c93eb3c34dd4370bc1c6a7b23f_cgraph}
\end{center}
\end{figure}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=238pt]{de/d81/classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_acc5e74c93eb3c34dd4370bc1c6a7b23f_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Function Documentation}
\Hypertarget{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_abd4817631560e14e14c853c01c069732}\label{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_abd4817631560e14e14c853c01c069732} 
\index{detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}!\_compute\_loss@{\_compute\_loss}}
\index{\_compute\_loss@{\_compute\_loss}!detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}}
\doxysubsubsection{\texorpdfstring{\_compute\_loss()}{\_compute\_loss()}}
{\footnotesize\ttfamily detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss.\+\_\+compute\+\_\+loss (\begin{DoxyParamCaption}\item[{}]{self,  }\item[{}]{prediction\+\_\+tensor,  }\item[{}]{target\+\_\+tensor,  }\item[{}]{weights,  }\item[{}]{class\+\_\+indices = {\ttfamily None} }\end{DoxyParamCaption})\hspace{0.3cm}{\ttfamily [protected]}}

\begin{DoxyVerb}Compute loss function.

Args:
  prediction_tensor: A float tensor of shape [batch_size, num_anchors,
    num_classes] representing the predicted logits for each class
  target_tensor: A float tensor of shape [batch_size, num_anchors,
    num_classes] representing one-hot encoded classification targets
  weights: a float tensor of shape, either [batch_size, num_anchors,
    num_classes] or [batch_size, num_anchors, 1]. If the shape is
    [batch_size, num_anchors, 1], all the classses are equally weighted.
  class_indices: (Optional) A 1-D integer tensor of class indices.
    If provided, computes loss only for the specified class indices.

Returns:
  loss: a float tensor of shape [batch_size, num_anchors, num_classes]
    representing the value of the loss function.
\end{DoxyVerb}
 

Reimplemented from \mbox{\hyperlink{classdetection__utils_1_1core_1_1losses_1_1_loss_ae772289a8be37a802e11150c81e7ece7}{detection\+\_\+utils.\+core.\+losses.\+Loss}}.



Definition at line \mbox{\hyperlink{losses_8py_source_l00269}{269}} of file \mbox{\hyperlink{losses_8py_source}{losses.\+py}}.


\begin{DoxyCode}{0}
\DoxyCodeLine{00273\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ class\_indices=\textcolor{keywordtype}{None}):}
\DoxyCodeLine{00274\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}Compute\ loss\ function.}}
\DoxyCodeLine{00275\ \textcolor{stringliteral}{}}
\DoxyCodeLine{00276\ \textcolor{stringliteral}{\ \ \ \ Args:}}
\DoxyCodeLine{00277\ \textcolor{stringliteral}{\ \ \ \ \ \ prediction\_tensor:\ A\ float\ tensor\ of\ shape\ [batch\_size,\ num\_anchors,}}
\DoxyCodeLine{00278\ \textcolor{stringliteral}{\ \ \ \ \ \ \ \ num\_classes]\ representing\ the\ predicted\ logits\ }\textcolor{keywordflow}{for}\ each\ \textcolor{keyword}{class}}
\DoxyCodeLine{00279\ \ \ \ \ \ \ target\_tensor:\ A\ float\ tensor\ of\ shape\ [batch\_size,\ num\_anchors,}
\DoxyCodeLine{00280\ \ \ \ \ \ \ \ \ num\_classes]\ representing\ one-\/hot\ encoded\ classification\ targets}
\DoxyCodeLine{00281\ \ \ \ \ \ \ weights:\ a\ float\ tensor\ of\ shape,\ either\ [batch\_size,\ num\_anchors,}
\DoxyCodeLine{00282\ \ \ \ \ \ \ \ \ num\_classes]\ \textcolor{keywordflow}{or}\ [batch\_size,\ num\_anchors,\ 1].\ If\ the\ shape\ \textcolor{keywordflow}{is}}
\DoxyCodeLine{00283\ \ \ \ \ \ \ \ \ [batch\_size,\ num\_anchors,\ 1],\ all\ the\ classses\ are\ equally\ weighted.}
\DoxyCodeLine{00284\ \ \ \ \ \ \ class\_indices:\ (Optional)\ A\ 1-\/D\ integer\ tensor\ of\ \textcolor{keyword}{class\ }indices.}
\DoxyCodeLine{00285\ \ \ \ \ \ \ \ \ If\ provided,\ computes\ loss\ only\ \textcolor{keywordflow}{for}\ the\ specified\ \textcolor{keyword}{class\ }indices.}
\DoxyCodeLine{00286\ }
\DoxyCodeLine{00287\ \ \ \ \ Returns:}
\DoxyCodeLine{00288\ \ \ \ \ \ \ loss:\ a\ float\ tensor\ of\ shape\ [batch\_size,\ num\_anchors,\ num\_classes]}
\DoxyCodeLine{00289\ \ \ \ \ \ \ \ \ representing\ the\ value\ of\ the\ loss\ function.}
\DoxyCodeLine{00290\ \ \ \ \ \textcolor{stringliteral}{"{}"{}"{}}}
\DoxyCodeLine{00291\ \textcolor{stringliteral}{\ \ \ \ }\textcolor{keywordflow}{if}\ class\_indices\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00292\ \ \ \ \ \ \ weights\ *=\ tf.reshape(}
\DoxyCodeLine{00293\ \ \ \ \ \ \ \ \ \ \ ops.indices\_to\_dense\_vector(class\_indices,}
\DoxyCodeLine{00294\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ tf.shape(prediction\_tensor)[2]),}
\DoxyCodeLine{00295\ \ \ \ \ \ \ \ \ \ \ [1,\ 1,\ -\/1])}
\DoxyCodeLine{00296\ \ \ \ \ per\_entry\_cross\_ent\ =\ (tf.nn.sigmoid\_cross\_entropy\_with\_logits(}
\DoxyCodeLine{00297\ \ \ \ \ \ \ \ \ labels=target\_tensor,\ logits=prediction\_tensor))}
\DoxyCodeLine{00298\ \ \ \ \ prediction\_probabilities\ =\ tf.sigmoid(prediction\_tensor)}
\DoxyCodeLine{00299\ \ \ \ \ p\_t\ =\ ((target\_tensor\ *\ prediction\_probabilities)\ +}
\DoxyCodeLine{00300\ \ \ \ \ \ \ \ \ \ \ \ ((1\ -\/\ target\_tensor)\ *\ (1\ -\/\ prediction\_probabilities)))}
\DoxyCodeLine{00301\ \ \ \ \ modulating\_factor\ =\ 1.0}
\DoxyCodeLine{00302\ \ \ \ \ \textcolor{keywordflow}{if}\ self.\_gamma:}
\DoxyCodeLine{00303\ \ \ \ \ \ \ modulating\_factor\ =\ tf.pow(1.0\ -\/\ p\_t,\ self.\_gamma)}
\DoxyCodeLine{00304\ \ \ \ \ alpha\_weight\_factor\ =\ 1.0}
\DoxyCodeLine{00305\ \ \ \ \ \textcolor{keywordflow}{if}\ self.\_alpha\ \textcolor{keywordflow}{is}\ \textcolor{keywordflow}{not}\ \textcolor{keywordtype}{None}:}
\DoxyCodeLine{00306\ \ \ \ \ \ \ alpha\_weight\_factor\ =\ (target\_tensor\ *\ self.\_alpha\ +}
\DoxyCodeLine{00307\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ (1\ -\/\ target\_tensor)\ *\ (1\ -\/\ self.\_alpha))}
\DoxyCodeLine{00308\ \ \ \ \ focal\_cross\_entropy\_loss\ =\ (modulating\_factor\ *\ alpha\_weight\_factor\ *}
\DoxyCodeLine{00309\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ per\_entry\_cross\_ent)}
\DoxyCodeLine{00310\ \ \ \ \ \textcolor{keywordflow}{return}\ focal\_cross\_entropy\_loss\ *\ weights}
\DoxyCodeLine{00311\ }
\DoxyCodeLine{00312\ }

\end{DoxyCode}
Here is the caller graph for this function\+:
\nopagebreak
\begin{figure}[H]
\begin{center}
\leavevmode
\includegraphics[width=350pt]{de/d81/classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_abd4817631560e14e14c853c01c069732_icgraph}
\end{center}
\end{figure}


\doxysubsection{Member Data Documentation}
\Hypertarget{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_ae7a2f9c1c0913c37e806e7ad3487d0a4}\label{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_ae7a2f9c1c0913c37e806e7ad3487d0a4} 
\index{detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}!\_alpha@{\_alpha}}
\index{\_alpha@{\_alpha}!detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}}
\doxysubsubsection{\texorpdfstring{\_alpha}{\_alpha}}
{\footnotesize\ttfamily detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss.\+\_\+alpha\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{losses_8py_source_l00266}{266}} of file \mbox{\hyperlink{losses_8py_source}{losses.\+py}}.

\Hypertarget{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_a8fabfd8883d2be73deb91513ac7ab456}\label{classdetection__utils_1_1core_1_1losses_1_1_sigmoid_focal_classification_loss_a8fabfd8883d2be73deb91513ac7ab456} 
\index{detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}!\_gamma@{\_gamma}}
\index{\_gamma@{\_gamma}!detection\_utils.core.losses.SigmoidFocalClassificationLoss@{detection\_utils.core.losses.SigmoidFocalClassificationLoss}}
\doxysubsubsection{\texorpdfstring{\_gamma}{\_gamma}}
{\footnotesize\ttfamily detection\+\_\+utils.\+core.\+losses.\+Sigmoid\+Focal\+Classification\+Loss.\+\_\+gamma\hspace{0.3cm}{\ttfamily [protected]}}



Definition at line \mbox{\hyperlink{losses_8py_source_l00267}{267}} of file \mbox{\hyperlink{losses_8py_source}{losses.\+py}}.



The documentation for this class was generated from the following file\+:\begin{DoxyCompactItemize}
\item 
src/main/resources/processing/video/detections/detection\+\_\+utils/core/\mbox{\hyperlink{losses_8py}{losses.\+py}}\end{DoxyCompactItemize}
